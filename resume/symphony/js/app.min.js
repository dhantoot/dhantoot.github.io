!function(){"use strict";angular.module("POS17",["ngSanitize","ngAnimate","ui.router","chart.js","angular-flot","ui.bootstrap","textAngular","ngFileUpload","ui.footable","restangular","toastr","angularMoment","angularSpinner","ngDialog","ui.select","mgcrea.ngStrap","LocalStorageModule","dibari.angular-ellipsis","angular-jwt","color.picker","ja.qr","angularTreeview","angularFileUpload","dndLists","ngTable","kk.timepicker","angularjs-dropdown-multiselect","bootstrapLightbox","videosharing-embed","com.2fdevs.videogular","com.2fdevs.videogular.plugins.controls","com.2fdevs.videogular.plugins.overlayplay","com.2fdevs.videogular.plugins.buffering","info.vietnamcode.nampnq.videogular.plugins.flash","pdf","io.dennis.contextmenu","satellizer","frapontillo.bootstrap-switch","angularRipple","barcode","angular-progress-button-styles","angularPromiseButtons","ngRoute","angular-loading-bar","firebase","nvd3","ngLetterAvatar","daterangepicker","ngJsonExportExcel","luegg.directives","emojiApp","ngTagsInput","ngGeolocation","uiGmapgoogle-maps","btford.socket-io"]).constant("API_URL","http://206.189.153.177:5555").constant("API_VERSION","/api/1.0/").constant("API_URL_2","http://54.206.38.223:5005").constant("API_VERSION_2","/api/1.0/").constant("FACEBOOK_API","218087938610404").constant("GOOGLE_API","608675325087-lsbmqc0m5hm6rtosar8bt99agvfce8dh.apps.googleusercontent.com").constant("TWITTER_API","04gzA1YhW0oAm2Aj36J2tcNH3").constant("LINKEDIN_API","81j8xuo5umqyqn")}();
!function(){"use strict";function e(e,i,r,o,t,a,l,n,c,s,p,d,u,m,h,P,g,I){r.html5Mode({enabled:!1,requireBase:!1}),r.hashPrefix(""),I.configure({key:"AIzaSyAuzYP_UiPL6pRYmqe6tJ54VHsvoRWzRbk",v:"3.26",libraries:"weather,geometry,visualization"}),i.otherwise("/login"),p.resetSearchInput=!0,e.state("main",{url:"/main",abstract:!0,templateUrl:"modules/main.html",controller:"MainCtrl"}),o.interceptors.push("httpInterceptor"),o.interceptors.push("authInterceptor"),c.value("baseURL",l),t.setBaseUrl(l+n),u.facebook({clientId:m,url:l+"/auth/facebook",redirectUri:window.location.origin+"/",requiredUrlParams:["display","scope"],scope:["email"],scopeDelimiter:",",oauthType:"2.0"}),u.google({clientId:h,url:l+"/auth/google",redirectUri:window.location.origin,requiredUrlParams:["scope"],scope:["profile","email"],scopePrefix:"openid",scopeDelimiter:" ",oauthType:"2.0"}),u.linkedin({clientId:g,url:l+"/auth/linkedin",redirectUri:window.location.origin,requiredUrlParams:["state"],scope:["r_emailaddress"],scopeDelimiter:" ",oauthType:"2.0",state:"STATE"}),u.twitter({clientId:P,url:l+"/auth/twitter",redirectUri:window.location.origin+"/",oauthType:"1.0"}),d.fullScreenMode=!0;firebase.initializeApp({apiKey:"AIzaSyBiopDJ0LclH1H_FxUjBgLTjPFjlRlfk-E",authDomain:"symphony-2a04c.firebaseapp.com",databaseURL:"https://symphony-2a04c.firebaseio.com",projectId:"symphony-2a04c",storageBucket:"symphony-2a04c.appspot.com",messagingSenderId:"579565622268"})}angular.module("POS17").config(e),e.$inject=["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider","RestangularProvider","$uibTooltipProvider","API_URL","API_VERSION","$provide","localStorageServiceProvider","uiSelectConfig","LightboxProvider","$authProvider","FACEBOOK_API","GOOGLE_API","TWITTER_API","LINKEDIN_API","uiGmapGoogleMapApiProvider"]}();
!function(){"use strict";angular.module("POS17").run(["$state","$rootScope","usSpinnerService","AuthFctry","$window","jwtHelper","localStorageService","$location","ngDialog","$browser","$firebaseAuth","socket","toastr","$http",function(a,i,e,u,t,c,g,l,m,n,d,o,r,s){i.clearHeaders=function(){delete s.defaults.headers.common.Authorization},i.clearHeaders(),i.currentUser={},i.$state=a,i.previousState,i.currentState,i.changesOccur=0,i.emojiMessage={},t.user_timezone=moment.tz.guess(),t.user_timezone2=moment().format("Z"),i.$on("loading:progress",function(){i.productIsLoading=!0}),i.$on("loading:finish",function(){i.productIsLoading=!1}),i.$on("unauthorized",function(){u.setCurrentUser(null),u.setUserToken(null),a.go("login")}),i.goBack=function(){t.history.back()},i.$on("$stateChangeStart",function(e,t,n,o,r){if("main.settings-company"==o.name&&"main.settings-humanresource-detail"==t.name?i.comp=!0:i.comp=!1,u.getCurrentUser()){var s=u.getUserToken();c.isTokenExpired(s)&&(g.remove("user"),g.remove("token"),d().$signOut(),l.path("/login"))}2<i.changesOccur&&(e.preventDefault(),i.modal={title:"Changes Detected?",message:"Are you sure to proceed without saving or updating?"},m.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:i,className:"ngdialog-theme-default"}).then(function(){i.changesOccur=0,a.go(t.name)},function(){console.log("NO")}))}),i.$on("$stateChangeSuccess",function(e,t,n,o,r){i.previousState=o.name,i.currentState=t.name,i.prevent=!0,i.currentUser=u.getCurrentUser(),window!=window.top?i.prevent=!1:i.prevent=!0});JSON.parse(g.get("user"));o.on("alertReorderLevel-19",function(e){r.warning(e.length+" items found Low Level in stock","Warning"),i.listOfProductsNeedToOrder=e})}])}();
!function(){"use strict";function e(t,n,a,o,r,i,e,u,c,l,p,s,d,g){t.profile={},t.activeSub="",n.chatMessage="",n.accountUser={},n.getmessage=[],n.emojiMessage={};var f=JSON.parse(u.get("user")),m=firebase.database().ref("Users"),b=s(m);b.$loaded().then(function(){n.portalAccount=_.find(b,{type:"admin"})}),n.chatbox=!1,n.showChat=function(){n.chatbox=!n.chatbox,c(function(){n.glued=!0},500)},f&&e.getAllPersonDetail(f.person_id).then(function(e){200==e.statusCode&&e.response.success&&(n.accountUser=e.response.result,n.accountUser)}),n.sendMessage=function(){n.checkexist.$loaded(function(){var e=_.find(n.checkexist,{$id:n.authid});n.emojiMessage&&!_.isEmpty(n.emojiMessage.messagetext)&&(_.isEmpty(e)?async.waterfall([function(e){n.ref.set({sender_id:f.sub_id,sender_name:f.displayName,created_at:firebase.database.ServerValue.TIMESTAMP}),e()},function(e){n.obj.$add({p_type:1,value:n.emojiMessage.messagetext,send_at:firebase.database.ServerValue.TIMESTAMP,read:!1}),n.emojiMessage.rawhtml="",n.emojiMessage.messagetext=""}]):(n.obj.$add({p_type:1,value:n.emojiMessage.messagetext,send_at:firebase.database.ServerValue.TIMESTAMP,read:!1}),n.emojiMessage.rawhtml="",n.emojiMessage.messagetext=""))})},n.onfocus=function(){_.each(n.getmessage,function(e,s){0==e.p_type&&(e.read=!0,n.getmessage.$save(s))})},n.getchanges=function(e){return function(e){return 0==e.p_type&&0==e.read}},n.playAudio=function(){console.log("diri"),new Audio("lib/sound/notification.mp3").play()},n.logoutApp=function(){i.logout().then(function(e){if(200==e.statusCode&&e.response.success){var s=JSON.parse(u.get("user"));p.logTransaction("User Logout","LOGOUT",s.username,"User Logout USERNAME:="+s.username).then(function(){i.setCurrentUser(null),i.setUserToken(null),l.logout()}),a.go("login")}})},n.getCurrentUser=function(){i.userprofile().then(function(e){if(200==e.statusCode&&e.response.success){t.profile=e.response.result;var s=JSON.parse(u.get("user"));t.activeSub=s.company_name}else if(400==e.statusCode&&!e.response.success)return void o.error(e.response.msg,"Error")})},n.openSubscription=function(){var e=r.open({animation:!0,templateUrl:"./modules/templates/header.subscription.html",controller:"ModalSubscriptionCtrl",size:"sm"}),s=JSON.parse(u.get("user"));p.logTransaction("Active Subscription","DASHBOARD","N/A","User:="+s.username+" Views Active Subscription"),e.result.then(function(e){var s=JSON.parse(u.get("user"));s.sub_id=e.sub_id,s.company_name=e.company_name,s.subscriptionKey=e.subscriptionKey,s.subscriptionCode=e.subscriptionCode,s.one_signal_apiKey=e.one_signal_apiKey,s.one_signal_appID=e.one_signal_appID,u.set("user",JSON.stringify(s)),c(function(){a.go("main.dashboard",null,{reload:!0})},1e3)})},n.getCurrentUser()}function s(e,s,t){e.switchSubscription=function(e){t(function(){s.close(e)},300)},e.cancel=function(){s.dismiss("cancel")}}angular.module("POS17").controller("MainCtrl",e).controller("ModalSubscriptionCtrl",s),e.$inject=["$rootScope","$scope","$state","toastr","$uibModal","AuthFctry","humanFactory","localStorageService","$timeout","$auth","transLogFctry","$firebaseArray","$firebaseAuth","$firebaseObject"],s.$inject=["$scope","$uibModalInstance","$timeout"]}();
!function(){"use strict";function e(e,o,n){e.dtFrom=new Date(n.dateFrom),e.dtTo=new Date(n.dateTo),e.dateOptions={formatYear:"yy",maxDate:new Date(3e3,12,31),minDate:new Date(1800,1,1),startingDay:1},e.popup1={opened:!1},e.popup2={opened:!1},e.openFrom=function(){e.popup1.opened=!0},e.openTo=function(){e.popup2.opened=!0},e.save=function(){o.close({dateFrom:e.dtFrom,dateTo:e.dtTo})},e.cancel=function(){o.dismiss("cancel")}}angular.module("POS17").controller("ModalInstanceCtrl",e),e.$inject=["$scope","$uibModalInstance","dateValue"]}();
!function(){"use strict";function e(n,e,o){n.showPreview=!1,n.fileChanged=function(e){n.sheets=[],n.excelFile=e[0],o.readFile(n.excelFile,n.showPreview).then(function(e){n.sheets=e.sheets})},n.showPreviewChanged=function(){n.showPreview&&o.readFile(n.excelFile,n.showPreview).then(function(e){n.sheets=e.sheets})},n.cancel=function(){e.dismiss("cancel")}}function n(a,e,o,s,n,i){var c={delimiter:"",newline:"",header:!0,dynamicTyping:!1,preview:0,encoding:"",worker:!1,comments:!1,step:void 0,complete:void 0,error:void 0,download:!1,skipEmptyLines:!0,chunk:void 0,fastMode:void 0,beforeFirstChunk:void 0,withCredentials:void 0};function t(e){console.log("handleParseResult: ",e);var n=e.meta.fields;n=_.filter(n,function(e){return""!==e});var o=e.data,i=angular.copy(e.data);a.isLoading=!0,s(function(){a.$apply(function(){a.csvToSave=o,i.length=100,a.csvResult=i,a.csvHeaders=n})},10)}function r(e){console.log("handleParseError: ",e)}function l(){a.isClear=!0}a.isClear=!1,a.isLoading=!1,a.csvResult={},a.csvToSave={},a.csvHeaders=[],a.csvHeadersToSave=[],a.infiniteScrollData={},a.infiniteScrollData.numToAdd=10,a.infiniteScrollData.currentItems=10,a.resetInfScroll=function(){a.infiniteScrollData.currentItems=a.infiniteScrollData.numToAdd},a.addMoreItems=function(){a.infiniteScrollData.currentItems+=a.infiniteScrollData.numToAdd},a.pairColumnsToHeaders=function(e,n){_.find(a.csvHeadersToSave,{index:n})?(a.csvHeadersToSave[n].header=e,a.csvHeadersToSave[n].index=n):a.csvHeadersToSave.push({header:e,index:n})},a.onEnd=function(){a.isLoading=!1},a.clear=function(){console.log("clear"),a.csvResult={},a.csvHeaders=[],a.isClear=!1,a.isLoading=!1},a.upload=function(e){if(e&&0<e.length){var n=e[0];o.parse(n,c).then(t).catch(r).finally(l)}},a.import=function(){console.log("import"),i.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:a,className:"ngdialog-theme-default"}).then(function(){console.log("fieldName: ",a.csvHeaders),_.each(a.csvHeadersToSave,function(e){e.csvHeader=a.csvHeaders[e.index]}),console.log("$scope.csvHeadersToSave: ",a.csvHeadersToSave)})},a.cancel=function(){e.dismiss("cancel")}}angular.module("POS17").controller("ImportInstanceCtrl",e).controller("ImportCSVInstanceCtrl",n),e.$inject=["$scope","$uibModalInstance","XLSXReaderService"],n.$inject=["$scope","$uibModalInstance","Papa","$timeout","companyFactory","ngDialog"]}();
!function(){"use strict";function e(e,t,n,o,s,u,i,r,a,c){c.set("token",null),c.remove("user"),c.remove("token"),e.user={},e.login=function(){o.authenticate(e.user).then(function(e){if(e.success){o.setUserToken(e.result.token),o.setCurrentUser(JSON.stringify(e.result.user));e.result.user;i.logTransaction("User Logged In","LOGIN",e.result.user.username,"User Login for USERNAME:="+e.result.user.username),setTimeout(function(){n.info("Welcome back "+e.result.user.displayName)},2500),setTimeout(function(){t.go("main.dashboard")},3e3)}else 400===e.statusCode&&!e.response.success&&_.isArray(e.response.result)?(_.each(e.response.result,function(e){n.warning(e.msg,"Warning")}),setTimeout(function(){window.location.reload()},2500)):401===e.statusCode&&!e.response.success&&_.isArray(e.response.result)?(_.each(e.response.result,function(e){n.warning(e.msg,"Warning")}),setTimeout(function(){window.location.reload()},2500)):(setTimeout(function(){n.error(e.msg,"Error")},3e3),setTimeout(function(){location=""},4e3))})},e.authenticate=function(r){s.authenticate(r).then(function(e){if(e){var s=e.data;console.log("resp: ",s),s.success?(o.setUserToken(s.result.token),o.setCurrentUser(JSON.stringify(s.result.user)),i.logTransaction("Social Media Logged In","LOGIN",s.result.user.username,"User Login for USERNAME:="+s.result.user.username+" TYPE:="+r),n.success("Login successfully with "+r.toUpperCase()+"!"),u(function(){t.go("main.dashboard")},100)):400===s.statusCode&&!s.response.success&&_.isArray(s.response.result)?_.each(s.response.result,function(e){n.warning(e.msg,"Warning")}):401===s.statusCode&&!s.response.success&&_.isArray(s.response.result)?_.each(s.response.result,function(e){n.warning(e.msg,"Warning")}):n.error(s.msg,"Error")}}).catch(function(e){e.message?n.error(e.message):e.data?n.error(e.data.message,e.status):n.error(e)})}}angular.module("POS17").config(["$stateProvider","$routeProvider",function(e,s){e.state("login",{url:"/login",templateUrl:"modules/login/login.html",controller:"LoginCtrl",resolve:{skipIfLoggedIn:["$q","$auth",function(e,s){var r=e.defer();return s.isAuthenticated()?r.reject():r.resolve(),r.promise}]}})}]).controller("LoginCtrl",e),e.$inject=["$scope","$state","toastr","AuthFctry","$auth","$timeout","transLogFctry","$http","$firebaseAuth","localStorageService"]}();
!function(){"use strict";function s(o,e,s,t,r,n){o.detail={},o.details={},o.forgotpass=function(){async.waterfall([function(e){s.forgotPassword({email:o.detail.email}).then(function(s){if(200==s.statusCode&&s.response.success)t.success(s.response.msg,"Success"),o.details=s.response.result,e();else{if(400!==s.statusCode||s.response.success||!_.isArray(s.response.result))return void t.error(s.response.msg,"Error");_.each(s.response.result,function(s){t.warning(s.msg,"Warning")})}})},function(s){r(function(){var s={subject:"Symphony Password Recovery",message:$("#subscriptionEmail").html(),from:"support@symphony.com.ph",email:o.details.email};n.sendEmail(s).then(function(s){200==s.statusCode&&s.response.success&&r(function(){e.reload()},1e3)})},1e3)}])}}angular.module("POS17").config(["$stateProvider",function(s){s.state("forgot",{url:"/forgotpassword",templateUrl:"modules/forgotpassword/forgotpassword.html",controller:"ForgotPasswordCtrl"})}]).controller("ForgotPasswordCtrl",s),s.$inject=["$scope","$state","AuthFctry","toastr","$timeout","sharerFactory"]}();
!function(){"use strict";function e(t,n,s,o,r,i,c){t.details={},t.showLogin=!1,t.isVerified=!0,t.frontend_host_url="",t.isVerified=function(){t.response={},o.isVerifiedContact(n.hash).then(function(e){void 0===e?r.go("login"):!0===e.response.success?(s.warning(e.response.msg,"Warning"),t.response=e.response,t.showLogin=!0,t.isVerified=!1):!1===e.response.success&&async.waterfall([function(s){o.verifyContact(n.hash).then(function(e){e.response.success&&(t.response=e.response,i(function(){t.$apply(function(){t.details=e.response.result,t.frontend_host_url=e.response.result.frontend_host_url})}),s())})},function(e){i(function(){var e={subject:"Symphony User Account Details",message:$("#subscriptionEmail").html(),from:"support@symphony.com.ph",email:t.details.email};c.sendEmail(e).then(function(e){200==e.statusCode&&e.response.success&&i(function(){t.showLogin=!0},1e3)})},1e3)}])})}}function s(e){}angular.module("POS17").config(["$stateProvider",function(e){e.state("verify",{url:"/verify/:hash",templateUrl:"modules/verify/verify.html",controller:"VerifyCtrl"}).state("recovery",{url:"/recovery",templateUrl:"modules/verify/verify.recovery.html"})}]).controller("VerifyCtrl",e).controller("RecoveryCtrl",s),e.$inject=["$scope","$stateParams","toastr","AuthFctry","$state","$timeout","sharerFactory"],s.$inject=["$scope"]}();
!function(){"use strict";function e(r,e,n,t,s,i){r.detail={},r.details={},r.hashkey=null,r.frontend_host_url=null,r.verifyLink=null,r.resendVerification=function(){async.waterfall([function(s){n.resendVerification({email:r.detail.email}).then(function(e){if(200==e.statusCode&&e.response.success)t.success(e.response.msg,"Success"),r.detail.email="",r.details.firstname=e.response.result.firstname,r.details.email=e.response.result.email,r.hashkey=e.response.result.hashkey,r.frontend_host_url=e.response.result.frontend_host_url,r.verifyLink=r.frontend_host_url+"/#/verify/"+r.hashkey,s();else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void t.error(e.response.msg,"Error");_.each(e.response.result,function(e){t.warning(e.msg,"Warning")})}})},function(e){s(function(){var e={subject:"Symphony Account Email Verification",message:$("#subscriptionEmail").html(),from:"support@symphony.com.ph",email:r.details.email};i.sendEmail(e)},1e3)}])}}angular.module("POS17").config(["$stateProvider",function(e){e.state("resend",{url:"/resend",templateUrl:"modules/resend_verify/resend.html",controller:"ResendCtrl"})}]).controller("ResendCtrl",e),e.$inject=["$scope","$state","AuthFctry","toastr","$timeout","sharerFactory"]}();
!function(){"use strict";function e(s,n,r,o,t,i,l){s.verifying=!0,s.hasError=!1,s.hashkey=null,s.frontend_host_url=null,s.verifyLink=null,s.emails={},s.isVerified=function(){s.response={},o.isVerifiedEmailRecovery(n.hash).then(function(e){_.isUndefined(e)?t.go("login"):e.response.success?(s.verifying=!1,s.hasError=!0,r.warning(e.response.msg,"Warning"),s.response=e.response):e.response.success||(console.log("false: "),async.waterfall([function(r){o.verifyEmailRecovery(n.hash).then(function(e){e.response.success&&(s.response=e.response,s.verifying=!1,s.hasError=!1,s.emails={firstname:e.response.result.firstname,email:e.response.result.email,recovery_email:e.response.result.recovery_email,frontend_host_url:e.response.result.frontend_host_url},s.hashkey=e.response.result.hashkey,s.frontend_host_url=e.response.result.frontend_host_url,s.verifyLink=s.frontend_host_url+"/#/login",r())})},function(e){async.parallel([function(r){i(function(){var e={subject:"Symphony Account Recovery Email Address changed",message:$("#recoveryEmail").html(),from:"support@symphony.com.ph",email:s.emails.email};l.sendEmail(e).then(function(e){200==e.statusCode&&e.response.success&&r()})},1e3)},function(r){i(function(){var e={subject:"Symphony Account Recovery Email Address changed",message:$("#recoveryEmail").html(),from:"support@symphony.com.ph",email:s.emails.recovery_email};l.sendEmail(e).then(function(e){200==e.statusCode&&e.response.success&&r()})},1e3)}],function(){i(function(){s.showLogin=!0},1e3)})}]))})}}angular.module("POS17").config(["$stateProvider",function(e){e.state("verifyrecovery",{url:"/verify/:hash/recovery",templateUrl:"modules/verifyrecovery/recovery.html",controller:"VerifyRecoveryCtrl"}).state("verifyrecovered",{url:"/verifyrecovered",templateUrl:"modules/verifyrecovery/recovered.html"})}]).controller("VerifyRecoveryCtrl",e),e.$inject=["$scope","$stateParams","toastr","AuthFctry","$state","$timeout","sharerFactory"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,r){r.state("main.products",{url:"/products/overview",templateUrl:"modules/products/products.html",controller:"productsController"}).state("main.export-products",{url:"/products/exports",templateUrl:"modules/products/product-export-pdf.html",controller:"productsExportsController"}).state("main.products-add",{url:"/products/:p_id",templateUrl:"modules/products/product.details.html",controller:"productsAEController"}).state("main.products-bundles",{url:"/product-bundles/overview",templateUrl:"modules/products/product-bundles.html",controller:"productBundlesController"}).state("main.export-bundles",{url:"/products-bundle/exports",templateUrl:"modules/products/product-bundles-export-pdf.html",controller:"productBundlesExportsController"}).state("main.products-bundle-add",{url:"/products-bundle/:pb_id",templateUrl:"modules/products/product.bundle.html",controller:"productsBundleController"})}])}();
!function(){"use strict";function e(e,a,t,s,i,c,o,r,n,l,u,d,p,g,m,h,f,v,y,k,b,C){a.loading1=!1,a.saveText="Save Entry",a.ptypes=[],a.attributes=[],a.tags=[],a.tagsArr=[],a.product_image=[],a.details={},a.details.tags=[],a.details.start_date=new Date,a.details.end_date=new Date,a.details.is_published=!1,a.details.is_archived=!1,a.stockTrack=!1,a._stores={},a._stores.list=[],a._stores.selected=[],a._store={},a._store.selected={},a.inv={},a.inv.stockTrackQty=[],a.inv.stockTrackLevel=[],a.inv.unit={},a.inv.unit.selected={},a.inv.unit.list=[],a.inv_stockTrackDets=[],a.isEnabledstockTrack=!1,a.selectedUnit="",a.isImageNew=!1,a.isLatestUploadedmedia="zmdi zmdi-image-o dhan",a.tabprod={product:!0,media:!0,store:!0,invtracking:!0,price:!0,category:!0,attribute:!0,variation:!0,ratings:!1,related:!0},a.barcodeoptions={width:2,height:100,quite:10,displayValue:!0,font:"monospace",textAlign:"center",fontSize:12,backgroundColor:"",lineColor:"#000"},a.barcodesType=[{type:"ean",code:"EAN"},{type:"upc",code:"UPC"},{type:"code39",code:"Code39"},{type:"code128b",code:"Code128B"},{type:"code128c",code:"Code128c"},{type:"itf",code:"ITF"},{type:"itf14",code:"ITF14"}],a.mycode={},a.mycode.type="code128b",a.producttagsSettings={showCheckAll:!0,showUncheckAll:!0,enableSearch:!0,scrollable:!0};var T=JSON.parse(b.get("user"));c.p_id?C.logTransaction("View Product Details","PRODUCTS",c.p_id,"User:="+T.username+" View products details: ="+c.p_id):C.logTransaction("Add New Product","PRODUCTS","N/A","User:="+T.username+" Add new product entry"),d.getAllTags().then(function(e){e&&200==e.statusCode&&e.response.success?a.tagsArr=e.response.result:console.log("err_msg_@_function getAllTags")}),l.getAllStore().then(function(e){e&&200==e.statusCode&&e.response.success&&e&&e.response&&e.response.result&&_.each(e.response.result,function(e){a._stores.list.push({id:e.store_id,label:e.name,_id:e._id,address:e.address,isChecked:!1})})}),a.changeBarcodeType=function(e){k(function(){a.$apply(function(){a.mycode.type=e})},10)};_.isEmpty(c.p_id)?(a.showPublish=!1,a.showArchive=!1,a.tabprod={product:!0,media:!1,store:!1,invtracking:!1,price:!1,category:!1,attribute:!1,variation:!1,ratings:!1,related:!1},r.getAllProdType().then(function(e){e&&200==e.statusCode&&e.response.success&&(a.ptypes=e.response.result)})):async.waterfall([function(s){r.getAllProdType().then(function(e){e&&200==e.statusCode&&e.response.success?(a.ptypes=e.response.result,s()):console.log(e.response.msg)})},function(r){o.getProductDetails(c.p_id).then(function(e){if(e&&200==e.statusCode&&e.response.success){a.details=e.response.result;var s=a.details.purchase_price;a.details.retail_price=a.details.purchase_price*a.details.markup/100+s,a.details.sell_price=a.details.retail_price,a.showPublish=1!=a.details.is_published,a.showArchive=0==a.details.is_archived,a.tabprod={product:!0,media:!0,store:!0,invtracking:!0,price:!0,category:!0,attribute:!0,variation:!0,ratings:!0,related:!0},a.product_image=a.details.product_images;var t=_.find(a.product_image,{image_path:a.details.img_default});a.isLatest=t?t.pi_id:0,a.details.start_date=new Date(a.details.start_date),a.details.end_date=new Date(a.details.end_date),a.details.ptype_id=e.response.result.productType_id,a.details.is_published=a.IntToBoolean(a.details.is_published),a.details.is_archived=a.IntToBoolean(a.details.is_archived),d.getAllProductTags(c.p_id).then(function(e){e&&200==e.statusCode&&e.response.success&&(a.details.tags=e.response.result,r())})}})},function(e){o.getProductAssets(c.p_id).then(function(e){e&&200==e.statusCode&&e.response.success&&(a.prodAssets=e.response.result,console.log("$scope.details:",a.prodAssets))})}]),a.tagTransform=function(e){return{tags:e}},a.clearInput=function(e){e.search=""},a.IntToBoolean=function(e){return 1===e},a.BooleanToInt=function(e){return!0===e?1:0},a.removethumb=function(){a.details.img_default=null},a.upload=function(e){a.isImageNew=!0},a.archiveProduct=function(e){o.archiveProduct(e).then(function(e){e&&200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.go(t.current,null,{reload:!0})):i.error(e.response.msg,"Error")})},a.publishProduct=function(e){o.publishProduct(e).then(function(e){e&&200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.go(t.current,null,{reload:!0})):i.error(e.response.msg,"Error")})},a.deleteProductTags=function(e){c.p_id&&d.deleteProductTag(c.p_id,e.tags_id).then(function(e){e&&200==e.statusCode&&e.response.success?i.success(e.response.msg,"Success"):i.error(e.response.msg,"Error")})},a.openUploader=function(){h.open({animation:!0,templateUrl:"./modules/products/details/product.upload.modal.html",controller:"productUploaderModalCtrl",size:"lg",resolve:{product_id:function(){return c.p_id}}}).result.then(function(e){console.log("selectedItem:",e),e&&t.go(t.current,null,{reload:!0})},function(){})},a.openAssetUploader=function(){h.open({animation:!0,templateUrl:"./modules/products/details/product.upload.asset.modal.html",controller:"productAssetUploaderModalCtrl",size:"lg",resolve:{product_id:function(){return c.p_id}}}).result.then(function(e){console.log("selectedItem:",e),e&&t.go(t.current,null,{reload:!0})},function(){})},a.openLightboxModal=function(e){var s=[];s.push({url:e.image_path,thumbUrl:e.image_path}),f.openModal(s,0)},a.copyURLLink=function(e){v.supported?(console.log("files.media_path: ",e.image_path),v.copyText(e.image_path)):i.warning("Sorry, copy to clipboard is not supported","Warning")},a.setAsThumbNail=function(e){console.log("files: ",e),a.modal={title:"Set as product thumbnail",message:"Are you sure to set this image?"},y.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:a,className:"ngdialog-theme-default"}).then(function(){o.setProductImage(c.p_id,e._id).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.reload()):i.warning(e.response.msg,"Warning")})})},a.deleteAllMedia=function(){y.openConfirm({templateUrl:"modules/dialog/deleteAllDialog.html",scope:a,className:"ngdialog-theme-default"}).then(function(){c.p_id&&o.deleteAllProductImage(c.p_id).then(function(e){e&&200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.reload()):i.error(e.response.msg,"Error")})})},a.deleteAllAssets=function(){y.openConfirm({templateUrl:"modules/dialog/deleteAllDialog.html",scope:a,className:"ngdialog-theme-default"}).then(function(){c.p_id&&o.removeAllProductAssets(c.p_id).then(function(e){e&&200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.reload()):i.error(e.response.msg,"Error")})})},a.deleteSelected=function(e){y.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:a,className:"ngdialog-theme-default"}).then(function(){c.p_id&&o.deleteProductImageFile(c.p_id,e._id).then(function(e){e&&200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.reload()):i.error(e.response.msg,"Error")})})},a.deleteSelectedAsset=function(e){y.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:a,className:"ngdialog-theme-default"}).then(function(){c.p_id&&o.removeProductAssetsById(c.p_id,e.product_assets._id).then(function(e){e&&200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.reload()):i.error(e.response.msg,"Error")})})},a.pushToStockTrack=function(e,s,t,r,o){var i={store_id:s,stock_qty:t||0,stock_level:r||0,p_id:c.p_id,stock_unit:o};a.inv_stockTrackDets[e]=i},a.addProduct=function(){var e=a.inv.unit.selected._id;a.loading1=!0,a.saveText="Saving..",a.validate=[],a.details.selectedUnit=a.selectedUnit,a.details.sales_unit_id=e,a.details.purchase_unit_id=null,a.details.qty_convert=null,a.details.inv_id=a.inv.inv_id,async.waterfall([function(e){c.p_id?o.updateProduct(c.p_id,a.details).then(function(s){s&&200==s.statusCode&&s.response.success?(i.success(s.response.msg,"Success"),a.loading1=!1,a.saveText="Save Entry",e(null,c.p_id)):(a.validate=s.response.result,_.each(a.validate,function(e){i.warning(s.response.msg,"Error - "+e.msg)}),a.loading1=!1,a.saveText="Save Entry")}):o.saveProduct(a.details).then(function(s){s&&200==s.statusCode&&s.response.success?(i.success(s.response.msg,"Success"),e(null,s.response.result.productid)):(a.validate=s.response.result,_.each(a.validate,function(e){i.warning(s.response.msg,"Error - "+e.msg)})),a.loading1=!1,a.saveText="Save Entry"})},function(t,r){var o=1;0<a.details.tags.length?async.eachSeries(a.details.tags,function(e,s){e.isTag?d.saveTags(e).then(function(e){e&&200==e.statusCode&&e.response.success?d.saveProductTags(t,{tags_id:e.response.result}).then(function(e){200==e.statusCode&&e.response.success?(o++,s()):i.error(e.response.msg,"Error")}):i.error(e.response.msg,"Error")}):d.saveProductTags(t,{tags_id:e.tags_id}).then(function(e){e&&200==e.statusCode&&e.response.success?(o++,s()):i.error(e.response.msg,"Error")}),o>=a.details.tags.length&&r(null,t)}):r(null,t)},function(e,s){t.go(t.current,{p_id:e},{reload:!0})}])},a.calculateRetailPrice=function(e,s,t){if(isNaN(e))a.details.purchase_price="",a.details.markup="",a.details.retail_price="";else if(e&&s){var r=a.details.purchase_price;a.details.retail_price=a.details.purchase_price*a.details.markup/100+r}else a.details.retail_price=0},a.changeOf_PP=function(e,s){if(e.purchase_price=Number(e.purchase_price),s.key.match(/[0-9.\b]*$/))if(-0==Number(e.purchase_price)||Number(e.purchase_price)<0)e.purchase_price="",e.retail_price="",e.sell_price="",e.markup="";else if(isNaN(e.purchase_price))e.purchase_price="",e.markup="",e.retail_price="";else{var t=e.purchase_price;e.retail_price=e.purchase_price*Number(e.markup?e.markup:e.markup=0)/100+t,e.sell_price=e.retail_price}else e.purchase_price&&Number(e.purchase_price)||(e.markup="",e.retail_price="")},a.changeOf_MU=function(e,s){if(e.markup=Number(e.markup),s.key.match(/[0-9.\b]*$/))if(Number(e.purchase_price))if(-0==Number(e.markup)||Number(e.markup)<0)e.markup="",e.retail_price=e.purchase_price,e.sell_price=e.retail_price;else if(isNaN(e.markup))e.markup="";else{var t=e.purchase_price;e.retail_price=e.purchase_price*e.markup/100+t,e.sell_price=e.retail_price}else console.log("purchase_price is not number")},a.changeOf_RP=function(e,s){e.retail_price=Number(e.retail_price),s.key.match(/[0-9.\b]*$/)&&(Number(e.purchase_price)?(e.sell_price=e.retail_price,e.markup=((e.sell_price-e.purchase_price)/e.purchase_price*100).toFixed(0)):console.log("purchase_price is not number"))},a.storeOnClick=function(){e.reloadStore()},a.invOnClick=function(){e.reloadInv()},a.varOnClick=function(){e.reloadVar()},a.attOnClick=function(){}}angular.module("POS17").controller("productsAEController",e),e.$inject=["$rootScope","$scope","$state","$filter","toastr","$stateParams","productFactory","ptypeFactory","supplierFctry","storeFactory","priceHistoryFactory","tagsFactory","API_URL","API_VERSION","Upload","$uibModal","Lightbox","clipboard","ngDialog","$timeout","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,o,s,t,n,i,r,c,l,a,u,d){function p(e,s){return e+"-"+s}o.prodStores=[],o.selectedStores=[],o.inv.unit={},o.inv.unit.selected={},o.inv.unit.list=[],o.isloadingstores=!1,o.istrackingloader=!1,o.isStoreloader=!1,o.isRefreshloader1=!1,o.isClickable="not-allowed",o.storeCopy=[],o.newlySelectedStores=[],o.getAllStore=function(){o.uncheckstore=[],o.applicationStatus="All",o.selectedStores=[],o.isRefreshloader1=!0,o.stores=[],o.storesCopy=[],o.stockTrackQty=[],o.stockTrackLevel=[],o.stockSku=[],o.stockTrackUnit=[],o.inv_stockTrackDets=[],async.waterfall([function(s){r.getAllStore().then(function(e){200==e.statusCode&&e.response.success&&(o.stores=e.response.result,o.storesCopy=angular.copy(e.response.result),s(null,o.stores))})},function(s,e){_.isEmpty(i.p_id)?(o.itemArray=angular.copy(s),o.storeCopy=angular.copy(o.itemArray),o.isRefreshloader1=!1):l.getProductAndStores(i.p_id).then(function(e){if(0<e.response.result.length){o.prodStore=e.response.result,_.each(o.storesCopy,function(s,e){var t=_.find(o.prodStore,function(e){return s.store_id===e.fk_store_id});if(t){s.selected=!0,s.uncheckable=!0,s.inv_id=t.inv_id,s.purchase_unit_id=t.purchase_unit_id,s.qty_convert=t.quantity_conversion,s.sales_unit_id=t.sales_unit_id,s.stockTrackLevel=t.reorder_level,s.stockTrackQty=t.stock_onhand,s.stockTrack=t.is_enable_tracking,s.fk_product_id=i.p_id,s.fk_store_id=t.fk_store_id,s.stockSku="undefined"!=t.sku?t.sku:p(i.p_id,s.fk_store_id);var r={selected:{_id:t.sales_unit_id?t.sales_unit_id:null,label:t.sales_unit?t.sales_unit:null}};s.stockTrackUnit=r,o.selectedStores.push(s)}o.storesCopy.length-1==e&&(o.selectedStores=_.orderBy(o.selectedStores,function(e){return e||0},["desc"]),o.itemArray=angular.copy(o.storesCopy),o.storeCopy=angular.copy(o.itemArray),o.isRefreshloader1=!1)});_.filter()}else 200==e.statusCode&&e.response.success&&0==e.response.result.length&&(o.itemArray=angular.copy(s),o.storeCopy=angular.copy(o.itemArray)),o.isRefreshloader1=!1})}])},o.getAllStoresByProduct=function(){_.isEmpty(i.p_id)||l.getProductAndStores(i.p_id).then(function(r){r&&r.response&&r.response.result&&(o.stockTrack=r.response.result[0]&&r.response.result[0].is_enable_tracking?r.response.result[0].is_enable_tracking:0,_.each(r.response.result,function(e,s){var t=r.response.result[s];o.inv_id=t?t.inv_id:null,o.copy_of_inv_id=angular.copy(o.inv_id),o.stockTrackQty[s]=t?t.stock_onhand:0,o.stockTrackLevel[s]=t?t.reorder_level:0,o.stockSku[s]="undefined"!=e.sku?e.sku:p(i.p_id,e.fk_store_id),r.response.result.length-1==s?o.isloadingstores=!1:o.isloadingstores=!0}),o.isloadingstores=!1)})},o._getAllProductUnits=function(){o.inv.unit.list=[],l.getAllProductUnits().then(function(e){if(e&&200==e.statusCode&&e.response.success&&e&&e.response&&e.response.result)for(var s=e.response.result.length,t=0;t<s;t++){var r={_id:e.response.result[t].iu_id,label:e.response.result[t].unit_name,unit_symbol:e.response.result[t].unit_symbol,selected:!1};o.inv.unit.list.push(r)}})},o.paginate=function(){$("#tblStore").trigger("footable_redraw")},o.updateStatus=function(e){"All"===(o.applicationStatus=e)?o.itemArray=angular.copy(o.storesCopy):(o.itemArray.splice(0,o.itemArray.length),_.each(o.storesCopy,function(s){_.find(o.selectedStores,function(e){return s.store_id===e.store_id})&&o.itemArray.push(s)}))},o.searchStore=function(e){if(0<o.txtSearch.length){e.preventDefault(),o.itemArray.splice(0,o.itemArray.length);var s=t("filter")(o.storesCopy,o.txtSearch);o.itemArray=angular.copy(s)}else o.itemArray=angular.copy(o.storeCopy)},o.searchStatus=function(){""===o.txtSearch&&(o.itemArray.splice(0,o.itemArray.length),o.itemArray=angular.copy(o.storesCopy))},o.changeSelectDeselectAll=function(){_.each(o.itemArray,function(e){e.selected=o.selectDeselectAll,o.checkStoresChanges(e)})},o.deleteFromProdStore=function(e,s){var t={store_ids:[{_id:e}],isNotFromVariants:s};l.removeStore(i.p_id,t).then(function(e){e&&e.response&&e.response.result&&1==e.response.result.sql_msg?n.success(e.response.result.msg,"Success"):e&&e.response&&e.response.result&&1!=e.response.result.sql_msg?n.error("failed ! some warnings found","Warning"):n.error("failed ! some errors found","Error")})},o.checkStoresChanges=function(s){s.selected?_.find(o.selectedStores,function(e){return e.store_id==s.store_id})||(s.fk_product_id=i.p_id,o.selectedStores.push(s),o.newlySelectedStores.push(s)):o.selectedStores=_.filter(o.selectedStores,function(e){return e.store_id!==s.store_id})},o.saveStore=function(){o.isStoreloader=!0,o.uncheckstore=_.filter(o.itemArray,{selected:!1}),o.copy=angular.copy(o.uncheckstore),0<o.newlySelectedStores.length?a.when().then(function(){var e=a.defer(),t=[];return 0<o.copy.length?_.each(o.copy,function(s){t=_.filter(o.selectedStores,function(e){return s.store_id!==e.store_id})}):t=o.newlySelectedStores,e.resolve(t),e.promise}).then(function(e){var s=[],t=[];if(_.each(o.newlySelectedStores,function(e){e.selected?t.push(e):s.push(e)}),0<s.length&&(o.uncheckstore=_.union(o.copy,s)),o.newlySelectedStores.l,o.selectedStores=e,o.isStoreloader=!0,!i.p_id)return n.warning("WARNING: Unable to save.. no available products","WARNING"),o.isStoreloader=!1,void o.init();var r=[];0<o.selectedStores.length||!_.isEmpty(o.selectedStores)?async.waterfall([function(s){if(0<o.uncheckstore.length){var t={isNotFromVariants:!0,store_ids:[]};_.each(o.uncheckstore,function(e){t.store_ids.push({_id:e.store_id})}),l.removeStore(i.p_id,t).then(function(e){e&&e.response&&e.response.result&&e.response.result.sql_msg&&e.response.result.sql_msg.removeVariant?(n.success("Store Successfully Unmapped"),o.init(),o.isStoreloader=!1,s(null)):(e&&e.response&&e.response.result&&e.response.result.sql_msg&&e.response.result&&e.response.result.sql_msg.warning_msg?n.error(e.response.result.sql_msg.warning_msg,"Warning"):n.warning("warnings found","Warning"),o.init(),o.isStoreloader=!1)})}else s(null)},function(e){async.each(o.selectedStores,function(e,s){r.push({inv_id:e.inv_id||null,p_id:i.p_id,purchase_unit_id:e.purchase_unit_id||null,qty_convert:e.qty_convert||null,sales_unit_id:e.sales_unit_id||1,stockTrack:e.stockTrack||1,stockTrackLevel:e.stockTrackLevel||0,stockTrackQty:e.stockTrackQty||0,store_id:e.store_id}),l.assignStore(i.p_id,r).then(function(e){e&&200===e.statusCode&&e.response.success?(o.isStoreloader=!1,s(null)):(n.error(e.response.msg,"Error"),o.init())})},function(e,s){n.success("Record Succesfully Save","Success"),o.isStoreloader=!1,o.init()})}]):(o.isStoreloader=!1,n.warning("WARNING: no newly checked stores","WARNING"),o.init())}):0<o.uncheckstore.length?async.each(o.uncheckstore,function(e,s){var t={store_ids:[{_id:e.store_id}],isNotFromVariants:!0};l.removeStore(i.p_id,t).then(function(e){e&&e.response&&e.response.result&&e.response.result.sql_msg&&e.response.result.sql_msg.removeVariant?s():(e&&e.response&&e.response.result&&e.response.result.sql_msg&&e.response.result&&e.response.result.sql_msg.warning_msg?n.error(e.response.result.sql_msg.warning_msg,"Warning"):n.warning("warnings found","Warning"),o.isStoreloader=!1,o.init())})},function(e,s){n.success("Record Sucessfully Unmapped","Success"),o.isStoreloader=!1,o.init()}):(n.warning("WARNING: no newly checked stores","WARNING"),o.isStoreloader=!1,o.init())},o.changestockTrack=function(t){o.stockTrack=t,_.each(o.inv_stockTrackDets,function(e,s){o.inv_stockTrackDets[s].stockTrack=t})},o.trackThisProduct=function(){o.selectedStores?(o.istrackingloader=!0,o.arrToSend=[],_.each(o.selectedStores,function(e,s){var t={inv_id:e.inv_id,isNotFromVariants:!0,p_id:i.p_id,purchase_unit_id:e.purchase_unit_id,qty_convert:e.qty_convert,sales_unit_id:e&&e.stockTrackUnit&&e.stockTrackUnit.selected?e.stockTrackUnit.selected._id:null,sku:e.stockSku,stockTrack:e.stockTrack,stockTrackLevel:e.stockTrackLevel,stockTrackQty:e.stockTrackQty,store_id:e.store_id,stockTrackUnit:e.stockTrackUnit};o.arrToSend.push(t),Object.keys(o.selectedStores).length-1==s&&l.assignStore(i.p_id,o.arrToSend).then(function(e){e&&200===e.statusCode&&e.response.success?(o.istrackingloader=!1,n.success("Success","Success")):(n.warning("Please hit refresh and review your inputs again, then click save","Warning"),o.istrackingloader=!1),o.getAllStore()})})):n.warning("no record to be updated","Warning")},o.init=function(){console.log("initializing.."),o.isloadingstores=!0,o.getAllStore(),o._getAllProductUnits(),o.getAllStoresByProduct(),o.istrackingloader=!1,o.newlySelectedStores=[]},e.reloadStore=function(){console.log("reloading store.."),o.getAllStore()},e.reloadInv=function(){console.log("reloading inventory.."),o.init()},o.init()}angular.module("POS17").controller("productStoreCtrl",e),e.$inject=["$rootScope","$scope","$state","$filter","toastr","$stateParams","storeFactory","priceHistoryFactory","productFactory","$q","ngDialog","$timeout"]}();
!function(){"use strict";function e(r,e,t,o,a,s,c,n,i){r.categ={repeatSelect:null,availableOptions:[]},r.categories=[],r.prodCategories=[],r.itemArray=[],r.selectedCategory=[],r.store={},r.applicationStatus="",r.categoryCopy=[],r.getAllCategory=function(){console.log("getAllCategory"),async.waterfall([function(t){n.getAllCategory().then(function(e){200==e.statusCode&&e.response.success?(r.categ.availableOptions=e.response.result,r.categories=angular.copy(r.categ.availableOptions),t(null,r.categories)):console.log(e.response.msg)})},function(t,e){a.p_id?i.getProductsCategory(a.p_id).then(function(e){200==e.statusCode&&e.response.success&&0<e.response.result.length?(r.prodCategories=e.response.result,_.each(r.categories,function(t){var e=_.find(r.prodCategories,function(e){return t.c_id===e.fk_category_id});e&&(t.selected=!0,t.fk_category_id=e.fk_category_id,t.fk_product_id=a.p_id,r.selectedCategory.push(t))}),r.itemArray=angular.copy(r.categories),r.categoryCopy=angular.copy(r.categories)):200==e.statusCode&&e.response.success&&0===e.response.result.length?r.itemArray=angular.copy(t):console.log(e.response.msg)}):r.itemArray=angular.copy(t)}])},r.getAllCategory(),r.paginate=function(){$("#tblCategory").trigger("footable_redraw")},r.changeSelectDeselectAll=function(){_.each(r.itemArray,function(e){e.selected=r.selectDeselectAll,r.checkStoresChanges(e)})},r.checkStoresChanges=function(t){if(t.selected){var e=_.find(r.selectedCategory,function(e){return e.c_id===t.c_id});_.isUndefined(e)&&(t.fk_category_id=t.c_id,t.fk_product_id=a.p_id,r.selectedCategory.push(t))}else r.selectedCategory=_.filter(r.selectedCategory,function(e){return e.c_id!==t.c_id})},r.updateStatus=function(e){""===(r.applicationStatus=e)?r.itemArray=angular.copy(r.categories):(r.itemArray.splice(0,r.itemArray.length),_.each(r.categories,function(t){_.find(r.selectedCategory,function(e){return t.c_id===e.fk_category_id})&&r.itemArray.push(t)}))},r.searchCategory=function(e){if(0<r.txtSearch.length){e.preventDefault(),r.itemArray.splice(0,r.itemArray.length);var t=s("filter")(r.categories,r.txtSearch);r.itemArray=angular.copy(t)}else r.itemArray=angular.copy(r.categoryCopy)},r.searchStatus=function(){""===r.txtSearch&&(r.itemArray.splice(0,r.itemArray.length),r.itemArray=angular.copy(r.categories))},r.saveCategory=function(){console.log("saveCategory",r.selectedCategory);a.p_id&&(0<r.selectedCategory.length?async.waterfall([function(t){i.deleteProductCategory(a.p_id).then(function(e){200==e.statusCode&&e.response.success?t(null,e.response.result):t(e.response.msg,null)})},function(e,t){async.each(r.selectedCategory,function(e,t){i.saveProductsCategory(a.p_id,{category_id:e.c_id}).then(function(e){200===e.statusCode&&e.response.success?t(null,!0):(t(null,e.response.msg),c.error(e.response.msg,"Error"))})},function(e,t){c.success(t.response.msg,"Success")})}]):c.warning("No category(s) selected","Warning"))},e._getAllCategories=function(){r.getAllCategory()}}angular.module("POS17").controller("productCategoryCtrl",e),e.$inject=["$scope","$rootScope","$timeout","$state","$stateParams","$filter","toastr","categoryFactory","productFactory"]}();
!function(){"use strict";function e(e,o,s,t,i,u,r,n,a,l,c,d,p,g){console.log("productStoreCtrl"),o.attributes=[],o.attribute_values=[],o.getAllProductAttributes=function(){o.details.doc=p.get("visibility"),async.waterfall([function(t){a.getProductDetails(r.p_id).then(function(e){200==e.statusCode&&e.response.success&&e.response.result.productType_id&&t(null,e.response.result.productType_id)})},function(e,s){c.getAttributeMapping(e).then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;s(null,t)}else console.log(e.response.msg)})},function(s,i){a.getProductAttributes(r.p_id).then(function(e){if(e&&200==e.statusCode&&e.response.success){var t=e.response.result;i(null,s,t)}else console.log(e.response.msg)})},function(s,i,u){d.getAllCategory().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;u(null,s,i,t)}else console.log(e.response.msg)})},function(t,u,n,o){a.getProductsCategory(r.p_id).then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result,i=[];_.each(n,function(t){_.find(s,function(e){return t.c_id===e.fk_category_id})&&i.push(t)}),o(null,t,u,i)}else console.log(e.response.msg)})},function(e,i,s,t){var u=[];if(_.each(e,function(e){var t=_.filter(s,{c_id:e.fk_c_id});t&&0<t.length&&u.push(e)}),u&&0<u.length){var n=_.map(u,function(e){return e.attributes});_.each(n,function(e){var t=_.find(i.attribute_values,{att_id:e.att_id}),s=_.find(i.attribute_value_list,{att_id:e.att_id});t?(e.unique_id=t._id,e.value=t.value):(e.value=null,e.unique_id=null),e.attribute_list_value=s?s.attribute_list:[]}),o.attributes=n}else{n=_.map(e,function(e){return e.attributes});_.each(n,function(e){var t=_.find(i.attribute_values,{att_id:e.att_id}),s=_.find(i.attribute_value_list,{att_id:e.att_id});t?(e.unique_id=t._id,e.value=t.value):(e.value=null,e.unique_id=null),e.attribute_list_value=s?s.attribute_list:[]}),o.attributes=n}_.each(o.attributes,function(e){"Checkbox"==e.attribute_type&&("1"==e.value?e.checked=!0:e.checked=!1)})}])},o.deleteAttributeValue=function(e){_.isUndefined(e.value)?i.warning("Unable to save no attribute value","Warning"):n.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:o,className:"ngdialog-theme-default"}).then(function(){l.deleteAttributeValues(e.att_id,e.unique_id).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),s.reload()):i.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},o.saveShow=function(){if(o.details.doc){var e={product_id:r.p_id,is_show:1};p.set("visibility",!0),l.updateAttributeVisibility(e).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),s.reload()):i.error(e.response.msg,"Error")})}else{var t={product_id:r.p_id,is_show:0};p.set("visibility",!1),l.updateAttributeVisibility(t).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),s.reload()):i.error(e.response.msg,"Error")})}},o.saveAttributeValue=function(e){if(o.modal={title:"Confirm attribute",message:"Are you sure to save attribute?"},"Checkbox"==e.attribute_type)var t={product_id:r.p_id,bundle_id:null,attribute_id:e.att_id,article_id:null,value:e.checked,value_image:null,name:e.name,description:"",is_single:0,is_image:0,is_video:0,is_audio:0};else{console.log("diri:");t={product_id:r.p_id,bundle_id:null,attribute_id:e.att_id,article_id:null,value:e.value,value_image:null,name:e.name,description:"",is_single:0,is_image:0,is_video:0,is_audio:0}}_.isUndefined(e.value)?i.warning("Unable to save no attribute value","Warning"):n.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:o,className:"ngdialog-theme-default"}).then(function(){_.isNull(e.unique_id)?(console.log("Save New"),l.saveAttributeValues(e.att_id,t).then(function(e){200==e.statusCode&&e.response.success?i.success(e.response.msg,"Success"):i.error(e.response.msg,"Error")})):(console.log("Updated"),l.updateAttributeValues(e.att_id,e.unique_id,t).then(function(e){200==e.statusCode&&e.response.success?i.success(e.response.msg,"Success"):i.error(e.response.msg,"Error")}))},function(e){console.log("Modal promise close: ")})},e.reloadAtt=function(){console.log("..."),o.getAllProductAttributes()},o.remove_attrib_val_list=function(e){a.deleteProductAttributeListMapping(r.p_id,e.prod_att_id).then(function(e){e&&e.response&&e.response.success?0<e.response.result?i.success("Successfully Deleted"):i.warning("Warnings found"):i.error("Error")})},o.save_attrib_val_list_single=function(e,t){a.mapProductAttributeList(r.p_id,e.prod_att_id).then(function(e){e&&e.response&&e.response.success?0<e.response.result?i.success("Successfully Added"):i.warning("Warnings found"):i.error("Error")})},o.__hmm=function(e){console.log("val ",e)},o.data_src=[],o.unique=function(t,e){_.each(t.attribute_list_value,function(e){e.selected=!0,e.value_image=g+"/"+e.value_image}),a.getMappedProductAttributeList(r.p_id,t.att_id).then(function(e){200==e.statusCode&&e.response.success?e.response.result&&(t.selected_attribute_list_value=e.response.result):i.error("Error")}),o.data_src[e]=_.uniq(t.attribute_list_value)},o.getData=function(e){return parseInt(e)},o.init=function(){u(function(){o.getAllProductAttributes()},1e3)},o.init()}angular.module("POS17").controller("productAttributeCtrl",e),e.$inject=["$rootScope","$scope","$state","$filter","toastr","$timeout","$stateParams","ngDialog","productFactory","attributeFactory","ptypeFactory","categoryFactory","localStorageService","API_URL"]}();
!function(){"use strict";function t(u,l,a,t,n,e,c,d,o,s,r,i,p,f,v,h,m,g,b,y){console.log("productVariantsCtrl.."),l.isVariant=!1,l.attributes=[],l.attributevalues=[],l.filteredAttributesByVariants=[],l.dynamicAttributesHolder=[],l.storeids=[],l.attributesByVariants={},l.attributesByVariants.selected={att_id:null,attribute:"Select Attribute"},l.arraysOfSelectedAttributesByVariants=[],l.variation={},l.attribx=[],l.allDetails=[],l.allDetails.attrib_list_value=[],l.allDetails.product_variant={},l.allDetails.product_variant_attrib=[],l.allDetails.inventory=[],l.storeList=[],l.listOfvariants=[],l.specialCells=[],l.loading_one=!1,l.loading_two=!1,l.cursorDisable="cursor: not-allowed;",l.switcherReady=!1,l.showlayer1=0,l.dummyData=[],l.has_variants=0,l.flagFromVariants=!0,l.checkIfDone=function(t,e){l.counter=0,l.doneAddedThisAttribx=!1;for(var s=0;s<e.length;s++)0<e[s].attribute_list_value.length&&(l.counter++,e.length,l.counter)},l.tagAdded=function(t){console.log(t)},l.loadFilteredAttributes=function(s){l.loading_two=!0,async.waterfall([function(e){o.getProductDetails(c.p_id).then(function(t){200==t.statusCode&&t.response.success&&(t&&t.response&&t.response.result&&t.response.result.item_name&&(s||(l.has_variants=t.response.result.has_variants?t.response.result.has_variants:0,l.showlayer1=t.response.result.has_variants?t.response.result.has_variants:0),l.product_name=t.response.result.item_name),t.response.result.productType_id&&e(null,t.response.result.productType_id))})},function(t,s){r.getAttributeMapping(t).then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;s(null,e)}else console.log(t.response.msg)})},function(s,a){o.getProductAttributes(c.p_id).then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;a(null,s,e)}else console.log(t.response.msg)})},function(s,a,r){i.getAllCategory().then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;r(null,s,a,e)}else console.log(t.response.msg)})},function(e,r,i,n){o.getProductsCategory(c.p_id).then(function(t){if(200==t.statusCode&&t.response.success){var s=t.response.result,a=[];_.each(i,function(e){_.find(s,function(t){return e.c_id===t.fk_category_id})&&a.push(e)}),n(null,e,r,a)}else console.log(t.response.msg)})},function(t,a,s,e){var r=[];if(_.each(t,function(t){var e=_.filter(s,{c_id:t.fk_c_id});e&&0<e.length&&r.push(t)}),r&&0<r.length){var i=_.map(r,function(t){return t.attributes});_.each(i,function(t){var e=_.find(a.attribute_values,{att_id:t.att_id}),s=_.find(a.attribute_value_list,{att_id:t.att_id});e?(t.unique_id=e._id,t.value=e.value):(t.value=null,t.unique_id=null),t.attribute_list_value=s?s.attribute_list:[]}),l.attributes=i}else{i=_.map(t,function(t){return t.attributes});_.each(i,function(t){var e=_.find(a.attribute_values,{att_id:t.att_id}),s=_.find(a.attribute_value_list,{att_id:t.att_id});e?(t.unique_id=e._id,t.value=e.value):(t.value=null,t.unique_id=null),t.attribute_list_value=s?s.attribute_list:[]}),l.attributes=i}l.filteredAttributesByVariants=[],l.filteredAttributesByVariants=_.filter(l.attributes,function(t){return 1==t.is_variation}),_.each(l.filteredAttributesByVariants,function(t,e){var s=[];_.each(t.attribute_list_value,function(t){-1==s.indexOf({text:t.name,prod_att_id:t.prod_att_id})?s.push({text:t.name,prod_att_id:t.prod_att_id}):console.log("exist")});_.uniq(s);l.filteredAttributesByVariants.length-1==e&&(l.gsabv(l.filteredAttributesByVariants),l.isVariant=!0,l.checkIfDone(l.arraysOfSelectedAttributesByVariants,l.filteredAttributesByVariants),l.getProductVariantAttributes(),l.switcherReady=!0,l.loading_two=!1)})}])},l.gsabv=function(e){var s=[];p.manipulateVariants(c.p_id,8,{}).then(function(t){t&&t.response&&t.response.result&&t.response.success&&(l.arraysOfSelectedAttributesByVariants=t.response.result,_.each(l.arraysOfSelectedAttributesByVariants,function(t){s.push({att_id:parseInt(t.attributes.att_id)})}),l.filteredAttributesByVariants=_.uniqBy(_.differenceBy(e,s,"att_id"),"att_id"))})},l.filterDefaultAttributes=function(t){console.log("item ",t),t.att_id||(l.dummyData=[],0<t.attribute_list_value.length?_.each(t.attribute_list_value,function(t){l.dummyData.push(t.value)}):console.log("no available defaults"))},l.pullSomeRecords=function(t){var e;e={attributes:l.attributesByVariants.selected,attribute_values:l.dynamicAttributesHolder},!t&&l.save_attrib_val_list(e),0<e.attribute_values.length&&(l.arraysOfSelectedAttributesByVariants.push(e),l.filteredAttributesByVariants=_.pull(l.filteredAttributesByVariants,l.attributesByVariants.selected)),l.dynamicAttributesHolder=[]},l.reverse=function(t){_.pull(l.arraysOfSelectedAttributesByVariants,t),-1==l.filteredAttributesByVariants.indexOf(t.attributes)&&l.filteredAttributesByVariants.push(t.attributes)},l.invtracking={},l.invtracking.details=[],l.invtracking.isTrack=!0,l.invtracking.isDeleted=!1,l.units=[{_id:1,name:"pieces"},{_id:2,name:"boxes"},{_id:3,name:"bottles"},{_id:4,name:"tray"}],l.units.selected={},l.openInvTrackingModal=function(t,o){l.invtracking.details=[];var e={product_variant:t};p.manipulateVariants(c.p_id,7,e).then(function(n){n&&n.response&&n.response.result&&0<n.response.result.length?_.each(n.response.result,function(t,e){var s,a,r,i;l.invtracking.details[e]={sku:t.sku?t.sku:(s=o,a=t.fk_store_id,r=l.product_name.substring(0,3)+a,i=s.split(","),_.each(i,function(t){var e=t.substring(0,2);r+=e.toUpperCase()}),r),stockonhand:t.stock_onhand,reorderlevel:t.reorder_level,name:t.name,fk_store_id:t.fk_store_id,variant_id:t.product_variant_id,units:{selected:{_id:t.sales_unit,name:function(e){var t=_.find(l.units,function(t){return t._id==e});if(t&&t.name)return t.name;console.log("Inventory, inventory_unit_conversion, and prod_store, SQL joining resulted to none, check DB data, or sql statement.\nOr mapped it to store first")}(t.sales_unit)}},stockTrack:t.is_enable_tracking},e==n.response.result.length-1&&(u.modalInstance=d.open({animation:!0,templateUrl:"./modules/products/details/InvTrackingModal.html",size:"lg",scope:l}),u.modalInstance.result.then(function(t){l.selected=t},function(){console.info("Modal dismissed at: "+new Date)}))}):console.log("Inventory, inventory_unit_conversion, and prod_store, SQL joining resulted to none, check DB data, or sql statement.\nOr mapped it to store first")})},l.addAcombination=function(){var a=_.compact(l.attribx),r=[],i="";_.each(a,function(t,e){t.selected.text&&(i+=t.selected.text+(e==a.length-1?"":","));var s={};(s.selected=t.selected,r.push(s),e==a.length-1)&&(l.variation=i,_.find(l.listOfvariants,{variant_name:i})?n.warning("Cannot add duplicates","Warning"):(l.listOfvariants=_.compact(l.listOfvariants),l.listOfvariants.push({variant_name:l.variation,purchase_price:0,markup:0,sell_price:0,attribx:_.compact(r)})))})},l.getStoresByPID=function(){l.storeids=[],o.getProductAndStores(c.p_id).then(function(t){_.each(t.response.result,function(t){l.storeids.push(t.fk_store_id),v.getStoreDetails(t.fk_store_id).then(function(t){t&&t.response.success?t.response&&t.response.result?l.storeList.push(t.response.result):console.log("result_msg_@_function getStoreDetails : "):console.log("msg_@_function getStoreDetails : ")})})})},l.remove_attrib_val_list=function(t){p.manipulateVariants(c.p_id,2,t).then(function(t){t.response.success?(n.success("Successfully removed","Success"),l.loadFilteredAttributes(!0)):n.error(t.response.msg,"Error")})},l.save_attrib_val_list=function(t){var e=[];e.push({att_id:t.attributes.att_id,attribute_values:t.attribute_values}),p.manipulateVariants(c.p_id,1,e).then(function(t){t.response.success?(n.success(t.response.msg,"Success"),l.loadFilteredAttributes(!0),l.attributesByVariants.selected={att_id:null,attribute:"Select Attribute"}):n.error(t.response.msg,"Error")})},l.save_attrib_val_list_single=function(t,e){var s=[],a=[{text:t.text}];s.push({att_id:e.att_id,attribute_values:a}),p.manipulateVariants(c.p_id,1,s).then(function(t){t.response.success?(n.success(t.response.msg,"Success"),l.loadFilteredAttributes(!0)):n.error(t.response.msg,"Error")})},l.finalSubmitVariation=function(t){p.manipulateVariants(c.p_id,3,t).then(function(t){t&&t.response&&t.response.success?(n.success(t.response.msg,"Success"),l.getProductVariantAttributes()):(n.error(t.response.msg,"Error"),l.loading_one=!1)})},l.changePP_2=function(t,e){if(t.purchase_price=Number(t.purchase_price),e.key.match(/[0-9.\b]*$/))if(-0==Number(t.purchase_price)||Number(t.purchase_price)<0)t.purchase_price="",t.sell_price="",t.markup="";else if(isNaN(t.purchase_price))t.purchase_price="",t.markup="",t.sell_price="";else{var s=t.purchase_price;t.sell_price=t.purchase_price*t.markup/100+s}else t.purchase_price&&Number(t.purchase_price)?console.log(t.purchase_price):(t.markup="",t.sell_price="")},l.changeMU_2=function(t,e){if(t.markup=Number(t.markup),e.key.match(/[0-9.\b]*$/))if(Number(t.purchase_price))if(-0==Number(t.markup)||Number(t.markup)<0)t.markup="",t.sell_price=t.purchase_price;else if(isNaN(t.markup))t.markup="";else{var s=t.purchase_price;t.sell_price=t.purchase_price*t.markup/100+s}else console.log("purchase_price is not number")},l.changeSP_2=function(t,e){t.sell_price=Number(t.sell_price),e.key.match(/[0-9.\b]*$/)&&(Number(t.purchase_price)?t.markup=((t.sell_price-t.purchase_price)/t.purchase_price*100).toFixed(0):console.log("purchase_price is not number"))},l.saveVariantDetails=function(r){l.has_variants?async.waterfall([function(t){var e,s=(e=l.has_variants,o.updateProductVariantStatus(c.p_id,{has_variants:e}).then(function(t){return!!(t&&t.response&&t.response.success)}));console.log("x->",s),t(null,!!s)},function(t,e){if(t){l.loading_one=!0,l.allDetails.attrib_list_value=_.compact(l.arraysOfSelectedAttributesByVariants);var s={};if(s.product_variant=_.compact(l.listOfvariants),_.each(s.product_variant,function(t,e){t.attribx=_.compact(t.attribx)}),s.inventory={},s.inventory.storeids=_.uniq(l.storeids),r){var a=[];_.each(l.arraysOfSelectedAttributesByVariants,function(t){_.each(t.attribute_values,function(t){a.push(t)})}),n.warning("This feature will be ready next sprint","Warning")}else 0<s.inventory.storeids.length?l.finalSubmitVariation(s):(n.warning("Please map this to store(s) first","Warning"),l.loading_one=!1)}else n.error("enabling variants failed!","Error")}]):n.warning("toggle button not enabled","Warning")},l.getProductVariantAttributes=function(){var s={};l.att_ids=[],_.each(l.arraysOfSelectedAttributesByVariants,function(t,e){-1==l.att_ids.indexOf(t.attributes.att_id)&&l.att_ids.push(t.attributes.att_id),l.arraysOfSelectedAttributesByVariants.length-1==e&&(s.att_ids=l.att_ids,p.manipulateVariants(c.p_id,4,s).then(function(t){t&&t.response&&t.response.success?(l.listOfvariants=t.response.result,_.each(l.listOfvariants,function(t){t.product_imgPath=b+"/"+t.product_imgPath}),l.loading_one=!1):n.error(t.response.msg,"Error")}))})},l.delete_variant=function(e){l._message="",1==l.listOfvariants.length?l._message="Deleting the last variant will mean that the product no longer has variants.\nAre you sure you want to delete this variant?":l._message="Are you sure you want to delete this variant ?",m.openConfirm({templateUrl:"modules/dialog/customDeleteDialog.html",scope:l,className:"ngdialog-theme-default"}).then(function(){var t={variant_id:e};p.manipulateVariants(c.p_id,5,t).then(function(t){t.response.success?1==l.listOfvariants.length?o.updateProductVariantStatus(c.p_id,{has_variants:0}).then(function(t){t&&t.response&&t.response.success?(n.success("Successfully deleted","Success"),l.init_1()):n.error("Updating has_variants status in products unsuccessful","Error")}):(n.success("Successfully deleted","Success"),l.init_1()):n.warning("Cant delete this record, some errors found, or stock on hand greater than 0","Warning")})})},l.changeInvdetails=function(t,e){isNaN(l.invtracking.details[t].stockonhand)&&console.log("not a number bro"),l.invtracking.details[t].store_id=e},l.saveToInventory=function(){p.manipulateVariants(c.p_id,6,l.invtracking).then(function(t){t.response.success?n.success("Success","Success"):n.warning("Some warnings found","Warning")})},l.applyCIToAllStore=function(e){_.each(l.invtracking.details,function(t){t.stockonhand=e})},l.applyRLToAllStore=function(e){_.each(l.invtracking.details,function(t){t.reorderlevel=e})},l.ok=function(){$uibModalInstance.close(l.selected.item)},l.closeThisModal=function(){u.modalInstance.dismiss()},l.switchChange=function(){0<l.listOfvariants.length&&o.updateProductVariantStatus(c.p_id,{has_variants:l.has_variants}).then(function(t){return!!(t&&t.response&&t.response.success)})},l.init_1=function(){l.loadFilteredAttributes(),l.pullSomeRecords(!0),l.getStoresByPID()},l.init_1(),u.reloadVar=function(){console.log("..."),l.init_1()},l.detail={},l.openVariantImgUploader=function(e){var t={variant_id:e};p.manipulateVariants(c.p_id,10,t).then(function(t){t&&t.response&&t.response.success?(l.listOfvariants=t.response.result,_.each(l.listOfvariants,function(t){t.product_imgPath=b+"/"+t.product_imgPath}),0<l.listOfvariants.length?l.detail.value_image=l.listOfvariants[0].product_imgPath:l.detail.value_image=null):n.error(t.response.msg,"Error")});var s=d.open({animation:!0,backdrop:"static",templateUrl:"modules/products/details/product.upload.variant.modal.html",scope:l,resolve:{}});s.result.then(function(){},function(){}),l.uploadContacts=function(t){g.upload({url:b+y+"product/"+c.p_id+"/productvariant/9",data:{product_imgPath:l.detail.value_image,variant_id:e},method:"POST"}).then(function(t){if(200===t.data.statusCode&&t.data.response.success)n.success(t.data.response.msg,"Success"),a.reload();else{if(400!==t.data.statusCode||t.data.response.success||!_.isArray(t.data.response.result))return void n.error(t.data.response.msg,"Error");_.each(t.data.response.result,function(t){n.warning(t.msg,"Warning")})}s.dismiss("close")},function(t){console.log("Error status: "+t.status)})},l.removethumb=function(){l.detail.value_image=null},l.cancel=function(){s.dismiss("close"),l.loadFilteredAttributes(!0),l.detail.value_image=null}}}function e(t,e,s,a,r,i,n){}angular.module("POS17").controller("productVariantsCtrl",t).controller("productVariantsModalCtrl",e),t.$inject=["$rootScope","$scope","$state","$filter","toastr","$timeout","$stateParams","$uibModal","productFactory","attributeFactory","ptypeFactory","categoryFactory","variationFactory","priceHistoryFactory","storeFactory","$http","ngDialog","Upload","API_URL","API_VERSION"],e.inject=["$scope","$uibModalInstance","variantDetails","invUnits","$stateParams","toastr","variationFactory"]}();
!function(){"use strict";function t(a,t,o,e,n,r){a.rating1=5,a.isReadonly=!0,a.dtFrom=new Date;var d=new Date;a.dtTo=d.setMonth(d.getMonth()+1),a.openDate=function(){r.open({animation:!0,templateUrl:"./modules/dialog/datepicker.modal.html",controller:"ModalInstanceCtrl",size:"sm",resolve:{dateValue:function(){return{dateFrom:a.dtFrom,dateTo:a.dtTo}}}}).result.then(function(t){a.dtFrom=t.dateFrom,a.dtTo=t.dateTo;var o=moment(a.dtFrom).format("YYYY-MM-DD"),e=moment(a.dtTo).format("YYYY-MM-DD");populateGraph(o,e)})}}angular.module("POS17").controller("productRatingCtrl",t),t.$inject=["$scope","$state","$filter","toastr","$stateParams","$uibModal"]}();
!function(){"use strict";function e(o,n,e,l,r,a,t,s,c){o.selectDeselectAllRelation=!1,o.selectedDatas=[],o.products=[],o.productCopy=[],o.relatedProducts=[],e.getAllProduct().then(function(e){200==e.statusCode&&e.response.success&&(o.products=e.response.result,o.productCopy=angular.copy(o.products))}),o.getAllRelatedProducts=function(){o.relatedProducts=[],a.p_id&&l.getAllRelatedProduct(a.p_id).then(function(e){200==e.statusCode&&e.response.success&&(o.relatedProducts=e.response.result,console.log("getAllRelatedProducts: ",o.relatedProducts))})},o.getAllRelatedProducts(),o.changeSelectDeselectAllRelated=function(){_.each(o.relatedProducts,function(e){e.selected=o.selectDeselectAllRelation,o.checkRelationChanges(e)})},o.checkRelationChanges=function(t){t.selected?_.find(o.selectedDatas,function(e){return e.rel_id===t.rel_id})||o.selectedDatas.push(t):o.selectedDatas=_.filter(o.selectedDatas,function(e){return e.rel_id!==t.rel_id}),o.deleteSomeData=0<o.selectedDatas.length},o.addNewEntry=function(){t.open({animation:!0,templateUrl:"./modules/products/details/related.product.modal.html",controller:"productRelatedModalCtrl",size:"lg",resolve:{products:function(){return o.products},product:function(){return a.p_id}}}).result.then(function(e){n.reload()})},o.openRelationType=function(){t.open({animation:!0,templateUrl:"./modules/products/relation.type.modal.html",controller:"relationTypeCtrl",size:"lg"}).result.then(function(e){n.reload()})},o.deleteSelectedRelated=function(){o.modal={title:"Archive Product?",message:"Are you sure to archive this selected products?"},s.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:o,className:"ngdialog-theme-default"}).then(function(){var s=1;0<o.selectedDatas.length&&async.eachSeries(o.selectedDatas,function(e,t){e.selected&&l.deleteRelatedProduct(a.p_id,e.rel_id).then(function(e){200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),s++,t()):r.error(e.response.msg,"Error")}),s==o.selectedDatas.length&&n.reload()})})},o.deleteSelected=function(e){o.modal={title:"Delete Product Relation?",message:"Are you sure to delete this selected product relation?"},s.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:o,className:"ngdialog-theme-default"}).then(function(){l.deleteRelatedProduct(a.p_id,e).then(function(e){200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),c(function(){n.reload()},300)):r.error(e.response.msg,"Error")})})}}function t(t,s,o,e,n,l,r,a){t.relation={},t.relationtypes=[],t.relatedProducts=[],t.infiniteScrollContacts={},t.infiniteScrollContacts.numToAdd=10,t.infiniteScrollContacts.currentItems=10,n.getAllRelationType().then(function(e){200==e.statusCode&&e.response.success?t.relationtypes=e.response.result:console.log(e.response.msg)}),_.isUndefined(r)||(t.relation={},t.selected={},t.relatedProducts=[],t.relatedProducts=_.filter(l,function(e){return e.p_id!==r}),t.relation.product_id=r),t.resetInfScroll=function(){t.infiniteScrollContacts.currentItems=t.infiniteScrollContacts.numToAdd},t.addMoreItems=function(){t.infiniteScrollContacts.currentItems+=t.infiniteScrollContacts.numToAdd},t.saveEntry=function(){t.relation.ref_id=t.relation.product.p_id,_.isUndefined(t.relation.ref_id)?o.warning("Unable to saved related products. Please provide Product and Relation Type","Warning"):n.saveRelatedProduct(r,t.relation).then(function(e){if(200==e.statusCode&&e.response.success)o.success(e.response.msg,"Success"),a(function(){s.close()},600);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void o.error(e.response.msg,"Error");_.each(e.response.result,function(e){o.warning(e.msg,"Warning")})}})},t.cancel=function(){s.dismiss("cancel")}}function s(t,s,e,o,n){t.relationtypes=[],t.relation={},t.relation.disablename=!0,t.relation.disablelabel=!0,t.relation.disabledesc=!0,t.relation.disabletype=!0,t.relation.disablenewbutton=!1,t.relation.disablesavebutton=!0,t.state="add",o.getAllRelationType().then(function(e){200==e.statusCode&&e.response.success?t.relationtypes=e.response.result:console.log(e.response.msg)}),t.refreshData=function(){t.relationtypes=[],o.getAllRelationType().then(function(e){200==e.statusCode&&e.response.success?(t.relationtypes=e.response.result,console.log("$scope.relationtypes: ",t.relationtypes)):console.log(e.response.msg)})},t.newEntry=function(){t.relation={},t.relation.disablename=!1,t.relation.disablelabel=!1,t.relation.disabledesc=!1,t.relation.disabletype=!1,t.relation.disablenewbutton=!0,t.relation.disablesavebutton=!1,t.state="add"},t.cancelEntry=function(){t.relation={},t.relation.disablename=!0,t.relation.disablelabel=!0,t.relation.disabledesc=!0,t.relation.disabletype=!0,t.relation.disablenewbutton=!1,t.relation.disablesavebutton=!0,t.state="add"},t.getSelected=function(e){o.getRelationType(e.rel_type_id).then(function(e){200==e.statusCode&&e.response.success?(t.state="update",t.relation=e.response.result,t.relation.disablename=!1,t.relation.disablelabel=!1,t.relation.disabledesc=!1,t.relation.disabletype=!1,t.relation.disablenewbutton=!0,t.relation.disablesavebutton=!1):console.log(e.response.msg)})},t.deleteSelected=function(e){t.modal={title:"Delete Relation Type?",message:"Are you sure to delete this selected product relation?"},n.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:t,className:"ngdialog-theme-default"}).then(function(){o.deleteRelationType(e).then(function(e){200==e.statusCode&&e.response.success?(s.success(e.response.msg,"Success"),t.refreshData()):s.error(e.response.msg,"Error")})})},t.saveEntry=function(){"add"==t.state?(console.log("add relation: ",t.relation),o.saveRelationType(t.relation).then(function(e){if(200==e.statusCode&&e.response.success)t.cancelEntry(),t.refreshData(),s.success(e.response.msg,"Success");else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void s.error(e.response.msg,"Error");_.each(e.response.result,function(e){s.warning(e.msg,"Warning")})}})):(console.log("update relation: ",t.relation),o.updateRelationType(t.relation.rel_type_id,t.relation).then(function(e){if(200==e.statusCode&&e.response.success)t.cancelEntry(),t.refreshData(),s.success(e.response.msg,"Success");else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void s.error(e.response.msg,"Error");_.each(e.response.result,function(e){s.warning(e.msg,"Warning")})}}))},t.cancel=function(){e.dismiss("cancel")}}angular.module("POS17").controller("productRelatedCtrl",e).controller("productRelatedModalCtrl",t).controller("relationTypeCtrl",s),e.$inject=["$scope","$state","productFactory","relatedProductFactory","toastr","$stateParams","$uibModal","ngDialog","$timeout"],t.$inject=["$scope","$uibModalInstance","toastr","productFactory","relatedProductFactory","products","product","$timeout"],s.$inject=["$scope","toastr","$uibModalInstance","relatedProductFactory","ngDialog"]}();
!function(){"use strict";function e(o,t,e,r,s,a,l,n,i,c,u){o.uploaded=!1;var p=!(o.item={}),d=JSON.parse(i.get("user")),f=o.uploader=new e({url:r+s+"product/"+a+"/upload-batch-image",method:"PUT",headers:{Authorization:"Bearer "+n.getUserToken(),accesskey:d.subscriptionKey}});f.filters.push({name:"imageFilter",fn:function(e,o){var t="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(t)}}),f.filters.push({name:"_isValidFile",fn:function(e,o){return!!function(e){var o=e.split(" ");if(0<o.length)return"mb"==o[1].toLowerCase()?parseFloat(o[0])<=2:"gb"!=o[1].toLowerCase()&&"tb"!=o[1].toLowerCase()&&("kb"==o[1].toLowerCase()||"bytes"==o[1].toLowerCase())}(function(e,o){if(0==e)return"0 Bytes";var t=o||2,r=Math.floor(Math.log(e)/Math.log(1e3));return parseFloat((e/Math.pow(1e3,r)).toFixed(t))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}(e.size))||(u.error("File Size Limit Exceeded","Error"),!1)}}),f.onBeforeUploadItem=function(e){e.alias="product_img"},f.onErrorItem=function(e,o){400!=o.statusCode||o.success||(u.error(o.response.msg,"Error"),p=!0)},f.onCompleteAll=function(e){console.log("complete"),o.uploaded=!0,f.progress<100?p||u.success("Media / File upload complete","Success"):100==f.progress&&(p||u.success("All Media / File upload successfully","Success"),c(function(){t.close(o.uploaded)},1300))},o.cancel=function(){t.close(o.uploaded)}}angular.module("POS17").controller("productUploaderModalCtrl",e),e.$inject=["$scope","$uibModalInstance","FileUploader","API_URL","API_VERSION","product_id","Upload","AuthFctry","localStorageService","$timeout","toastr"]}();
!function(){"use strict";function e(a,s,e,t,o,l,c,u,r,n,i,d,p){a.uploaded=!1,a.details={},a.applicationStatustxt="Choose Folder",a.applicationStatus=[],console.log("productAssetUploaderModalCtrl");var f=!(a.item={}),S=JSON.parse(r.get("user")),g=a.uploader=new e({url:t+o+"assets",method:"POST",headers:{Authorization:"Bearer "+u.getUserToken(),accesskey:S.subscriptionKey}});d.getAllFolderAssets().then(function(e){200==e.statusCode&&e.response.success&&(a.applicationStatus=e.response.result,console.log("$scope.applicationStatus",a.applicationStatus))}),a.updateStatus=function(e,s){a.applicationStatustxt=e,a.details.fk_folder_id=s,console.log("$scope.details",a.details)},g.onBeforeUploadItem=function(e){e.alias="files",e.formData.push({id:123123})},g.onErrorItem=function(e,s){400!=s.statusCode||s.success||(i.error(s.response.msg,"Error"),f=!0)},g.onSuccessItem=function(e,s,t,o){200==s.statusCode&&s.response.success&&(a.details.fk_asset_id=s.response.result,a.details.fk_pv_id=null,a.details.status="",p.saveProductAssets(l,a.details).then(function(e){200==e.statusCode&&e.response.success&&console.log("data.response",e.response)}))},g.onCompleteAll=function(e){console.log("complete"),a.uploaded=!0,g.progress<100?f||i.success("Media / File upload complete","Success"):100==g.progress&&(f||i.success("All Media / File upload successfully","Success"),n(function(){s.close(a.uploaded)},1300))},a.cancel=function(){s.close(a.uploaded)}}angular.module("POS17").controller("productAssetUploaderModalCtrl",e),e.$inject=["$scope","$uibModalInstance","FileUploader","API_URL","API_VERSION","product_id","Upload","AuthFctry","localStorageService","$timeout","toastr","assetsFctry","productFactory"]}();
!function(){"use strict";function e(l,e,c,t,i,s,r,a,o,n,d,u,p,f,h,g){l.progressState=0,l.search={},l.currentNode={},l.currentPage=1,l.entryLimit=5,l.selectDeselectAll=!1,l.applicationStatus="All",l.displayModel="List",l.filterStatus="Relevance",l.txtSearch={text:""},l.isList=!1,l.viewby=25,l.pageSize=l.viewby,l.currentPage=1,l.itemsPerPage=20,l.totalUsers=0,l.categories=[],l.selectedDatas=[],l.selectedPublishedDatas=[],l.selectedDraftedDatas=[],l.selectedArchivedDatas=[],l.categoryData=[],l.categoryDataCopy=[],l.productsToFilter=[],l.tagsArr=[],l.tagsFilter=[],l.example8settings={showCheckAll:!1,showUncheckAll:!1,enableSearch:!0,scrollableHeight:"300px",scrollable:!0};var m=[],v=[];l.side=!1,l.readyToExport=[],l.reportFields={p_id:"Product ID",variant_id:"Variant ID",item_name:"Name",item_overview:"Overview",item_description:"Description",product_code:"Product Code",barcode:"Barcode",brand:"Product Brand",product_type:"Product Type",productType_id:"Product TypeID",sell_price:"Selling Price",markup:"Markup",purchase_price:"Purchase Price",vat:"VAT",start_date:"Start Date",end_date:"End Date",store_name:"Store Name",store_id:"Store ID",img_default:"Product Image",is_archived:"IsArchived",is_published:"IsPublished",_id:"UUID",variant_is_active:"Variant IsActive",variant_is_deleted:"Variant IsActive",variant_is_published:"Variant IsPublished",variant_markup:"Variant MarkUp",variant_name:"Variant Name",variant_purchase_price:"Variant Purchase Price",variant_sell_price:"Variant Sell Price",sku:"Variant SKU"},l.productsWithVariation=function(){l.readyToExport=[],r.getProductAndVariants({offset:0,limit:null,isExportAction:!0}).then(function(e){l.tmpA=_.filter(e.response.result.result,function(e){return null!=e.inventory_id}),l.tmpB=_.each(l.tmpA,function(e,t){e.magicId=t}),l.uniq_products1=_.uniqBy(_.filter(l.tmpB,function(e){return null!=e.variant_id}),"variant_id"),l.uniq_products2=_.filter(l.tmpB,function(e){return null==e.variant_id}),l.tmpC=_.uniqBy(_.concat(l.uniq_products1,l.uniq_products2),"magicId"),l.tmpD=_.uniqBy(l.tmpC,"product_name_variant"),l.tmpD&&0<l.tmpD.length?_.each(l.tmpD,function(e){if(e&&e.product_id){var t=(r=e.product_id,_.find(l.products,{p_id:r}));l.readyToExport.push({p_id:e.product_id,variant_id:e.variant_id||null,item_name:e.product_has_variants?e.product_name_variant:e.product_name,item_overview:t?t.item_overview:null,item_description:t?t.item_description:null,product_code:t?t.product_code:null,barcode:t?t.barcode:null,brand:e.brand_name?e.brand_name:null,product_type:t?t.product_type:null,productType_id:t?t.productType_id:null,sell_price:e.product_has_variants?e.variant_sell_price:e.product_sell_price,markup:e.product_has_variants?e.variant_markup:e.product_markup,purchase_price:e.product_has_variants?e.variant_purchase_price:e.product_purchase_price,vat:t?t.vat:null,start_date:t?t.start_date:null,end_date:t?t.end_date:null,store_name:t?t.store_name:null,store_id:e.store_id,img_default:t?t.img_default:null,is_archived:e.product_has_variants?e.variant_is_deleted:e.product_is_archived,is_published:e.product_has_variants?e.variant_is_published:e.product_is_published,_id:t?t._id:null,variant_is_active:e.variant_id&&e.variant_is_active?e.variant_is_active:"",variant_is_deleted:e.variant_id&&e.variant_is_deleted?e.variant_is_deleted:"",variant_is_published:e.variant_id&&e.variant_is_published?e.variant_is_published:"",variant_markup:e.variant_id&&e.variant_markup?e.variant_markup:"",variant_name:e.variant_id&&e.variant_name?e.variant_name:"",variant_purchase_price:e.variant_id&&e.variant_purchase_price?e.variant_purchase_price:"",variant_sell_price:e.variant_id&&e.variant_sell_price?e.variant_sell_price:"",sku:e.sku?e.sku:null})}else console.log("value not found");var r}):console.log("tmpD length < 1")})};var y=JSON.parse(d.get("user"));u.logTransaction("View Products","PRODUCTS","ALL","User:="+y.username+" View ALL List of products");var D=function(){l.productTable=new o({page:1,count:20,filter:l.txtSearch},{counts:[20,50,70,100],getData:function(a,o){l.productIsLoading=!0,l.products=[],l.productscopy=[],r.getAllProduct().then(function(e){if(200==e.statusCode&&e.response.success){var r=_.filter(_.orderBy(e.response.result,["is_published"],["desc"]),function(e){return 1!=e.is_archived});if(l.productsWithVariation(),l.totalItems=r.length,l.productscopy=angular.copy(r),o.filter().text&&"All"==l.applicationStatus&&_.isEmpty(l.currentNode))l.products=c("filter")(r,o.filter().text);else if(o.filter().text&&"Publish"==l.applicationStatus&&_.isEmpty(l.currentNode))l.products=c("filter")(r,{is_published:1}),l.products=c("filter")(l.products,o.filter().text);else if(o.filter().text&&"Archived"==l.applicationStatus&&_.isEmpty(l.currentNode))l.products=c("filter")(r,{is_archived:1}),l.products=c("filter")(l.products,o.filter().text);else if(o.filter().text&&"Draft"==l.applicationStatus&&_.isEmpty(l.currentNode))l.products=c("filter")(r,{is_archived:0,is_published:0}),l.products=c("filter")(l.products,o.filter().text);else if(_.isEmpty(o.filter().text)&&"All"==l.applicationStatus)_.isEmpty(l.currentNode)?l.products=r:_.each(l.productsToFilter,function(e){var t=_.find(r,{p_id:e.p_id});t&&l.products.push(t)});else if(_.isEmpty(o.filter().text)&&"Publish"==l.applicationStatus)if(o.page(1),_.isEmpty(l.currentNode))l.products=c("filter")(r,{is_published:1});else{var i=c("filter")(r,{is_published:1});_.each(l.productsToFilter,function(e){var t=_.find(i,{p_id:e.p_id});t&&l.products.push(t)})}else if(_.isEmpty(o.filter().text)&&"Archived"==l.applicationStatus)if(o.page(1),_.isEmpty(l.currentNode))l.products=c("filter")(r,{is_archived:1});else{i=c("filter")(r,{is_archived:1});_.each(l.productsToFilter,function(e){var t=_.find(i,{p_id:e.p_id});t&&l.products.push(t)})}else if(_.isEmpty(o.filter().text)&&"Draft"==l.applicationStatus)if(o.page(1),_.isEmpty(l.currentNode))l.products=c("filter")(r,{is_archived:0,is_published:0});else{i=c("filter")(r,{is_archived:0,is_published:0});_.each(l.productsToFilter,function(e){var t=_.find(i,{p_id:e.p_id});t&&l.products.push(t)})}else l.products=r;if("Most Viewed"==l.filterStatus?(l.products=c("orderBy")(l.products,"product_views",!0),l.products=_.filter(l.products,function(e){return 0<parseInt(e.product_views)})):"Price: High to Low"==l.filterStatus?l.products=c("orderBy")(l.products,"sell_price",!0):"Price: Low to High"==l.filterStatus&&(l.products=c("orderBy")(l.products,"sell_price",!1)),l.tagsFilter&&0<l.tagsFilter.length){var s=[];_.each(l.tagsFilter,function(t){_.each(l.products,function(e){_.find(e.tags,{tags_id:t.id})&&s.push(e)})}),l.products=s}l.selectedDatas&&0<l.selectedDatas.length&&_.each(l.products,function(t){_.find(l.selectedDatas,function(e){return e.p_id===t.p_id})&&(t.selected=!0)}),console.log("params.page():",o.page()),o.total(l.products.length);var t=l.products.slice((o.page()-1)*o.count(),o.page()*o.count());a.resolve(t),l.productIsLoading=!1}else l.productIsLoading=!1,console.log(e.response.msg)})}})};f.getAllTags().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;_.each(t,function(e){l.tagsArr.push({id:e.tags_id,label:e.tags,_id:e._id})})}else console.log(e.response.msg)}),l.showAll=function(){l.currentNode={},i(function(){l.productTable.reload()},500)},l.selectEvents={onItemSelect:function(e){l.productTable.reload()},onItemDeselect:function(e){l.productTable.reload()}},l.changeDisplay=function(){l.isList=!l.isList},l.filterByCategory=function(e){var t=[],r={},i={},s=[];if(l.currentNode=e,l.currentNode&&angular.isObject(l.currentNode)){var a=_.find(l.categoryDataCopy,{parentid:e.item.c_id});if(_.isUndefined(a)){var o=_.map(l.productscopy,function(e){var t=_.filter(e.product_category,{category_id:l.currentNode.c_id});if(0<t.length)return _.find(t,function(e){return e})});i=_.filter(o,function(e){if(!_.isUndefined(e))return e}),r=_.map(_.uniqBy(i,"product_id"),function(e){return e.product_id}),_.forEach(r,function(e){t.push(_.find(l.productscopy,{p_id:e}))})}else{var c=_.map(a.items,function(e){return{c_id:e.item.c_id}});_.each(l.productscopy,function(r){_.each(c,function(e){var t=_.filter(r.product_category,{category_id:e.c_id});t&&0<t.length&&s.push(t[0])})});var n=_.map(_.uniqBy(s,"product_id"),function(e){return e.product_id});_.forEach(n,function(e){t.push(_.find(l.productscopy,{p_id:e}))})}}l.productsToFilter=t,l.productTable.reload()},a.getAllCategory().then(function(e){if(200==e.statusCode&&e.response.success){for(var t=e.response.result,r=0;r<t.length;r++){var i=t[r],s=i.label,a=i.parent_id,o=i.c_id;_.isEmpty(v[a])?(v[o]={parentid:a,label:s,item:i,c_id:o},m[o]=v[o]):null!=(i={parentid:a,label:s,item:i})&&(v[a].items||(v[a].items=[]),v[a].items[v[a].items.length]=i,v[o]=i)}l.categoryData=_.omitBy(_.uniq(m),_.isEmpty),l.categoryDataCopy=angular.copy(l.categoryData)}}),D(),a.getAllCategory().then(function(e){200==e.statusCode&&e.response.success&&(l.categories=e.response.result)}),l.setPage=function(e){l.currentPage=e},l.setItemsPerPage=function(e){l.itemsPerPage=e,l.currentPage=1},l.edit=function(e){t.go("main.products-add",{p_id:e})},l.searchData=function(){return l.productTable.reload()},l.refresh=function(){l.productIsLoading=!0,l.productTable.reload()},l.updateStatus=function(e){console.log("updating status.."),l.applicationStatus=e,l.productTable.reload()},l.updateFilterStatus=function(e){l.filterStatus=e,l.productTable.reload()},l.changeSelectDeselectAll=function(){l.selectDeselectAll=!l.selectDeselectAll,_.each(l.products,function(e){e.selected=l.selectDeselectAll,l.checkDataChanges(e)})},l.checkDataChanges=function(t){t.selected?_.find(l.selectedDatas,{p_id:t.p_id})||(l.selectedDatas.push(t),1==t.is_published&&0==t.is_archived&&l.selectedPublishedDatas.push(t),0==t.is_published&&0==t.is_archived&&l.selectedDraftedDatas.push(t),1==t.is_archived&&0==t.is_published&&l.selectedArchivedDatas.push(t)):(l.selectedDatas=_.filter(l.selectedDatas,function(e){return e.p_id!==t.p_id}),l.selectedPublishedDatas=_.filter(l.selectedPublishedDatas,function(e){return e.p_id!==t.p_id}),l.selectedDraftedDatas=_.filter(l.selectedDraftedDatas,function(e){return e.p_id!==t.p_id}),l.selectedArchivedDatas=_.filter(l.selectedArchivedDatas,function(e){return e.p_id!==t.p_id})),l.deleteSomeData=0<l.selectedDatas.length},l.updateHistory=function(e){p.open({animation:!0,backdrop:"static",templateUrl:"./modules/products/product.auditlog.modal.html",controller:"productAuditLogModalCtrl",size:"md",resolve:{product_id:function(){return e}}})},l.toggleModal=function(e){n.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:l,className:"ngdialog-theme-default"}).then(function(){r.archiveProduct(e).then(function(e){200==e.statusCode&&e.response.success?(s.success(e.response.msg,"Success"),t.reload()):s.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},l.deleteSelected=function(){l.modal={title:"Archive Product?",message:"Are you sure to archive this selected products?"},n.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:l,className:"ngdialog-theme-default"}).then(function(){var e=l.selectedDraftedDatas.concat(l.selectedPublishedDatas);0<e.length?async.eachSeries(e,function(e,t){e.selected&&r.archiveProduct(e.p_id).then(function(e){200==e.statusCode&&e.response.success?(s.success(e.response.msg,"Success"),t()):s.error(e.response.msg,"Error")})},function(){t.reload()}):console.log("at else, toPublishedData.length <= 0")})},l.draftSelected=function(){l.modal={title:"Draft Product?",message:"Are you sure to Draft this selected products?"},n.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:l,className:"ngdialog-theme-default"}).then(function(){0<l.selectedDatas.length&&async.eachSeries(l.selectedDatas,function(e,t){e.selected&&r.draftProduct(e.p_id).then(function(e){200==e.statusCode&&e.response.success?(s.success(e.response.msg,"Success"),t()):s.error(e.response.msg,"Error")})},function(){t.reload()})})},l.publishSelected=function(e){l.modal={title:"Publish Product?",message:"Are you sure to Publish this selected products?"},n.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:l,className:"ngdialog-theme-default"}).then(function(){var e=l.selectedDraftedDatas.concat(l.selectedArchivedDatas);0<e.length&&async.eachSeries(e,function(e,t){e.selected&&r.publishProduct(e.p_id).then(function(e){200==e.statusCode&&e.response.success?(s.success(e.response.msg,"Success"),t()):s.error(e.response.msg,"Error")})},function(){t.reload()})})},l.importproduct=function(e){if(console.log("opening dialog to import.."),"csv"==e){var r=p.open({animation:!0,backdrop:"static",size:"sm",templateUrl:"modules/dialog/importProduct.modal.html",scope:l});r.result.then(function(){},function(){}),l.uploadContacts=function(){angular.forEach(l.files,function(t){t.upload=h.upload({url:g.configuration.baseUrl+"/product/import",data:{file:t}}),t.upload.then(function(e){console.log("response.data: ",e.data),i(function(){t.result=e.data,200==e.status?(s.success(e.data.response.msg,"Success"),D(),console.log("reloading at if"),l.files=[],r.dismiss("close")):(500==e.status?(console.log("reloading at else if"),D(),l.files=[],s.error(e.data.response.msg,"Error")):(console.log("reloading at else"),D(),l.files=[],s.warning(e.data.response.msg,"Error")),l.progressState=0)})},function(e){0<e.status&&(l.errorMsg=e.status+": "+e.data)},function(e){t.progress=Math.min(100,parseInt(100*e.loaded/e.total)),l.progressState=Math.min(100,parseInt(100*e.loaded/e.total))})})},l.cancel=function(){r.dismiss("close"),l.files=[],l.progressState=0}}},l.setUploadFile=function(e,t,r,i){console.log("files ",e),e&&"text/csv"!=e[0].type?(s.warning("Format of the choosen File is invalid, please choose CSV file","Warning"),l.files=[]):(l.files=e,l.errFiles=t,l.param=r,l.classification=i)},l.closeThisDialog=function(){$("#kk").dialog("close"),p.close({}),p.dismiss({}),p.hide({})}}angular.module("POS17").controller("productsController",e),e.$inject=["$scope","$http","$filter","$state","$timeout","toastr","productFactory","categoryFactory","ngTableParams","ngDialog","localStorageService","transLogFctry","$uibModal","tagsFactory","Upload","Restangular"]}();
!function(){"use strict";function t(s,t,e){s.currentDate=Date.now(),s.products=[],s.IsExport=!1,t.getAllProduct().then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;_.isEmpty(e)||(s.products=e)}else console.log(t.response.msg)}),s.myFunction=function(){s.IsExport=!0,angular.element(document).ready(function(){e(function(){console.log("basic-table"),$("#basic-table").trigger("footable_redraw")},1e3)})},s.export=function(){var t=Date.now()+"products.pdf",o="{total_pages_count_string}",n=new jsPDF({orientation:"landscape",format:"a4"}),e=document.getElementById("basic-table"),a=n.autoTableHtmlToJson(e);n.autoTable(a.columns,a.data,{addPageContent:function(t){n.setFontSize(20),n.setTextColor(40),n.setFontStyle("normal"),n.text("Products --- Date: "+moment(s.currentDate).format("MM/DD/YYYY hh:mm a"),t.settings.margin.left,15);var e="Page "+t.pageCount;"function"==typeof n.putTotalPages&&(e=e+" of "+o),n.setFontSize(10),n.text(e,t.settings.margin.left,n.internal.pageSize.height-10)},startY:20,margin:{top:30},styles:{overflow:"linebreak",columnWidth:"wrap"},columnStyles:{0:{columnWidth:100},1:{columnWidth:40},2:{columnWidth:40},3:{columnWidth:40},4:{columnWidth:30},5:{columnWidth:20}}}),"function"==typeof n.putTotalPages&&n.putTotalPages(o),n.save(t)}}angular.module("POS17").controller("productsExportsController",t),t.$inject=["$scope","productFactory","$timeout"]}();
!function(){"use strict";function t(e,t,i,a,n){e.paginateNumber=0,e.pagination={currentPage:1,limitWithPage:10,totalPages:0,sumOfPages:0},e.auditlogs=[],e.generateActivityLogs=function(t){a.getProductAuditLog(t,{startWith:e.paginateNumber,limit:e.pagination.limitWithPage}).then(function(t){200==t.statusCode&&t.response.success&&(e.auditlogs=t.response.result,e.pagination.totalPages=t.response.pagination.results,e.pagination.sumOfPages=t.response.pagination.pages)})},n&&e.generateActivityLogs(n),e.addMoreItems=function(){e.paginateNumber=e.pagination.currentPage-1,n&&e.generateActivityLogs(n)},e.filterDate=function(){},e.cancel=function(){i.dismiss("cancel")}}angular.module("POS17").controller("productAuditLogModalCtrl",t),t.$inject=["$scope","$state","$uibModalInstance","productFactory","product_id"]}();
!function(){"use strict";function e(n,e,d,a,t,r,i,s,l,c,o,u,p,f){n.search={},n.currentPage=1,n.entryLimit=5,n.selectDeselectAll=!1,n.applicationStatus="All",n.filterStatus="Relevance",n.txtSearch={item:""},n.selectedDatas=[],n.selectedPublishedDatas=[],n.selectedDraftedDatas=[],n.selectedArchivedDatas=[],n.viewby=25,n.pageSize=n.viewby,n.currentPage=1,n.itemsPerPage=20,n.totalUsers=0,n.tagsArr=[],n.tagsFilter=[],n.example8settings={showCheckAll:!1,showUncheckAll:!1,enableSearch:!0,scrollableHeight:"300px",scrollable:!0},n.reportFields={pb_id:"Bunble ID",bundle_name:"Name",bundle_overview:"Overview",bundle_description:"Description",bundle_code:"Product Code",barcode:"Barcode",bundle_brand:"Product Brand",product_type:"Product Type",product_type_id:"Product TypeID",sell_price:"Selling Price",start_date:"Start Date",end_date:"End Date",is_archived:"IsArchived",is_published:"IsPublished",_id:"UUID"};var h=JSON.parse(u.get("user"));o.logTransaction("View Product Bundles","PRODUCT BUNDLES","ALL","User:="+h.username+" View ALL List of product bundles");f.getAllTags().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;_.each(t,function(e){n.tagsArr.push({id:e.tags_id,label:e.tags,_id:e._id})})}else console.log(e.response.msg)}),n.selectEvents={onItemSelect:function(e){n.productBundleTable.reload()},onItemDeselect:function(e){n.productBundleTable.reload()}},n.edit=function(e){a.go("main.products-add",{p_id:e})},n.searchData=function(){n.productBundleTable.reload()},n.refresh=function(){n.productIsLoading=!0,n.productBundleTable.reload()},n.updateStatus=function(e){n.applicationStatus=e,n.productBundleTable.reload()},n.updateFilterStatus=function(e){n.filterStatus=e,n.productBundleTable.reload()},n.changeSelectDeselectAll=function(){n.selectDeselectAll=!n.selectDeselectAll,_.each(n.bundles,function(e){e.selected=n.selectDeselectAll,n.selectSomeData=n.selectDeselectAll,n.checkDataChanges(e)})},n.checkDataChanges=function(t){t.selected?_.find(n.selectedDatas,{pb_id:t.pb_id})||(n.selectedDatas.push(t),1==t.is_published&&0==t.is_archived&&n.selectedPublishedDatas.push(t),0==t.is_published&&0==t.is_archived&&n.selectedDraftedDatas.push(t),1==t.is_archived&&0==t.is_published&&n.selectedArchivedDatas.push(t)):(n.selectedDatas=_.filter(n.selectedDatas,function(e){return e.pb_id!==t.pb_id}),n.selectedPublishedDatas=_.filter(n.selectedPublishedDatas,function(e){return e.pb_id!==t.pb_id}),n.selectedDraftedDatas=_.filter(n.selectedDraftedDatas,function(e){return e.pb_id!==t.pb_id}),n.selectedArchivedDatas=_.filter(n.selectedArchivedDatas,function(e){return e.pb_id!==t.pb_id})),n.deleteSomeData=0<n.selectedDatas.length},n.updateHistory=function(e){p.open({animation:!0,backdrop:"static",templateUrl:"./modules/products/bundles/bundle.auditlog.modal.html",controller:"productBundleAuditLogModalCtrl",size:"md",resolve:{pb_id:function(){return e}}})},n.toggleModal=function(e){l.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){i.archiveBundle(e).then(function(e){200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),a.reload()):r.error(e.response.msg,"Error")})})},n.archiveSelected=function(){l.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){var s=1,l=n.selectedDraftedDatas.concat(n.selectedPublishedDatas);0<l.length?async.each(l,function(e,t){e.selected&&i.archiveBundle(e.pb_id).then(function(e){200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),s++,t()):r.error(e.response.msg,"Error")}),s==l.length&&a.reload()}):r.warning("Unable to Archive selected Bundle..Selected bundle are either archived","Warning")})},n.draftSelected=function(){n.modal={title:"Draft Product?",message:"Are you sure to Draft this selected bundle?"},l.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){var s=1;0<n.selectedDatas.length&&async.eachSeries(n.selectedDatas,function(e,t){e.selected&&i.draftBundle(e.pb_id).then(function(e){200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),s++,t()):r.error(e.response.msg,"Error")}),s==n.selectedDatas.length&&a.reload()})})},n.publishSelected=function(e){n.modal={title:"Publish Product?",message:"Are you sure to Publish this selected bundle?"},l.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){var s=1,l=n.selectedDraftedDatas.concat(n.selectedArchivedDatas);0<l.length&&async.eachSeries(l,function(e,t){e.selected&&i.publishBundle(e.pb_id).then(function(e){200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),s++,t()):r.error(e.response.msg,"Error")}),s==l.length&&a.reload()})})},n.productIsLoading=!0,n.bundles=[],n.bundlecopy=[],n.productBundleTable=new c({page:1,count:20,filter:n.txtSearch},{counts:[20,35,50,100],getData:function(a,r){i.getAllProductBundle().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;if(_.each(t,function(e){e.date_created=moment(e.date_created).format("YYYY-MM-DD")}),n.bundlecopy=angular.copy(t),r.filter().term&&"All"==n.applicationStatus?n.bundles=d("filter")(t,r.filter().term):r.filter().term&&"Publish"==n.applicationStatus?(n.bundles=d("filter")(t,{is_published:1}),n.bundles=d("filter")(n.bundles,r.filter().term)):r.filter().term&&"Archived"==n.applicationStatus?(n.bundles=d("filter")(t,{is_archived:1}),n.bundles=d("filter")(n.bundles,r.filter().term)):r.filter().term&&"Draft"==n.applicationStatus?(n.bundles=d("filter")(t,{is_published:0,is_archived:0}),n.bundles=d("filter")(n.bundles,r.filter().term)):_.isEmpty(r.filter().term)&&"All"==n.applicationStatus?n.bundles=t:_.isEmpty(r.filter().term)&&"Publish"==n.applicationStatus?n.bundles=d("filter")(t,{is_published:1}):_.isEmpty(r.filter().term)&&"Archived"==n.applicationStatus?n.bundles=d("filter")(t,{is_archived:1}):_.isEmpty(r.filter().term)&&"Draft"==n.applicationStatus?n.bundles=d("filter")(t,{is_published:0,is_archived:0}):n.bundles=t,"Most Viewed"==n.filterStatus?(n.bundles=d("orderBy")(n.bundles,"product_bundle_views",!0),n.bundles=_.filter(n.bundles,function(e){return 0<parseInt(e.product_bundle_views)})):"Price: High to Low"==n.filterStatus?n.bundles=d("orderBy")(n.bundles,"sell_price",!0):"Price: Low to High"==n.filterStatus&&(n.bundles=d("orderBy")(n.bundles,"sell_price",!1)),n.tagsFilter&&0<n.tagsFilter.length){var s=[];_.each(n.tagsFilter,function(t){_.each(n.bundles,function(e){_.find(e.tags,{tags_id:t.id})&&s.push(e)})}),n.bundles=s}n.selectedDatas&&0<n.selectedDatas.length&&_.each(n.bundles,function(t){_.find(n.selectedDatas,function(e){return e.pb_id===t.pb_id})&&(t.selected=!0)}),r.total(n.bundles.length);var l=n.bundles.slice((r.page()-1)*r.count(),r.page()*r.count());a.resolve(l),n.productIsLoading=!1}else n.productIsLoading=!1,console.log(e.response.msg)})}})}angular.module("POS17").controller("productBundlesController",e),e.$inject=["$scope","$http","$filter","$state","$timeout","toastr","productFactory","supplierFctry","ngDialog","ngTableParams","transLogFctry","localStorageService","$uibModal","tagsFactory"]}();
!function(){"use strict";function e(i,t,s,r,n,o,a,e,c,d,u,l,p,g,m,f){i.stateparamsHasValue=!!n.pb_id,0==i.stateparamsHasValue&&(i.fullwidth={width:"100%"}),i.details={},i.ptypes={},i.package={},i.items={},i.list1=[],i.list2=[],i.productCopy=[],i.getSel=[],i.attributes=[],i.product_image=[],i.tags=[],i.tagsArr=[],i.details.tags=[],i.details.start_date=new Date,i.details.end_date=new Date,i.details.is_published=!1,i.details.is_archived=!1,i.isImageNew=!1,i.add=!1,i.displayComposite=!1,i.displayImage=!1,i.image=[],i.txtSearch="",i.myInterval=3e3,i.noWrapSlides=!1,i.activeSlide=0,i.thumbnailSize=5,i.thumbnailPage=1,i.slides=[],i.barcodeoptions={width:2,height:100,quite:10,displayValue:!0,font:"monospace",textAlign:"center",fontSize:12,backgroundColor:"",lineColor:"#000"},i.barcodesType=[{type:"ean",code:"EAN"},{type:"upc",code:"UPC"},{type:"code39",code:"Code39"},{type:"code128b",code:"Code128B"},{type:"code128c",code:"Code128c"},{type:"itf",code:"ITF"},{type:"itf14",code:"ITF14"}],i.mycode={},i.mycode.type="code128b";var h=JSON.parse(m.get("user"));n.pb_id?f.logTransaction("View Product Bundle Details","PRODUCT BUNDLES",n.pb_id,"User:="+h.username+" View product bundle details: ="+n.pb_id):f.logTransaction("Add New Product Bundle","PRODUCTS BUNDLES","N/A","User:="+h.username+" Add new product bundle entry");function y(s){_.each(i.list2,function(e){e.p_id==s.p_id&&(e.quantity=s.quantity)})}i.changeBarcodeType=function(e){g(function(){i.$apply(function(){i.mycode.type=e})},10)},i.refresh=function(){a.getAllProduct().then(function(e){200==e.statusCode&&e.response.success&&(i.productCopy=e.response.result,_.each(i.productCopy,function(e){e.selected=!1,0==e.is_archived&&i.list1.push(e)})),i.models=[{listName:"Package",items:i.list2,dragging:!1},{listName:"Products",items:i.list1,dragging:!1}]})},i.searchData=function(e){i.list1=s("filter")(i.productCopy,e)},e.getAllProdType().then(function(e){200==e.statusCode&&e.response.success?i.ptypes=e.response.result:console.log(e.response.msg)}),l.getAllTags().then(function(e){200==e.statusCode&&e.response.success?i.tagsArr=e.response.result:console.log(e.response.msg)}),_.isEmpty(n.pb_id)?(i.showPublish=!1,i.showArchive=!1):(i.displayComposite=!0,i.displayImage=!0,a.getProductBundleDetails(n.pb_id).then(function(e){if(200==e.statusCode&&e.response.success){var s=0;i.details=e.response.result,i.items=e.response.result,i.product_image=i.details.product_images,_.each(i.product_image,function(e){i.slides.push({image:e.image_path,index:s}),s++}),_.each(i.details.products,function(e){var s=e.product_detail;s.quantity=_.isNull(e.quantity)?0:e.quantity,1!==s.is_archived&&i.list2.push(s)}),i.showPublish=1!=i.details.is_published,i.showArchive=0==i.details.is_archived,i.details.start_date=new Date(i.details.start_date),i.details.end_date=new Date(i.details.end_date),i.details.ptype_id=e.response.result.productType_id,i.details.is_published=i.IntToBoolean(i.details.is_published),i.details.is_archived=i.IntToBoolean(i.details.is_archived),l.getAllProductBundleTags(n.pb_id).then(function(e){200==e.statusCode&&e.response.success&&(i.details.tags=e.response.result)})}})),i.$watch("list2",function(e){i.list2=e,i.models=[{listName:"Package",items:i.list2,dragging:!1},{listName:"Products",items:i.list1,dragging:!1}]},!0),i.$watch("list1",function(e){i.list1=e,i.models=[{listName:"Package",items:i.list2,dragging:!1},{listName:"Products",items:i.list1,dragging:!1}]},!0),i.$watch("models",function(e){i.modelAsJson=e},!0),i.tagTransform=function(e){return{tags:e}},i.clearInput=function(e){e.search=""},i.deleteProductTags=function(e){console.log("deleteProductBundleTag: ",e),n.pb_id&&l.deleteProductBundleTag(n.pb_id,e.tags_id).then(function(e){200==e.statusCode&&e.response.success?r.success(e.response.msg,"Success"):r.error(e.response.msg,"Error")})},i.checkDataChanges=function(s){s.selected?_.find(i.selectedDatas,function(e){return e.store_id===s.store_id})||i.selectedDatas.push(s):i.selectedDatas=_.filter(i.selectedDatas,function(e){return e.store_id!==s.store_id}),i.deleteSomeData=0<i.selectedDatas.length},i.remove=function(e,s){var t=_.findIndex(e.items,function(e){return e.p_id==s.p_id});return e.items.splice(t,1)},i.removeAll=function(s,e){_.each(s.items,function(e){return s.items.splice(s.items,1)})},i.openUploader=function(){p.open({animation:!0,templateUrl:"./modules/products/bundles/product-bundle.upload.modal.html",controller:"productBundleUploaderModalCtrl",size:"lg",resolve:{product_bundle_id:function(){return n.pb_id}}}).result.then(function(e){t.reload()})},i.IntToBoolean=function(e){return 1===e},i.BooleanToInt=function(e){return!0===e?1:0},i.archiveProduct=function(e){a.archiveBundle(e).then(function(e){200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),t.go(t.current,null,{reload:!0})):r.error(e.response.msg,"Error")})},i.publishProduct=function(e){a.publishBundle(e).then(function(e){200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),t.go(t.current,null,{reload:!0})):r.error(e.response.msg,"Error")})},i.addProductBundle=function(){n.pb_id&&(_.isUndefined(i.modelAsJson)||(i.items.products=_.map(i.modelAsJson[0].items,function(e){return{product_id:e.p_id,quantity:e.quantity}})),console.log(i.items),a.updateProductBundle(n.pb_id,i.items).then(function(e){200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),t.go(t.current,{pb_id:n.pb_id},{reload:!0})):r.success(e.response.msg,"Error")}))},i.addProduct=function(){async.waterfall([function(e){n.pb_id?a.updateProductBundle(n.pb_id,i.details).then(function(s){200==s.statusCode&&s.response.success?(r.success(s.response.msg,"Success"),i.items=i.details,e(null,n.pb_id)):(i.validate=s.response.result,_.each(i.validate,function(e){r.warning(s.response.msg,"Error - "+e.msg)}))}):a.saveProductBundle(i.details).then(function(s){200==s.statusCode&&s.response.success?(i.items=i.details,r.success(s.response.msg,"Success"),e(null,s.response.result)):(i.validate=s.response.result,_.each(i.validate,function(e){r.warning(s.response.msg,"Error - "+e.msg)}))})},function(t,n){var o=0;0<i.details.tags.length?async.eachSeries(i.details.tags,function(e,s){e.isTag?l.saveTags(e).then(function(e){200==e.statusCode&&e.response.success?(console.log("saveProductGroupTags bundle_id: ",t),l.saveProductGroupTags(t,{tags_id:e.response.result}).then(function(e){200==e.statusCode&&e.response.success?(o++,s()):r.error(e.response.msg,"Error")})):r.error(e.response.msg,"Error")}):l.saveProductGroupTags(t,{tags_id:e.tags_id}).then(function(e){200==e.statusCode&&e.response.success?(o++,s()):r.error(e.response.msg,"Error")}),o>=i.details.tags.length&&n(null,t)}):n(null,t)},function(e,s){g(function(){t.go(t.current,{pb_id:e},{reload:!0})},1e3)}])},i.getSelectedItemsIncluding=function(e,s){return s.selected=!0,e.items.filter(function(e){return e.selected})},i.onDrop=function(n,e,s){return _.each(e,function(e){e.selected=!1;var s=_.find(n.items,{p_id:e.p_id});if(_.isEmpty(s))e.quantity=1,i.$apply(function(){i.list2.push(e)});else{var t=_.indexOf(n.items,s);e.quantity=parseInt(s.quantity)+1,i.$apply(function(){n.items.splice(t,1,e)})}}),_.each(i.list1,function(e){e.selected=!1}),n.items=n.items.slice(0,s).concat(e).concat(n.items.slice(s)),!0},i.callMyFunction=function(e,s){if("Products"==s)return e.selected=!e.selected},i.onMoved=function(e){e.items=e.items.filter(function(e){return!e.selected})},i.onDragstart=function(e,s){if(e.dragging=!0,s.dataTransfer.setDragImage)new Image},i.dropCallback=function(e,s,t){},i.deleteAllMedia=function(){o.openConfirm({templateUrl:"modules/dialog/deleteAllDialog.html",scope:i,className:"ngdialog-theme-default"}).then(function(){n.pb_id&&a.deleteAllProductBundleImage(n.pb_id).then(function(e){200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),t.reload()):r.error(e.response.msg,"Error")})})},i.deleteSelected=function(e){o.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:i,className:"ngdialog-theme-default"}).then(function(){console.log("media: ",e),n.pb_id&&a.deleteProductBundleImageFile(n.pb_id,e._id).then(function(e){200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),t.reload()):r.error(e.response.msg,"Error")})})},i.minusbutton=function(e){e.quantity<1?e.quantity=0:e.quantity--,y(e)},i.addbutton=function(e){e.quantity++,y(e)},i.refresh()}angular.module("POS17").controller("productsBundleController",e),e.$inject=["$scope","$state","$filter","toastr","$stateParams","ngDialog","productFactory","ptypeFactory","storeFactory","priceHistoryFactory","supplierFctry","tagsFactory","$uibModal","$timeout","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,t,o,r,a,n,s,i,l,u,c,p,d){var f=!(e.item={}),m=JSON.parse(c.get("user")),g=e.uploader=new o({url:r+a+"product-bundle/"+n+"/upload-image",method:"PUT",headers:{Authorization:"Bearer "+i.getUserToken(),accesskey:m.subscriptionKey}});g.filters.push({name:"imageFilter",fn:function(e,t){var o="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(o)}}),g.filters.push({name:"_isValidFile",fn:function(e,t){return!!function(e){var t=e.split(" ");if(0<t.length)return"mb"==t[1].toLowerCase()?parseFloat(t[0])<=2:"gb"!=t[1].toLowerCase()&&"tb"!=t[1].toLowerCase()&&("kb"==t[1].toLowerCase()||"bytes"==t[1].toLowerCase())}(function(e,t){if(0==e)return"0 Bytes";var o=t||2,r=Math.floor(Math.log(e)/Math.log(1e3));return parseFloat((e/Math.pow(1e3,r)).toFixed(o))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}(e.size))||(d.error("File Size Limit Exceeded","Error"),!1)}}),g.onBeforeUploadItem=function(e){e.alias="pb_image"},g.onErrorItem=function(e,t){400!=t.statusCode||t.success||(d.error(t.response.msg,"Error"),f=!0)},g.onCompleteAll=function(e){f||d.success("Media / File upload complete","Success"),p(function(){t.close(n)},1300)},e.cancel=function(){t.dismiss("cancel")}}angular.module("POS17").controller("productBundleUploaderModalCtrl",e),e.$inject=["$scope","$uibModalInstance","FileUploader","API_URL","API_VERSION","product_bundle_id","Upload","AuthFctry","jwtHelper","$stateParams","localStorageService","$timeout","toastr"]}();
!function(){"use strict";function e(o,e,t,s,a,r,c,n,l){o.categ={repeatSelect:null,availableOptions:[]},o.categories=[],o.prodBundleCategories=[],o.itemArray=[],o.selectedCategory=[],o.store={},o.applicationStatus="",o.getAllCategory=function(){async.waterfall([function(t){n.getAllCategory().then(function(e){200==e.statusCode&&e.response.success?(o.categ.availableOptions=e.response.result,o.categories=angular.copy(o.categ.availableOptions),t(null,o.categories)):console.log(e.response.msg)})},function(t,e){a.pb_id?l.getProductBundleCategory(a.pb_id).then(function(e){200==e.statusCode&&e.response.success&&0<e.response.result.length?(o.prodBundleCategories=e.response.result,_.each(o.categories,function(t){var e=_.find(o.prodBundleCategories,function(e){return t.c_id===e.fk_bundle_category_id});e&&(t.selected=!0,t.fk_bundle_category_id=e.fk_bundle_category_id,t.fk_product_bundle_id=a.pb_id,o.selectedCategory.push(t))}),o.itemArray=angular.copy(o.categories)):200==e.statusCode&&e.response.success&&0===e.response.result.length?o.itemArray=angular.copy(t):console.log(e.response.msg)}):o.itemArray=angular.copy(t)}])},o.getAllCategory(),o.paginate=function(){$("#tblCategory").trigger("footable_redraw")},o.changeSelectDeselectAll=function(){_.each(o.itemArray,function(e){e.selected=o.selectDeselectAll,o.checkStoresChanges(e)})},o.checkStoresChanges=function(t){if(t.selected){var e=_.find(o.selectedCategory,function(e){return e.c_id===t.c_id});_.isUndefined(e)&&(t.fk_bundle_category_id=t.c_id,t.fk_product_bundle_id=a.p_id,o.selectedCategory.push(t)),console.log("$scope.selectedCategory:",o.selectedCategory)}else o.selectedCategory=_.filter(o.selectedCategory,function(e){return e.c_id!==t.c_id})},o.updateStatus=function(e){""===(o.applicationStatus=e)?o.itemArray=angular.copy(o.categories):(o.itemArray.splice(0,o.itemArray.length),_.each(o.categories,function(t){_.find(o.selectedCategory,function(e){return t.c_id===e.fk_bundle_category_id})&&o.itemArray.push(t)}))},o.searchStore=function(){if(o.txtSearch){o.itemArray.splice(0,o.itemArray.length);var e=r("filter")(o.categories,o.txtSearch);o.itemArray=angular.copy(e)}},o.searchStatus=function(){""===o.txtSearch&&(o.itemArray.splice(0,o.itemArray.length),o.itemArray=angular.copy(o.categories))},o.saveproductBundleCategory=function(){var r=0;a.pb_id&&async.waterfall([function(t){l.deleteProductBundleCategory(a.pb_id).then(function(e){200==e.statusCode&&e.response.success?(console.log("Na delete"),t(null,e.response.result)):t(e.response.msg,null)})},function(e,t){o.listOfsavedCategory=[],_.each(o.selectedCategory,function(t){l.saveProductBundleCategory(a.pb_id,{category_id:t.c_id}).then(function(e){200===e.statusCode&&e.response.success?(o.listOfsavedCategory.push(t.name+" - "+e.response.msg),++r===o.selectedCategory.length&&(c.success("Successfully Mapped"),s.reload())):c.error(e.response.msg,"Error")})})}])}}angular.module("POS17").controller("productBundleCategoryCtrl",e),e.$inject=["$scope","$rootScope","$timeout","$state","$stateParams","$filter","toastr","categoryFactory","productFactory"]}();
!function(){"use strict";function e(s,l,e,o,r,c,t,n,d){s.selectDeselectAllRelation=!1,s.selectedDatas=[],s.probundles=[],s.probundlesCopy=[],s.relatedProducts=[],e.getAllProductBundle().then(function(e){200==e.statusCode&&e.response.success&&(s.probundles=e.response.result,s.probundlesCopy=angular.copy(s.probundles))}),s.getAllRelatedBundles=function(){s.relatedProducts=[],c.pb_id&&o.getAllRelatedBundle(c.pb_id).then(function(e){200==e.statusCode&&e.response.success&&(s.relatedProducts=e.response.result)})},s.getAllRelatedBundles(),s.changeSelectDeselectAllRelated=function(){_.each(s.relatedProducts,function(e){e.selected=s.selectDeselectAllRelation,s.checkRelationChanges(e)})},s.checkRelationChanges=function(t){t.selected?_.find(s.selectedDatas,function(e){return e.rel_id===t.rel_id})||s.selectedDatas.push(t):s.selectedDatas=_.filter(s.selectedDatas,function(e){return e.rel_id!==t.rel_id}),s.deleteSomeData=0<s.selectedDatas.length},s.addNewEntry=function(){t.open({animation:!0,templateUrl:"./modules/products/related.bundle.modal.html",controller:"productBundleRelatedModalCtrl",size:"lg",resolve:{products:function(){return s.probundles},product:function(){return c.pb_id}}}).result.then(function(e){l.reload()})},s.openRelationType=function(){t.open({animation:!0,templateUrl:"./modules/products/relation.type.modal.html",controller:"relationTypeCtrl",size:"lg"}).result.then(function(e){l.reload()})},s.deleteSelectedRelated=function(){s.modal={title:"Archive Bundle?",message:"Are you sure to archive this selected product bundle?"},n.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:s,className:"ngdialog-theme-default"}).then(function(){var n=1;0<s.selectedDatas.length&&async.eachSeries(s.selectedDatas,function(e,t){e.selected&&o.deleteRelatedBundle(c.pb_id,e.rel_id).then(function(e){200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),n++,t()):r.error(e.response.msg,"Error")}),n==s.selectedDatas.length&&l.reload()})})},s.deleteSelected=function(e){s.modal={title:"Delete Product Relation?",message:"Are you sure to delete this selected product relation?"},n.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:s,className:"ngdialog-theme-default"}).then(function(){o.deleteRelatedBundle(c.pb_id,e).then(function(e){200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),d(function(){l.reload()},300)):r.error(e.response.msg,"Error")})})}}function t(t,n,s,e,l,o,r,c){t.relation={},t.relationtypes=[],t.relatedProducts=[],t.infiniteScrollContacts={},t.infiniteScrollContacts.numToAdd=10,t.infiniteScrollContacts.currentItems=10,l.getAllRelationType().then(function(e){200==e.statusCode&&e.response.success?t.relationtypes=e.response.result:console.log(e.response.msg)}),_.isUndefined(r)||(t.relation={},t.selected={},t.relatedProducts=[],t.relatedProducts=o,t.relation.product_id=r),t.resetInfScroll=function(){t.infiniteScrollContacts.currentItems=t.infiniteScrollContacts.numToAdd},t.addMoreItems=function(){t.infiniteScrollContacts.currentItems+=t.infiniteScrollContacts.numToAdd},t.saveEntry=function(){t.relation.ref_id=t.relation.bundle.pb_id,_.isUndefined(t.relation.ref_id)?s.warning("Unable to saved related bundles. Please provide Bundle and Relation Type","Warning"):l.saveRelatedBundle(r,t.relation).then(function(e){if(200==e.statusCode&&e.response.success)s.success(e.response.msg,"Success"),c(function(){n.close()},600);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void s.error(e.response.msg,"Error");_.each(e.response.result,function(e){s.warning(e.msg,"Warning")})}})},t.cancel=function(){n.dismiss("cancel")}}angular.module("POS17").controller("productBundleRelatedCtrl",e).controller("productBundleRelatedModalCtrl",t),e.$inject=["$scope","$state","productFactory","relatedProductFactory","toastr","$stateParams","$uibModal","ngDialog","$timeout"],t.$inject=["$scope","$uibModalInstance","toastr","productFactory","relatedProductFactory","products","product","$timeout"]}();
!function(){"use strict";function e(n,s,e,i,t,l,o,r,u,a,c,d){n.attributes=[],n.attribute_values=[],n.$watch(function(){return n.details},function(e){n.getAllProductAttributes()}),n.getAllProductAttributes=function(){n.details.doc=d.get("visibility"),async.waterfall([function(t){r.getProductDetails(l.p_id).then(function(e){200==e.statusCode&&e.response.success&&e.response.result.productType_id&&t(null,e.response.result.productType_id)})},function(e,s){a.getAttributeMapping(e).then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;s(null,t)}else console.log(e.response.msg)})},function(s,i){console.log("2"),r.getProductBundleAttributes(l.pb_id).then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;i(null,s,t)}else console.log(e.response.msg)})},function(s,i,o){console.log("3"),c.getAllCategory().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;o(null,s,i,t)}else console.log(e.response.msg)})},function(t,o,u,n){console.log("4"),r.getProductBundleCategory(l.pb_id).then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result,i=[];_.each(u,function(t){_.find(s,function(e){return t.c_id===e.fk_category_id})&&i.push(t)}),n(null,t,o,i)}else console.log(e.response.msg)})},function(e,i,s,t){console.log("5");var o=[];if(_.each(e,function(e){var t=_.filter(s,{c_id:e.fk_c_id});t&&0<t.length&&o.push(e)}),o&&0<o.length){var u=_.map(o,function(e){return e.attributes});_.each(u,function(e){var t=_.find(i.attribute_values,{att_id:e.att_id}),s=_.find(i.attribute_value_list,{att_id:e.att_id});t?(e.unique_id=t._id,e.value=t.value):(e.value=null,e.unique_id=null),e.attribute_list_value=s?s.attribute_list:[]}),n.attributes=u}else{u=_.map(e,function(e){return e.attributes});_.each(u,function(e){var t=_.find(i.attribute_values,{att_id:e.att_id}),s=_.find(i.attribute_value_list,{att_id:e.att_id});t?(e.unique_id=t._id,e.value=t.value):(e.value=null,e.unique_id=null),e.attribute_list_value=s?s.attribute_list:[]}),n.attributes=u}console.log("$scope.attributes11:",n.attributes),_.each(n.attributes,function(e){"Checkbox"==e.attribute_type&&("1"==e.value?e.checked=!0:e.checked=!1)})}])},n.deleteAttributeValue=function(e){console.log("attribute: ",e),_.isUndefined(e.value)?i.warning("Unable to save no attribute value","Warning"):o.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){console.log("Delete"),u.deleteAttributeValues(e.att_id,e.unique_id).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),s.reload()):i.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},n.saveShow=function(){if(n.details.doc){var e={product_id:l.p_id,is_show:1};d.set("visibility",!0),u.updateAttributeVisibility(e).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),s.reload()):i.error(e.response.msg,"Error")})}else{var t={product_id:l.p_id,is_show:0};d.set("visibility",!1),u.updateAttributeVisibility(t).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),s.reload()):i.error(e.response.msg,"Error")})}},n.saveAttributeValue=function(e){if(console.log("attribute: ",e),n.modal={title:"Confirm attribute",message:"Are you sure to save attribute?"},"Checkbox"==e.attribute_type){console.log("diri:",e.checked);var t={product_id:null,bundle_id:l.pb_id,attribute_id:e.att_id,article_id:null,value:e.checked,value_image:null,name:e.name,description:"",is_single:0,is_image:0,is_video:0,is_audio:0}}else{console.log("diri:");t={product_id:null,bundle_id:l.pb_id,attribute_id:e.att_id,article_id:null,value:e.value,value_image:null,name:e.name,description:"",is_single:0,is_image:0,is_video:0,is_audio:0}}_.isUndefined(e.value)?i.warning("Unable to save no attribute value","Warning"):o.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){_.isNull(e.unique_id)?(console.log("Save New"),console.log("value1s",t),u.saveAttributeValues(e.att_id,t).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),s.reload()):i.error(e.response.msg,"Error")})):(console.log("Updated"),console.log("values",t),u.updateAttributeValues(e.att_id,e.unique_id,t).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),s.reload()):i.error(e.response.msg,"Error")}))},function(e){console.log("Modal promise close: ")})}}angular.module("POS17").controller("productBundleAttributesCtrl",e),e.$inject=["$scope","$state","$filter","toastr","$timeout","$stateParams","ngDialog","productFactory","attributeFactory","ptypeFactory","categoryFactory","localStorageService"]}();
!function(){"use strict";function t(e,t,i,n,a){e.paginateNumber=0,e.pagination={currentPage:1,limitWithPage:10,totalPages:0,sumOfPages:0},e.auditlogs=[],e.generateActivityLogs=function(t){n.getProductBundleAuditLog(t,{startWith:e.paginateNumber,limit:e.pagination.limitWithPage}).then(function(t){200==t.statusCode&&t.response.success&&(e.auditlogs=t.response.result,e.pagination.totalPages=t.response.pagination.results,e.pagination.sumOfPages=t.response.pagination.pages)})},a&&e.generateActivityLogs(a),e.addMoreItems=function(){e.paginateNumber=e.pagination.currentPage-1,a&&e.generateActivityLogs(a)},e.filterDate=function(){},e.cancel=function(){i.dismiss("cancel")}}angular.module("POS17").controller("productBundleAuditLogModalCtrl",t),t.$inject=["$scope","$state","$uibModalInstance","productFactory","pb_id"]}();
!function(){"use strict";function t(l,t,e){l.currentDate=Date.now(),l.bundles=[],l.IsExport=!1,t.getAllProductBundle().then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;_.isEmpty(e)||(l.bundles=e)}else console.log(t.response.msg)}),l.myFunction=function(){l.IsExport=!0,angular.element(document).ready(function(){e(function(){console.log("basic-table"),$("#basic-table").trigger("footable_redraw")},1e3)})},l.export=function(){var t=Date.now()+"product-bundles.pdf",o="{total_pages_count_string}",n=new jsPDF({orientation:"landscape",format:"a4"}),e=document.getElementById("basic-table"),a=n.autoTableHtmlToJson(e);n.autoTable(a.columns,a.data,{addPageContent:function(t){n.setFontSize(20),n.setTextColor(40),n.setFontStyle("normal"),n.text("Product Bundles --- Date: "+moment(l.currentDate).format("MM/DD/YYYY hh:mm a"),t.settings.margin.left,15);var e="Page "+t.pageCount;"function"==typeof n.putTotalPages&&(e=e+" of "+o),n.setFontSize(10),n.text(e,t.settings.margin.left,n.internal.pageSize.height-10)},startY:20,margin:{top:30},styles:{overflow:"linebreak",columnWidth:"wrap"},columnStyles:{0:{columnWidth:100},1:{columnWidth:40},2:{columnWidth:40},3:{columnWidth:40},4:{columnWidth:30},5:{columnWidth:20}}}),"function"==typeof n.putTotalPages&&n.putTotalPages(o),n.save(t)}}angular.module("POS17").controller("productBundlesExportsController",t),t.$inject=["$scope","productFactory","$timeout"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(a,t){t.state("main.analytics-overview",{url:"/analytics/overview",templateUrl:"modules/analytics/chartjs.html"}).state("main.analytics-appoverview",{url:"/analytics/appoverview",templateUrl:"modules/analytics/inline.html"}).state("main.analytics-behavior",{url:"/analytics/behavior",templateUrl:"modules/analytics/flot.html"}).state("main.analytics-audience",{url:"/analytics/audience",templateUrl:"modules/analytics/morris.html"})}])}();
!function(){"use strict";function t(e,t,o){e.$log=t,e.data=[],e.myChartOptions={grid:{borderColor:"#f3f3f3",borderWidth:1,tickColor:"#f3f3f3"},series:{shadowSize:0,color:"#3c8dbc"},lines:{fill:!0,color:"#3c8dbc"},yaxis:{min:0,max:100,show:!0},xaxis:{show:!0}},e.totalPoints=100,e.updateInterval=500,e.realtime=1,e.getRandomData=function(){for(0<e.data.length&&(e.data=e.data.slice(1));e.data.length<e.totalPoints;){var t=(0<e.data.length?e.data[e.data.length-1]:50)+10*Math.random()-5;t<0?t=0:100<t&&(t=100),e.data.push(t)}for(var o=[],a=0;a<e.data.length;++a)o.push([a,e.data[a]]);return o},e.update=function(){e.data=[e.getRandomData()],1==e.realtime&&setTimeout(e.update,e.updateInterval)}}function o(t){for(var o=[],a=[],e=0;e<14;e+=.5)o.push([e,Math.sin(e)]),a.push([e,Math.cos(e)]);var r={data:o,color:"#3c8dbc"},i={data:a,color:"#00c0ef"};t.myData=[r,i],t.myChartOptions={grid:{hoverable:!0,borderColor:"#f3f3f3",borderWidth:1,tickColor:"#f3f3f3"},series:{shadowSize:0,lines:{show:!0},points:{show:!0}},lines:{fill:!1,color:["#3c8dbc","#f56954"]},yaxis:{show:!0},xaxis:{show:!0}}}function a(t){t.myData=[[[2,88],[3,93.3],[4,102],[5,108.5],[6,115.7],[7,115.6],[8,124.6],[9,130.3],[10,134.3],[11,141.4],[12,146.5],[13,151.7],[14,159.9],[15,165.4],[16,167.8],[17,168.7],[18,169.5],[19,168]]],t.myChartOptions={grid:{borderWidth:0},series:{shadowSize:0,color:"#00c0ef"},lines:{fill:!0},yaxis:{show:!1},xaxis:{show:!1}}}function e(t){t.myData=[{data:[["January",10],["February",8],["March",4],["April",13],["May",17],["June",9]],color:"#3c8dbc"}],t.myChartOptions={grid:{borderWidth:1,borderColor:"#f3f3f3",tickColor:"#f3f3f3"},series:{bars:{show:!0,barWidth:.5,align:"center"}},xaxis:{mode:"categories",tickLength:0}}}function r(t){t.myData=[{label:"Series2",data:30,color:"#3c8dbc"},{label:"Series3",data:20,color:"#0073b7"},{label:"Series4",data:50,color:"#00c0ef"}],t.myChartOptions={series:{pie:{show:!0,radius:1,innerRadius:.5,label:{show:!0,radius:2/3,formatter:function(t,o){return"<div style='font-size:13px; text-align:center; padding:2px; color: #fff; font-weight: 600;'>"+t+"<br/>"+Math.round(o.percent)+"%</div>"},threshold:.1}}},legend:{show:!1}}}angular.module("POS17").controller("FlotInteractive",t).controller("FlotLineChart",o).controller("FlotAreaChart",a).controller("FlotBarChart",e).controller("FlotDonutChart",r),t.$inject=["$scope","$log","$element"],o.$inject=["$scope"],a.$inject=["$scope"],e.$inject=["$scope"],r.$inject=["$scope"]}();
!function(){"use strict";function e(e,o){e.labels=["January","February","March","April","May","June","July"],e.series=["Series A","Series B"],e.data=[[65,59,80,81,56,55,40],[28,48,40,19,86,27,90]],e.onClick=function(e,o){console.log(e,o)},e.onHover=function(e){0<e.length?console.log("Point",e[0].value):console.log("No point")},o(function(){e.labels=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],e.data=[[28,48,40,19,86,27,90],[65,59,80,81,56,55,40]],e.series=["Series C","Series D"]},3e3)}function o(e,o){e.options={scaleShowVerticalLines:!1},e.labels=["2006","2007","2008","2009","2010","2011","2012"],e.series=["Series A","Series B"],e.data=[[65,59,80,81,56,55,40],[28,48,40,19,86,27,90]],o(function(){e.options={scaleShowVerticalLines:!0}},3e3)}function l(e,o){e.labels=["Download Sales","In-Store Sales","Mail-Order Sales"],e.data=[0,0,0],o(function(){e.data=[350,450,100]},500)}function a(e){e.labels=["Download Sales","In-Store Sales","Mail Sales"],e.data=[300,500,100]}function n(e){e.labels=["Download Sales","In-Store Sales","Mail Sales","Telesales","Corporate Sales"],e.data=[300,500,100,40,120]}angular.module("POS17").controller("LineCtrl",e).controller("BarCtrl",o).controller("DoughnutCtrl",l).controller("PieCtrl",a).controller("PolarAreaCtrl",n),e.$inject=["$scope","$timeout"],o.$inject=["$scope","$timeout"],l.$inject=["$scope","$timeout"],a.$inject=["$scope"],n.$inject=["$scope"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(l,m){m.state("main.mailbox",{url:"/mailbox/overview",templateUrl:"modules/mailbox/mailbox.html"}).state("main.mailbox-compose",{url:"/mailbox/compose",templateUrl:"modules/mailbox/compose.html"}).state("main.mailbox-read",{url:"/mailbox/read",templateUrl:"modules/mailbox/read-mail.html"})}])}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,e){e.state("main.settings-stores",{url:"/settings/stores",templateUrl:"modules/stores/stores.html",controller:"storesController"}).state("main.export-stores",{url:"/settings/stores/exports",templateUrl:"modules/stores/stores.export-pdf.html",controller:"storeExportsController"}).state("main.settings-stores-add",{url:"/settings/stores/:store_id",templateUrl:"modules/stores/store.detail.html",controller:"storesDetailController"})}])}();
!function(){"use strict";function e(r,e,a,o,n,t,l,i,s,c,d,u,f,g){r.selectDeselectAll=!1,r.selectedDatas=[],r.txtSearch={text:""},r.reportFields={store_id:"ID",name:"Name",owner_name:"Owner",telno:"Telephone No.",email_address:"Email Address",address:"Address",tin:"TIN",isVat:"Vatable",is_deleted:"Deleted",logo:"Logo",date_created:"Date Created",_id:"UUID"};var p=JSON.parse(c.get("user"));d.logTransaction("View Store List","STORES","ALL","User:="+p.username+" View all list of Stores");var m=function(){r.storeisLoading=!0,r.stores=[],r.storescopy=[],r.storeTable=new s({page:1,count:10,filter:r.txtSearch},{counts:[10,25,50,100],getData:function(o,n){l.getAllStore().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;r.storescopy=angular.copy(r.stores),n.filter().text?r.stores=a("filter")(t,n.filter().text):r.stores=t,r.selectedDatas&&0<r.selectedDatas.length&&_.each(r.stores,function(t){_.find(r.selectedDatas,function(e){return e.store_id===t.store_id})&&(t.selected=!0)}),n.total(r.stores.length);var s=r.stores.slice((n.page()-1)*n.count(),n.page()*n.count());o.resolve(s),r.storeisLoading=!1}else r.storeisLoading=!1,console.log(e.response.msg)})}})};r.edit=function(e){o.go("main.settings-stores-add",{store_id:e})},r.searchData=function(){r.storeTable.reload()},r.changeSelectDeselectAll=function(){r.selectDeselectAll=!r.selectDeselectAll,_.each(r.stores,function(e){e.selected=r.selectDeselectAll,r.deleteSomeData=r.selectDeselectAll,r.checkDataChanges(e)})},r.refresh=function(){r.storeTable.reload()},r.checkDataChanges=function(t){t.selected?_.find(r.selectedDatas,function(e){return e.store_id===t.store_id})||r.selectedDatas.push(t):r.selectedDatas=_.filter(r.selectedDatas,function(e){return e.store_id!==t.store_id}),r.deleteSomeData=0<r.selectedDatas.length},r.toggleModal=function(e){t.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){l.deleteStore(e).then(function(e){200==e.statusCode&&e.response.success?(n.success(e.response.msg,"Success"),o.reload()):n.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},r.onDrop=function(e,t,s){return angular.forEach(t,function(e){e.selected=!1}),e.items=e.items.slice(0,s).concat(t).concat(e.items.slice(s)),!0},r.onMoved=function(e){e=e.items.filter(function(e){return!e.selected})},r.deleteSelected=function(){t.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){var s=0;async.each(r.selectedDatas,function(e,t){e.selected&&l.deleteStore(e.store_id).then(function(e){if(e&&e.response&&e.response.result&&e.response.result.warning_msg)n.warning(e.response.result.warning_msg,"Warning"),r.refresh();else{if(200!=e.statusCode||!e.response.success)return void n.error(e.response.msg,"Error");n.success(e.response.msg,"Success"),++s==r.selectedDatas.length&&o.reload(),t()}})})})},r.importStores=function(e){if("csv"==e){var s=u.open({animation:!0,backdrop:"static",size:"sm",templateUrl:"modules/dialog/importStore.modal.html",scope:r});s.result.then(function(){},function(){}),r.uploadStores=function(){angular.forEach(r.files,function(t){t.upload=f.upload({url:g.configuration.baseUrl+"/store/import",data:{file:t}}),t.upload.then(function(e){i(function(){t.result=e.data,200==e.status?(n.success(e.data.response.msg,"Success"),r.files=[],r.progressState=0,s.dismiss("close")):500==e.status?(r.files=[],r.progressState=0,n.error(e.data.response.msg,"Error")):(r.files=[],r.progressState=0,n.warning(e.data.response.msg,"Error")),m()})},function(e){0<e.status&&(r.errorMsg=e.status+": "+e.data)},function(e){t.progress=Math.min(100,parseInt(100*e.loaded/e.total)),r.progressState=Math.min(100,parseInt(100*e.loaded/e.total))})})},r.cancel=function(){s.dismiss("close"),r.files=[],r.progressState=0}}},r.setUploadFile=function(e,t,s,o){console.log("files ",e),"csv"==e[0].name.split(".")[e[0].name.split(".").length-1]?(r.files=e,r.errFiles=t,r.param=s,r.classification=o):(n.warning("Format of the choosen File is invalid, please choose CSV file","Warning"),r.files=[])},r.init=function(){m()},r.init()}angular.module("POS17").controller("storesController",e),e.$inject=["$scope","$http","$filter","$state","toastr","ngDialog","storeFactory","$timeout","ngTableParams","localStorageService","transLogFctry","$uibModal","Upload","Restangular"]}();
!function(){"use strict";function e(r,e,s,t,n,o,a,i,l,d,c,m,u,g,p,h,f){console.log("storesDetailController.."),r.details={},r.details.tags=[],r.tagsArr=[],r.storetype=[],r.countries=[],r.store_images=[],r.stores={},r.stores.schedule={},r.store_day="",r.listOfSchedules=[],r.stores.days=[{_id:2,label:"Monday",time_end:moment(new Date,["hh:mm:ss"]).format("h:mm A"),time_start:moment(new Date,["hh:mm:ss"]).format("h:mm A")},{_id:3,label:"Tuesday",time_end:moment(new Date,["hh:mm:ss"]).format("h:mm A"),time_start:moment(new Date,["hh:mm:ss"]).format("h:mm A")},{_id:4,label:"Wednesday",time_end:moment(new Date,["hh:mm:ss"]).format("h:mm A"),time_start:moment(new Date,["hh:mm:ss"]).format("h:mm A")},{_id:5,label:"Thursday",time_end:moment(new Date,["hh:mm:ss"]).format("h:mm A"),time_start:moment(new Date,["hh:mm:ss"]).format("h:mm A")},{_id:6,label:"Friday",time_end:moment(new Date,["hh:mm:ss"]).format("h:mm A"),time_start:moment(new Date,["hh:mm:ss"]).format("h:mm A")},{_id:7,label:"Saturday",time_end:moment(new Date,["hh:mm:ss"]).format("h:mm A"),time_start:moment(new Date,["hh:mm:ss"]).format("h:mm A")},{_id:8,label:"Sunday",time_end:moment(new Date,["hh:mm:ss"]).format("h:mm A"),time_start:moment(new Date,["hh:mm:ss"]).format("h:mm A")},{_id:1,label:"Everyday",time_end:moment(new Date,["hh:mm:ss"]).format("h:mm A"),time_start:moment(new Date,["hh:mm:ss"]).format("h:mm A")}],r.map={},r.map.mapControl={},r.map.zoom=10,r.map.icon="../images/mappin32.png";var y=JSON.parse(d.get("user"));if(t.store_id?c.logTransaction("View Store Details","STORES",t.store_id,"User:="+y.username+" View store details:="+t.store_id):c.logTransaction("Add New Store","STORES","N/A","User:="+y.username+" Add new store entry"),l.getAllTags().then(function(e){200==e.statusCode&&e.response.success?r.tagsArr=e.response.result:console.log(e.response.msg)}),u.getAllCountries().then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;_.isEmpty(s)||(r.countries=s)}}),t.store_id){i.getStoreDetails(t.store_id).then(function(e){200==e.statusCode&&e.response.success&&(r.details=e.response.result,_.isEmpty(r.details.geo_latitude)&&_.isEmpty(r.details.geo_longitude)?r.getgeoLocation():f.then(function(e){n(function(){r.$apply(function(){r.map.center={latitude:r.details.geo_latitude,longitude:r.details.geo_longitude},r.marker={id:0,coords:{latitude:r.details.geo_latitude,longitude:r.details.geo_longitude},options:{draggable:!0},events:{dragend:function(e,s,t){var o=e.getPosition().lat(),n=e.getPosition().lng();r.marker.options={draggable:!0,labelContent:"lat: "+r.marker.coords.latitude+" lon: "+r.marker.coords.longitude,labelAnchor:"100 0",labelClass:"marker-labels"},r.details.geo_latitude=o,r.details.geo_longitude=n}}},r.map.options={draggable:!0},r.map.events={zoom_changed:function(){var e=r.map.mapControl.getGMap().getZoom();r.map.icon=0<=e&&e<=9?"../images/mappin24.png":10<=e&&e<=15?"../images/mappin32.png":"../images/mappin64.png"}}})},100)}),l.getAllStoreTags(t.store_id).then(function(e){200==e.statusCode&&e.response.success&&(r.details.tags=e.response.result)}))}),i.getStoreImages(t.store_id).then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;_.isEmpty(s)||(r.store_images=s)}});i.getStoreSchedule(t.store_id,{table_id:1,is_active:1}).then(function(e){200==e.statusCode&&e.response.success&&e.response.result.schedule&&0<e.response.result.schedule.length&&(r.stores.schedules=e.response.result.schedule,r.schedule_id=e.response.result.schedule_id,_.each(r.stores.days,function(s){_.each(e.response.result.schedule,function(e){s._id==e._id&&(s.selected=!0)})}))})}r.getgeoLocation=function(){m.getCurrentPosition({timeout:6e4}).then(function(s){r.details.geo_latitude=s.coords.latitude,r.details.geo_longitude=s.coords.longitude,f.then(function(e){n(function(){r.$apply(function(){r.map.center={latitude:s.coords.latitude,longitude:s.coords.longitude},r.marker={id:0,coords:{latitude:s.coords.latitude,longitude:s.coords.longitude},options:{draggable:!0},events:{dragend:function(e,s,t){var o=e.getPosition().lat(),n=e.getPosition().lng();r.marker.options={draggable:!0,labelContent:"lat: "+r.marker.coords.latitude+" lon: "+r.marker.coords.longitude,labelAnchor:"100 0",labelClass:"marker-labels"},r.details.geo_latitude=o,r.details.geo_longitude=n}}},r.map.options={draggable:!0},r.map.events={zoom_changed:function(){var e=r.map.mapControl.getGMap().getZoom();r.map.icon=0<=e&&e<=9?"../images/mappin24.png":10<=e&&e<=15?"../images/mappin32.png":"../images/mappin64.png"}}})},100)})})},r.onDragEnd=function(e,s){var t=e.latLng.lat(),o=e.latLng.lng();geocoder=new s.google.maps.Geocoder,geocoder.geocode({latLng:new s.google.maps.LatLng(t,o)},function(e,s){if(s===google.maps.GeocoderStatus.OK)if(e[0]){var t=e[0].formatted_address;n(function(){r.address=t},300)}else alert("No results found");else alert("Geocoder failed due to: "+s)})},r.deleteProductTags=function(e){t.store_id&&l.deleteStoreTag(t.store_id,e.tags_id).then(function(e){200==e.statusCode&&e.response.success?a.success(e.response.msg,"Success"):a.error(e.response.msg,"Error")})},r.getDay=function(e){"Everyday"==e.label&&e.selected?_.each(r.stores.days,function(e){e.selected=!0}):"Everyday"!==e.label?_.each(r.stores.days,function(e){"Everyday"==e.label&&(e.selected=!1)}):_.each(r.stores.days,function(e){e.selected=!1}),console.log("$scope.stores:",r.stores)},r.tagTransform=function(e){return{tags:e}},r.clearInput=function(e){e.search=""},r.openUploader=function(){g.open({animation:!0,templateUrl:"./modules/stores/detail/store.upload.modal.html",controller:"storeUploaderModalCtrl",size:"lg",resolve:{store_id:function(){return t.store_id}}}).result.then(function(e){o.reload()},function(){})},r.deleteAllMedia=function(){h.openConfirm({templateUrl:"modules/dialog/deleteAllDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){t.store_id&&i.deleteAllStoreImage(t.store_id).then(function(e){e&&200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),n(function(){window.location.reload()},700)):a.error(e.response.msg,"Error")})},function(){})},r.setAsThumbNail=function(e){r.modal={title:"Set as store thumbnail",message:"Are you sure to set this image?"},h.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){t.store_id&&i.setStoreImage(t.store_id,e._id).then(function(e){200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),n(function(){window.location.reload()},700)):a.warning(e.response.msg,"Warning")})},function(){})},r.deleteSelectedMedia=function(e){h.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){t.store_id&&i.deleteStoreImage(t.store_id,e._id).then(function(e){e&&200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),n(function(){window.location.reload()},700)):a.error(e.response.msg,"Error")})})},r.openLightboxModal=function(e){var s=[];s.push({url:e.media,thumbUrl:e.media}),p.openModal(s,0)},r.saveStore=function(){r.details.storetype_id=r.details.type.selected.storetype_id,async.waterfall([function(s){t.store_id?i.updateStore(t.store_id,r.details).then(function(e){if(200==e.statusCode&&e.response.success)a.success(e.response.msg,"Success"),s(null,t.store_id);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void a.error(e.response.msg,"Error");_.each(e.response.result,function(e){a.warning(e.msg,"Warning")})}}):i.saveStore(r.details).then(function(e){if(console.log("data:",e),200==e.statusCode&&e.response.success)a.success(e.response.msg,"Success"),s(null,e.response.result);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void a.error(e.response.msg,"Error");_.each(e.response.result,function(e){a.warning(e.msg,"Warning")})}})},function(t,o){var n=1;0<r.details.tags.length?async.eachSeries(r.details.tags,function(e,s){e.isTag?l.saveTags(e).then(function(e){200==e.statusCode&&e.response.success?l.saveStoreTags(t,{tag_id:e.response.result}).then(function(e){200==e.statusCode&&e.response.success?(n++,s()):a.error(e.response.msg,"Error")}):a.error(e.response.msg,"Error")}):l.saveStoreTags(t,{tag_id:e.tags_id}).then(function(e){200==e.statusCode&&e.response.success?(n++,s()):a.error(e.response.msg,"Error")}),n>=r.details.tags.length&&o(null,t)}):o(null,t)},function(e,s){n(function(){o.go("main.settings-stores",null,{reload:!0})},300)}])},r.saveSchedule=function(){if(r.listOfSchedules=_.filter(r.stores.days,{selected:!0}),0<r.listOfSchedules.length){var e={table_id:1,recurrence_id:0,is_active:1,date_start:null,date_end:null,daysSelected:r.listOfSchedules};r.schedule_id?(console.log("UPDATE"),i.updateStoreSchedule(t.store_id,r.schedule_id,e).then(function(e){200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),o.go(o.current,null,{reload:!0})):a.error(e.response.msg,"Error")})):(console.log("SAVE"),i.savestoreSchedule(t.store_id,e).then(function(e){200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),o.go(o.current,null,{reload:!0})):a.error(e.response.msg,"Error")}))}else a.warning("Please select days","Warning")},r.getStoreTypes=function(){i.getStoreTypes().then(function(e){r.storetype=e.response.result;var s=_.find(r.storetype,{storetype_id:r.details.storetype_id}),t={selected:s||e.response.result[0]};r.details.type=t})},r.init=function(){r.getStoreTypes()},r.init()}angular.module("POS17").controller("storesDetailController",e),e.$inject=["$scope","$http","$filter","$stateParams","$timeout","$state","toastr","storeFactory","tagsFactory","localStorageService","transLogFctry","$geolocation","countryFactory","$uibModal","Lightbox","ngDialog","uiGmapGoogleMapApi"]}();
!function(){"use strict";function t(a,t,e){console.log("storeExportsController"),a.currentDate=Date.now(),a.stores=[],a.IsExport=!1,t.getAllStore().then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;_.isEmpty(e)||(a.stores=e)}else console.log(t.response.msg)}),a.myFunction=function(){a.IsExport=!0,angular.element(document).ready(function(){e(function(){console.log("basic-table"),$("#basic-table").trigger("footable_redraw")},1e3)})},a.export=function(){var t=Date.now()+"stores.pdf",o="{total_pages_count_string}",n=new jsPDF({orientation:"landscape",format:"a4"}),e=document.getElementById("basic-table"),s=n.autoTableHtmlToJson(e);n.autoTable(s.columns,s.data,{addPageContent:function(t){n.setFontSize(20),n.setTextColor(40),n.setFontStyle("normal"),n.text("Stores --- Date: "+moment(a.currentDate).format("MM/DD/YYYY hh:mm a"),t.settings.margin.left,15);var e="Page "+t.pageCount;"function"==typeof n.putTotalPages&&(e=e+" of "+o),n.setFontSize(10),n.text(e,t.settings.margin.left,n.internal.pageSize.height-5)},startY:20,margin:{top:30},styles:{overflow:"linebreak",columnWidth:"wrap"},columnStyles:{0:{columnWidth:50},1:{columnWidth:80},2:{columnWidth:40},3:{columnWidth:30},4:{columnWidth:30},5:{columnWidth:40}}}),"function"==typeof n.putTotalPages&&n.putTotalPages(o),n.save(t)}}angular.module("POS17").controller("storeExportsController",t),t.$inject=["$scope","storeFactory","$timeout"]}();
!function(){"use strict";function e(e,o,t,r,s,n,a,i,l,c,u){var p=!(e.item={}),d=JSON.parse(l.get("user")),f=e.uploader=new t({url:r+s+"store/"+n+"/upload-image",method:"PUT",headers:{Authorization:"Bearer "+i.getUserToken(),accesskey:d.subscriptionKey}});console.log("uploader:",f),f.filters.push({name:"imageFilter",fn:function(e,o){var t="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(t)}}),f.filters.push({name:"_isValidFile",fn:function(e,o){return!!function(e){var o=e.split(" ");if(0<o.length)return"mb"==o[1].toLowerCase()?!(parseInt(o[0])<=2):"gb"!=o[1].toLowerCase()&&"tb"!=o[1].toLowerCase()&&("kb"==o[1].toLowerCase()||"bytes"==o[1].toLowerCase())}(function(e){if(0==e)return"0 Byte";var o=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,o),2)+" "+["Bytes","KB","MB","GB","TB"][o]}(e.size))||(u.error("File Size Limit Exceeded","Error"),!1)}}),f.onBeforeUploadItem=function(e){e.alias="stores_img"},f.onErrorItem=function(e,o){400!=o.statusCode||o.success||(u.error(o.response.msg,"Error"),p=!0)},f.onCompleteAll=function(e){p||u.success("Media / File upload complete","Success"),c(function(){o.close(n)},1300)},e.cancel=function(){o.dismiss("cancel")}}angular.module("POS17").controller("storeUploaderModalCtrl",e),e.$inject=["$scope","$uibModalInstance","FileUploader","API_URL","API_VERSION","store_id","Upload","AuthFctry","localStorageService","$timeout","toastr"]}();
!function(){"use strict";function e(n,e,l,s,t,c,i,o,a,r,d){console.log("deviceController.."),n.selectDeselectAll=!1,n.selectedDatas=[];n.toggleModal=function(e,s){c.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){i.deleteassignDevice(e.dm_id).then(function(e){200==e.statusCode&&e.response.success?(n.deviceTable.reload(),t.success(e.response.msg,"Success")):t.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},n.deleteSelected=function(){c.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){n.params=[],n.selectedDatas.forEach(function(e){n.params.push(e)}),i.Reassigndevice(n.params).then(function(e){200==e.statusCode&&e.response.success?(n.deviceTable.reload(),t.success(e.response.msg,"Success")):t.error(e.response.msg,"Error")})})},n.changeSelectDeselectAll=function(){n.selectDeselectAll=!n.selectDeselectAll,_.each(n.devices,function(e){e.selected=n.selectDeselectAll,n.deleteSomeData=n.selectDeselectAll,n.checkDataChanges(e)})},n.refresh=function(){n.deviceTable.reload()},n.checkDataChanges=function(s){s.selected?_.find(n.selectedDatas,function(e){return e.device_id===s.device_id})||n.selectedDatas.push(s):n.selectedDatas=_.filter(n.selectedDatas,function(e){return e.device_id!==s.device_id}),n.deleteSomeData=0<n.selectedDatas.length},n.addNewEntry=function(){d.open({animation:!0,templateUrl:"./modules/stores/detail/device.modal.html",controller:"deviceModalController",size:"lg",resolve:{store:function(){return r.store_id}}}).result.then(function(e){n.deviceTable.reload()},function(){})},n.init=function(){n.deviceisLoading=!0,n.devices=[],n.devicescopy=[],n.deviceTable=new a({page:1,count:10},{counts:[10,25,50,100],getData:function(c,o){i.getDeviceSelected(r.store_id).then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;if(n.devicescopy=angular.copy(n.devices),n.txtSearch){n.devices=l("filter")(s,n.txtSearch),o.total(n.devices.length);var t=n.devices.slice((o.page()-1)*o.count(),o.page()*o.count());c.resolve(t)}else n.devices=s,o.total(n.devices.length),t=n.devices.slice((o.page()-1)*o.count(),o.page()*o.count()),c.resolve(t);n.deviceisLoading=!1}else n.deviceisLoading=!1,console.log("device not found")})}})},n.init()}function s(s,e,t,c,o,n){s.device={},e.getUnSelectedDevice(t).then(function(e){200==e.statusCode&&e.response.success&&(s.devices=e.response.result)}),s.saveEntry=function(){_.isUndefined(s.device.store.device_id)?o.warning("Unable to saved device. Please select device before we proceed.","Warning"):e.assignDevice(t,s.device.store).then(function(e){if(200==e.statusCode&&e.response.success)n(function(){c.close()},600),o.success(e.response.msg,"Success");else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void o.error(e.response.msg,"Error");_.each(e.response.result,function(e){o.warning(e.msg,"Warning")})}})},s.cancel=function(){c.dismiss("cancel")}}angular.module("POS17").controller("deviceController",e).controller("deviceModalController",s),e.$inject=["$scope","$http","$filter","$state","toastr","ngDialog","deviceFactory","$timeout","ngTableParams","$stateParams","$uibModal"],s.$inject=["$scope","deviceFactory","store","$uibModalInstance","toastr","$timeout"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,n){n.state("main.settings-banks",{url:"/settings/banks",templateUrl:"modules/banks/banks.html",controller:"banksController"}).state("main.export-banks",{url:"/settings/banks/exports",templateUrl:"modules/banks/banks.export-pdf.html",controller:"banksExportsController"}).state("main.settings-banks-add",{url:"/settings/banks/:bk_id",templateUrl:"modules/banks/bank.detail.html",controller:"bankDetailsController"})}])}();
!function(){"use strict";function e(l,e,o,a,t,n,c,s,r,d,i){l.selectDeselectAll=!1,l.selectedDatas=[],l.txtSearch={text:""},l.reportFields={bk_id:"ID",name:"Name",address:"Address",date_created:"Date Created",_id:"UUID"};var u=JSON.parse(d.get("user"));i.logTransaction("View Banks","BANKS","ALL","User:="+u.username+" View all list of banks");l.refresh=function(){l.bankTable.reload()},l.edit=function(e){a.go("main.settings-banks-add",{bk_id:e})},l.searchData=function(){l.bankTable.reload()},l.paginate=function(){$(".table").trigger("footable_redraw")},l.changeSelectDeselectAll=function(){l.selectDeselectAll=!l.selectDeselectAll,_.each(l.banks,function(e){e.selected=l.selectDeselectAll,l.deleteSomeData=l.selectDeselectAll,l.checkDataChanges(e)})},l.checkDataChanges=function(t){t.selected?_.find(l.selectedDatas,function(e){return e.bk_id===t.bk_id})||l.selectedDatas.push(t):l.selectedDatas=_.filter(l.selectedDatas,function(e){return e.bk_id!==t.bk_id}),l.deleteSomeData=0<l.selectedDatas.length},l.deleteSelected=function(){t.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:l,className:"ngdialog-theme-default"}).then(function(){var s=0;async.each(l.selectedDatas,function(e,t){e.selected&&(console.log("bank: ",e),c.deleteBank(e.bk_id).then(function(e){console.log("data: ",e.response),200==e.statusCode&&e.response.success?(n.success(e.response.msg,"Success"),++s==l.selectedDatas.length&&a.reload(),t()):n.error(e.response.msg,"Error")}))})})},l.toggleModal=function(e){e.selected=!0,l.selectedDatas.push(e),l.deleteSelected()},l.bankisLoading=!0,l.banks={},l.bankscopy=[],l.bankTable=new r({page:1,count:10,filter:l.txtSearch},{counts:[10,25,50,100],getData:function(a,n){c.getAllBanks().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;l.bankscopy=angular.copy(l.banks),n.filter().text?l.banks=o("filter")(t,n.filter().text):l.banks=t,l.selectedDatas&&0<l.selectedDatas.length&&_.each(l.banks,function(t){_.find(l.selectedDatas,function(e){return e.bk_id===t.bk_id})&&(t.selected=!0)}),n.total(l.banks.length);var s=l.banks.slice((n.page()-1)*n.count(),n.page()*n.count());a.resolve(s),l.bankisLoading=!1}else l.bankisLoading=!1,console.log(e.response.msg)})}}),l.toggleModal=function(e){t.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:l,className:"ngdialog-theme-default"}).then(function(){c.deleteBank(e).then(function(e){200==e.statusCode&&e.response.success?(n.success(e.response.msg,"Success"),a.reload()):n.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})}}angular.module("POS17").controller("banksController",e),e.$inject=["$scope","$http","$filter","$state","ngDialog","toastr","bankFctry","$timeout","ngTableParams","localStorageService","transLogFctry"]}();
!function(){"use strict";function t(s,t,e){console.log("banksExportsController"),s.currentDate=Date.now(),s.banks=[],s.IsExport=!1,t.getAllBanks().then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;_.isEmpty(e)||(s.banks=e)}else console.log(t.response.msg)}),s.myFunction=function(){s.IsExport=!0,angular.element(document).ready(function(){e(function(){console.log("basic-table"),$("#basic-table").trigger("footable_redraw")},1e3)})},s.export=function(){var t=Date.now()+"banks.pdf",n="{total_pages_count_string}",o=new jsPDF({orientation:"landscape",format:"a4"}),e=document.getElementById("basic-table"),a=o.autoTableHtmlToJson(e);o.autoTable(a.columns,a.data,{addPageContent:function(t){o.setFontSize(20),o.setTextColor(40),o.setFontStyle("normal"),o.text("Banks --- Date: "+moment(s.currentDate).format("MM/DD/YYYY hh:mm a"),t.settings.margin.left,15);var e="Page "+t.pageCount;"function"==typeof o.putTotalPages&&(e=e+" of "+n),o.setFontSize(10),o.text(e,t.settings.margin.left,o.internal.pageSize.height-5)},startY:20,margin:{top:30},styles:{overflow:"linebreak",columnWidth:"wrap"},columnStyles:{0:{columnWidth:100},1:{columnWidth:140},2:{columnWidth:30}}}),"function"==typeof o.putTotalPages&&o.putTotalPages(n),o.save(t)}}angular.module("POS17").controller("banksExportsController",t),t.$inject=["$scope","bankFctry","$timeout"]}();
!function(){"use strict";function s(a,s,n,t,r,o,c,u,e,i){a.details={},a.details.tags=[],a._bankExist=!1,a.tagsArr=[];var l=JSON.parse(e.get("user"));n.bk_id?i.logTransaction("View Bank Details","BANKS",n.bk_id,"User:="+l.username+" View bank details:="+n.bk_id):i.logTransaction("Add New Bank","BANKS","N/A","User:="+l.username+" Add new bank entry"),u.getAllTags().then(function(s){200==s.statusCode&&s.response.success?a.tagsArr=s.response.result:console.log(s.response.msg)}),n.bk_id&&c.getBankDetails(n.bk_id).then(function(s){200==s.statusCode&&s.response.success&&(a.details=s.response.result,u.getAllBankTags(n.bk_id).then(function(s){200==s.statusCode&&s.response.success&&(a.details.tags=s.response.result)}))}),a.saveBank=function(){async.waterfall([function(e){n.bk_id?c.updateBank(n.bk_id,a.details).then(function(s){if(200!=s.statusCode||!s.response.success)return 400===s.statusCode&&!s.response.success&&_.isArray(s.response.result)?void _.each(s.response.result,function(s){o.warning(s.msg,"Warning")}):void o.error(s.response.msg,"Error");o.success(s.response.msg,"Success"),e(null,n.bk_id)}):c.saveBank(a.details).then(function(s){if(200!=s.statusCode||!s.response.success)return 400===s.statusCode&&!s.response.success&&_.isArray(s.response.result)?void _.each(s.response.result,function(s){o.warning(s.msg,"Warning")}):void o.error(s.response.msg,"Error");o.success(s.response.msg,"Success"),e(null,s.response.result)})},function(n,t){var r=0;async.eachSeries(a.details.tags,function(s,e){s.isTag?u.saveTags(s).then(function(s){200==s.statusCode&&s.response.success?u.saveBankTags(n,{tag_id:s.response.result}).then(function(s){200==s.statusCode&&s.response.success?(r++,e()):o.error(s.response.msg,"Error")}):o.error(s.response.msg,"Error")}):u.saveBankTags(n,{tag_id:s.tags_id}).then(function(s){200==s.statusCode&&s.response.success?(r++,e()):o.error(s.response.msg,"Error")}),r>=a.details.tags.length&&t(null,n)})},function(s,e){r(function(){t.go(t.current,{bk_id:s},{reload:!0})},300)}])},a.deleteProductTags=function(s){n.bk_id&&u.deleteBankTag(n.bk_id,s.tags_id).then(function(s){200==s.statusCode&&s.response.success?o.success(s.response.msg,"Success"):o.error(s.response.msg,"Error")})},a.tagTransform=function(s){return{tags:s}},a.clearInput=function(s){s.search=""},a.checkIfBankExist=function(){a.details.name&&c.getAllBanks().then(function(s){var e=_.some(s.response.result,function(s){return s.name.toLowerCase()===a.details.name.toLowerCase()});a._bankExist=!!e})}}angular.module("POS17").controller("bankDetailsController",s),s.$inject=["$scope","$http","$stateParams","$state","$timeout","toastr","bankFctry","tagsFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,e){e.state("main.settings-attributes",{url:"/settings/attributes",templateUrl:"modules/attributes/attributes.html",controller:"attributesController"}).state("main.settings-attributes-groups",{url:"/settings/attributegroups",templateUrl:"modules/attributes/attributes.groups.html",controller:"attributeGroups"}).state("main.settings-attributes-types",{url:"/settings/attributetypes",templateUrl:"modules/attributes/attributes.types.html",controller:"attributeTypes"}).state("main.settings-attributes-add",{url:"/settings/attributes/:att_id",templateUrl:"modules/attributes/attribute.detail.html",controller:"attributeDetailsController"})}])}();
!function(){"use strict";function e(n,e,o,a,t,l,r,s,c){n.selectDeselectAll=!1,n.selectedDatas=[],n.txtSearch={text:""};n.refresh=function(){n.attributeTable.reload()},n.edit=function(e){a.go("main.settings-attributes-add",{att_id:e})},n.searchData=function(){n.attributeTable.reload()},n.paginate=function(){$(".table").trigger("footable_redraw")},n.changeSelectDeselectAll=function(){n.selectDeselectAll=!n.selectDeselectAll,_.each(n.attribute,function(e){e.selected=n.selectDeselectAll,n.deleteSomeData=n.selectDeselectAll,n.checkDataChanges(e)})},n.checkDataChanges=function(t){t.selected?_.find(n.selectedDatas,function(e){return e.att_id===t.att_id})||n.selectedDatas.push(t):n.selectedDatas=_.filter(n.selectedDatas,function(e){return e.att_id!==t.att_id}),n.deleteSomeData=0<n.selectedDatas.length},n.toggleModal=function(e){t.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){r.deleteAttribute(e).then(function(e){200==e.statusCode&&e.response.success?(l.success(e.response.msg,"Success"),a.reload()):l.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},n.deleteSelected=function(){t.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){var s=0;async.each(n.selectedDatas,function(e,t){e.selected&&r.deleteAttribute(e.att_id).then(function(e){if(e.response.result.warning_msg)l.warning(e.response.result.warning_msg,"Warning");else{if(200!=e.statusCode||!e.response.success)return void l.error(e.response.msg,"Error");l.success(e.response.msg,"Success"),++s==n.selectedDatas.length&&a.reload(),t()}})})})},n.attribisLoading=!0,n.attribute=[],n.attributecopy=[],n.attributeTable=new c({page:1,count:25,filter:n.txtSearch},{counts:[25,50,75,100],getData:function(a,l){r.getAllAttribute().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;n.attributecopy=angular.copy(n.attribute),l.filter().text?n.attribute=o("filter")(t,l.filter().text):n.attribute=t,n.selectedDatas&&0<n.selectedDatas.length&&_.each(n.attribute,function(t){_.find(n.selectedDatas,function(e){return e.att_id===t.att_id})&&(t.selected=!0)}),l.total(n.attribute.length);var s=n.attribute.slice((l.page()-1)*l.count(),l.page()*l.count());a.resolve(s),n.attribisLoading=!1}else n.attribisLoading=!1,console.log(e.response.msg)})}})}angular.module("POS17").controller("attributesController",e),e.$inject=["$scope","$http","$filter","$state","ngDialog","toastr","attributeFactory","$timeout","ngTableParams"]}();
!function(){"use strict";function t(t,r,e,a,i,s,n,u,l,p,o,c,d,b,f,y,g){r.productType=[],r.selectedDatas=[],r.attributeTypes=[],r.categories=[],r.articles=[],r.attribute_group=[],r.attributeMaps=[],r.attributeMapValues=[],r.selectDeselectAll=!1,r.showAttributeValues=!1,r.enableProductType=!1,r.enableGroup=!1,r.enableCategories=!1,r.enableArticles=!1,r.showMultiSelect=!1,r.showDropdownlist=!1,r.showCheckbox=!1,r.showAttachment=!1,r.mapping=!1,r.map={},r.details={},r.attrib_type={},r.attrib_type.attribute_list_value=[],r.btn_save_update="save",r.details.valuelist=[],r.changesCount=0,r.$watch(function(){return r.details},function(){r.changesCount++,t.changesOccur=r.changesCount}),n.getAllAttributeTypes().then(function(t){if(200==t.statusCode&&t.response.success){var e;e=t.response.result,u(function(){r.$apply(function(){r.attributeTypes=e})},100)}}),n.getAllAttributeGroup().then(function(t){if(200==t.statusCode&&t.response.success){var e;e=t.response.result,u(function(){r.$apply(function(){r.attribute_group=e})},100)}}),c.getAllCategory().then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;u(function(){r.$apply(function(){r.categories=e})},100)}}),d.getArticle().then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;u(function(){r.$apply(function(){r.articles=e})},100)}}),o.getAllProdType().then(function(t){200==t.statusCode&&t.response.success&&(r.productType=t.response.result,_.each(r.productType,function(t){t.selected=!1}))}),async.waterfall([function(e){n.getAllAttributeTypes().then(function(t){200==t.statusCode&&t.response.success&&e(null,t.response.result)})},function(t,e){r.types=t,i.att_id?n.getAllAttributeDetails(i.att_id).then(function(t){200==t.statusCode&&t.response.success&&(r.mapping=!0,r.details=t.response.result,r.generateAttributeValueList(i.att_id),r.getAllAttributeMapValues())}):r.mapping=!1}]),r.generateAttributeValueList=function(t){n.getAttributeValueList(t).then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;r.details.attrib_type&&("Dropdownlist"==r.details.attrib_type.name||"Multiselect"==r.details.attrib_type.name||"Attachment"==r.details.attrib_type.name?(r.showAttributeValues=!0,r.attrib_type.attribute_list_value=[],r.showMultiSelect="Multiselect"==r.details.attrib_type.name,r.showDropdownlist="Dropdownlist"==r.details.attrib_type.name,r.showAttachment="Attachment"==r.details.attrib_type.name,_.each(e,function(t){r.attrib_type.attribute_list_value.push({att_id:i.att_id,name:t.name,value:t.value,description:t.description,contenttype:t.contenttype,sku:t.sku,value_image:t.value_image,_id:t._id,isEdit:!1})}),u(function(){r.$apply(function(){r.details.valuelist=e})},100)):("Checkbox"==r.details.attrib_type.name&&(r.showAttributeValues=!0,r.showCheckbox="Checkbox"==r.details.attrib_type.name),e&&0<e.length&&(e=e[0],r.attrib_type.attrib_name=e.name,r.attrib_type.attrib_value=e.value,r.attrib_type.attrib_description=e.description,r.attrib_type.contenttype=e.contenttype,r.attrib_type.sku=e.sku,r.attrib_type._id=e._id,r.attrib_type.isEdit=!0)))}})},r.getAllAttributeMapValues=function(){r.attributeMaps=[],r.attributeMapValues=[],n.getAttibuteMapping(i.att_id).then(function(t){if(200==t.statusCode&&t.response.success){r.attributeMaps=[],r.attributeMapValues=[];var e=t.response.result;_.each(e,function(t){r.attributeMaps.push({fk_ptype_id:t.fk_ptype_id||null,fk_att_id:t.fk_att_id,fk_attgrp_id:t.fk_attgrp_id||null,fk_c_id:t.fk_c_id||null,fk_article_id:t.fk_article_id||null});var e=_.find(r.productType,{ptype_id:t.fk_ptype_id}),a=_.find(r.attribute_group,{attgrp_id:t.fk_attgrp_id}),i=_.find(r.categories,{c_id:t.fk_c_id}),s=_.find(r.articles,{article_id:t.fk_article_id});r.attributeMapValues.push({fk_ptype:_.isEmpty(e)?null:e.name,fk_attgrp:_.isEmpty(a)?null:a.name,fk_category:_.isEmpty(i)?null:i.name,fk_article:_.isEmpty(s)?null:s.title})})}})},r.$watch(function(){return r.details.attrib_type_id},function(t){r.attrib_type.attrib_name="",r.attrib_type.attrib_value="",r.attrib_type.attrib_description="";var e=_.find(r.attributeTypes,{attrib_type_id:t});r.details.attrib_type=e,r.details.attrib_type&&("Dropdownlist"===r.details.attrib_type.name&&"Multiselect"===r.details.attrib_type.name&&"Attachment"===r.details.attrib_type.name&&"Checkbox"===r.details.attrib_type.name||(r.showAttributeValues=!1))}),r.$watch(function(){return r.attributeTypes},function(t){r.attrib_type.attrib_name="",r.attrib_type.attrib_value="",r.attrib_type.attrib_description="";var e=_.find(t,{attrib_type_id:r.details.attrib_type_id});r.details.attrib_type=e,r.generateAttributeValueList(i.att_id)}),r.$watch(function(){return r.productType},function(t){r.getAllAttributeMapValues()}),r.enableProductTypeEvent=function(t){0==t&&(r.map.fk_ptype_id=void 0)},r.enableGroupEvent=function(t){0==t&&(r.map.fk_attgrp_id=void 0)},r.enableCategoriesEvent=function(t){0==t&&(r.map.fk_c_id=void 0)},r.enableArticlesEvent=function(t){0==t&&(r.map.fk_article_id=void 0)},r.changeSelectDeselectAll=function(){r.selectDeselectAll=!r.selectDeselectAll,_.each(r.productType,function(t){t.selected=r.selectDeselectAll,r.deleteSomeData=r.selectDeselectAll,r.checkDataChanges(t)})},r.checkDataChanges=function(e){e.selected?_.find(r.selectedDatas,function(t){return t.ptype_id===e.ptype_id})||r.selectedDatas.push(e):r.selectedDatas=_.filter(r.selectedDatas,function(t){return t.ptype_id!==e.ptype_id}),r.deleteSomeData=0<r.selectedDatas.length},r.removethumbParent=function(){r.details.value_image=null},r.removethumb=function(){r.attrib_type.value_image=null},r.addtoList=function(t){if(i.att_id){if(_.isEmpty(r.attrib_type.attrib_name))return void l.warning("Please enter attribute value name","Warning");if(_.isEmpty(r.attrib_type.attrib_value))return void l.warning("Please enter attribute value","Warning");n.saveAttributeValueList(i.att_id,{name:r.attrib_type.attrib_name,value:r.attrib_type.attrib_value,description:r.attrib_type.attrib_description,contenttype:r.attrib_type.contenttype,sku:r.attrib_type.sku,_id:r.attrib_type._id,isEdit:r.attrib_type.isEdit}).then(function(t){if(200==t.statusCode&&t.response.success)l.success(t.response.msg,"Success"),r.clearInput(),p.reload();else{if(400!==t.statusCode||t.response.success||!_.isArray(t.response.result))return void l.error(t.response.msg,"Error");_.each(t.response.result,function(t){l.warning(t.msg,"Warning")})}})}else l.warning("Please select attribute to update","Warning")},r.addtoList1=function(){if(i.att_id){if(_.isEmpty(r.attrib_type.attrib_name))return void l.warning("Please enter attribute value name","Warning");if(_.isEmpty(r.attrib_type.attrib_value))return void l.warning("Please enter attribute value","Warning");_.find(r.attrib_type.attribute_list_value,{name:r.attrib_type.attrib_name}),_.find(r.attrib_type.attribute_list_value,{value:r.attrib_type.attrib_value});null==r.attrib_type.value_image&&(r.attrib_type.value_image=null),g.upload({url:f+y+"attributes/"+i.att_id+"/valuelist",data:{name:r.attrib_type.attrib_name,value:r.attrib_type.attrib_value,description:r.attrib_type.attrib_description,contenttype:r.attrib_type.contenttype,sku:r.attrib_type.sku,value_image:r.attrib_type.value_image,_id:r.attrib_type._id,isEdit:r.attrib_type.isEdit,att_id:r.attrib_type.att_id},method:"POST"}).then(function(t){if(200===t.data.statusCode&&t.data.response.success)0<t.data.response.result.duplicate_count?l.warning("Duplicate record found","Warning"):l.success(t.data.response.msg,"Success"),p.reload();else{if(400!==t.data.statusCode||t.data.response.success||!_.isArray(t.data.response.result))return void l.error(t.data.response.msg,"Error");_.each(t.data.response.result,function(t){l.warning(t.msg,"Warning")})}},function(t){console.log("Error status: "+t.status)})}else l.warning("Please select attribute to update","Warning")},r.addtoMapping=function(t){if(_.isEmpty(t))l.warning("Please select some values to map attributes","Warning");else{var e={fk_ptype_id:null,fk_att_id:r.details.att_id,fk_attgrp_id:null,fk_c_id:null,fk_article_id:null},a={fk_ptype:null,fk_attgrp:null,fk_category:null,fk_article:null};if(_.isUndefined(t.fk_ptype_id))l.warning("Please select PRODUCT TYPE to map attributes","Warning");else{e.fk_ptype_id=t.fk_ptype_id.ptype_id,a.fk_ptype=t.fk_ptype_id.name,_.isUndefined(t.fk_attgrp_id)||(e.fk_attgrp_id=t.fk_attgrp_id.attgrp_id,a.fk_attgrp=t.fk_attgrp_id.name),_.isUndefined(t.fk_c_id)||(e.fk_c_id=t.fk_c_id.c_id,a.fk_category=t.fk_c_id.name),_.isUndefined(t.fk_article_id)||(e.fk_article_id=t.fk_article_id.article_id,a.fk_article=t.fk_article_id.title);var i=_.find(r.attributeMaps,{fk_ptype_id:e.fk_ptype_id,fk_att_id:r.details.att_id,fk_attgrp_id:e.fk_attgrp_id,fk_c_id:e.fk_c_id,fk_article_id:e.fk_article_id});_.isEmpty(i)?(r.attributeMaps.push(e),r.attributeMapValues.push(a),r.enableProductType=!1,r.enableGroup=!1,r.enableCategories=!1,r.enableArticles=!1,r.map.fk_ptype_id=void 0,r.map.fk_attgrp_id=void 0,r.map.fk_c_id=void 0,r.map.fk_article_id=void 0):l.error("An attribute mapping already existed on the list","Warning")}}},r.removeFromMapping=function(t){r.attributeMaps.splice(t,1),r.attributeMapValues.splice(t,1)},r.clearMapping=function(){r.attributeMaps=[],r.attributeMapValues=[]},r.$watch(function(){return r.details},function(){r.details},!0),r.saveMapping=function(){var a=1;0<r.attributeMaps.length?i.att_id&&async.waterfall([function(e){n.deleteAttributeMapping(i.att_id).then(function(t){200==t.statusCode&&t.response.success&&e(null,i.att_id)})},function(t,e){async.eachSeries(r.attributeMaps,function(t,e){n.saveAttributeMapping(i.att_id,t).then(function(t){200==t.statusCode&&t.response.success?(a++,e()):l.error(t.response.msg,"Error")}),a==r.attributeMaps.length&&(l.success("Record Successfully Saved","Success"),p.reload())})}]):l.warning("Unable to save Attribute Mapping.. No list of mapping are available","Warning")},r.viewFromList=function(t){r.btn_save_update="update",r.attrib_type.att_id=t.att_id,r.attrib_type.attrib_name=t.name,r.attrib_type.attrib_value=t.value,r.attrib_type.attrib_description=t.description,r.attrib_type.contenttype=t.contenttype,r.attrib_type.sku=t.sku,r.attrib_type.value_image=t.value_image,r.attrib_type._id=t._id,r.attrib_type.isEdit=!0},r.clearInput=function(){r.attrib_type.attrib_name="",r.attrib_type.attrib_value="",r.attrib_type.attrib_description="",r.attrib_type.contenttype="",r.attrib_type.sku="",r.attrib_type.value_image=null,r.btn_save_update="save"},r.deleteSelected=function(t){a.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){n.deleteAttributeValueList(t.att_id,t._id).then(function(t){200==t.statusCode&&t.response.success?(l.success(t.response.msg,"Success"),p.reload()):l.error(t.response.msg,"Error")})})},r.saveAttribute=function(){r.details.values=r.attrib_type,async.waterfall([function(e){i.att_id?n.updateAttribute(i.att_id,r.details).then(function(t){if(200==t.statusCode&&t.response.success)u(function(){l.success("Successfully Updated","Success")},300),e(null,i.att_id);else{if(400!==t.statusCode||t.response.success||!_.isArray(t.response.result))return void l.error(t.response.msg||t.response.result.msg,"Error");_.each(t.response.result,function(t){l.warning(t.msg,"Warning")})}}):n.saveAttribute(r.details).then(function(t){if(200==t.statusCode&&t.response.success)u(function(){l.success("Successfully Added","Success")},300),e(null,t.response.result);else{if(400!==t.statusCode||t.response.success||!_.isArray(t.response.result))return void l.error(t.response.msg||t.response.result.msg,"Error");_.each(t.response.result,function(t){l.warning(t.msg,"Warning")})}})},function(e,a){"object"==typeof r.details.value_image||""==r.details.value_image?(""==r.details.value_image&&(r.details.value_image=null),g.upload({url:f+y+"attributes/"+e+"/upload-image",data:{value_image:r.details.value_image},method:"PUT"}).then(function(t){if(200===t.data.statusCode&&t.data.response.success)a(null,e);else if(400!==t.data.statusCode||t.data.response.success||!_.isArray(t.data.response.result))return void l.error(t.data.response.msg,"Error")},function(t){console.log("Error status: "+t.status)})):a(null,e)},function(t,e){p.go(p.current,{att_id:t},{reload:!0})}])}}angular.module("POS17").controller("attributeDetailsController",t),t.$inject=["$rootScope","$scope","$uibModal","ngDialog","$stateParams","localStorageService","attributeFactory","$timeout","toastr","$state","ptypeFactory","categoryFactory","articleFctry","AuthFctry","API_URL","API_VERSION","Upload"]}();
!function(){"use strict";function e(n,t,l,o,s,r,e,u,c,a){n.selectDeselectAll=!1,n.selectedDatas=[],n.txtSearch={text:""};n.refresh=function(){n.attribisLoading=!1,n.attributeGroupTable.reload()},n.searchData=function(){n.attributeGroupTable.reload()},n.changeSelectDeselectAll=function(){n.selectDeselectAll=!n.selectDeselectAll,_.each(n.groups,function(e){e.selected=n.selectDeselectAll,n.deleteSomeData=n.selectDeselectAll,n.checkDataChanges(e)})},n.checkDataChanges=function(t){t.selected?_.find(n.selectedDatas,function(e){return e.attgrp_id===t.attgrp_id})||n.selectedDatas.push(t):n.selectedDatas=_.filter(n.selectedDatas,function(e){return e.attgrp_id!==t.attgrp_id}),n.deleteSomeData=0<n.selectedDatas.length},n.toggleModal=function(e){s.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){u.deleteAttributeGroup(e).then(function(e){200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),o.reload()):r.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},n.deleteSelected=function(){s.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){var s=0;async.each(n.selectedDatas,function(e,t){e.selected&&(console.log("groups: ",e),u.deleteAttributeGroup(e.attgrp_id).then(function(e){console.log("data: ",e.response),200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),++s==n.selectedDatas.length&&o.reload(),t()):r.error(e.response.msg,"Error")}))})})},n.addGroups=function(e){t.open({animation:!0,templateUrl:"./modules/attributes/attribute.groups.modal.html",controller:"attributeModal",size:"xl",resolve:{items:function(){return e}}}).result.then(function(e){n.selected=e},function(){c.info("Modal dismissed at: "+new Date)})},n.attribisLoading=!0,n.groups=[],n.attributecopy=[],n.attributeGroupTable=new a({page:1,count:10,filter:n.txtSearch},{counts:[10,25,50,100],getData:function(o,r){u.getAllAttributeGroup().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;_.each(t,function(e){e.date_created=moment(e.date_created).format("YYYY-MM-DD")}),n.attributecopy=angular.copy(n.groups),r.filter().text?n.groups=l("filter")(t,r.filter().text):n.groups=t,n.selectedDatas&&0<n.selectedDatas.length&&_.each(n.groups,function(t){_.find(n.selectedDatas,function(e){return e.attgrp_id===t.attgrp_id})&&(t.selected=!0)}),n.attribisLoading=!1,r.total(n.groups.length);var s=n.groups.slice((r.page()-1)*r.count(),r.page()*r.count());o.resolve(s)}else n.attribisLoading=!1,console.log(e.response.msg)})}})}function t(o,t,s,e,r,n,l,u){o.items=e,o.group={},o.groupItems=[],o.attributeLists=[],o.items&&r.getAttributeGroupDetails(o.items).then(function(e){200==e.statusCode&&e.response.success&&(o.group=e.response.result,r.getAllAttributeGroupItems(e.response.result.attgrp_id).then(function(e){e&&e.response&&0<e.response.result.length&&(_.each(e.response.result,function(e){e.isFrom="Mapped_Atribute"}),o.groupItems=e.response.result,o.models.lists.Group_Items=e.response.result),o.getAllattributes()}))}),o.getAllattributes=function(){r.getAllAttribute().then(function(e){o.attributeLists=e.response.result,e&&e.response&&0<e.response.result.length&&_.each(e.response.result,function(t){t.isFrom="Atributes",_.find(o.groupItems,function(e){return e.att_id==t.att_id})?console.log("found existing.."):o.models.lists.Atributes.push(t)})})},o.saveGroup=function(){o.items?r.updateAttributeGroup(o.items,o.group).then(function(e){200==e.statusCode&&e.response.success&&(console.log("UPDATE"),l.success("Successfully Update","Success"),t.reload(),s.close(e.response.success))}):r.saveAttributeGroup(o.group).then(function(e){200==e.statusCode&&e.response.success&&n(function(){o.$apply(function(){l.success("Successfully Added","Success"),t.reload(),s.close(e.response.success)})},100)})},o.cancel=function(){s.dismiss("cancel"),t.reload()},o.models={selected:null,lists:{Atributes:o.attributeLists,Group_Items:o.groupItems}},o.$watch("models",function(e){o.modelAsJson=angular.toJson(e,!0),console.log("model : ",e)},!0),o.moved=function(e,t,s){"Atributes"==e.isFrom?(_.pull(o.models.lists.Atributes,e),r.saveAttributeGroupItems(o.items,e).then(function(e){e.response.success?l.success("Success"):l.error("Fail")})):(_.pull(o.models.lists.Group_Items,e),r.deleteAttributeGroupItems(o.items,e.att_id).then(function(e){e.response.success?l.success("Success"):l.error("Fail")}))}}angular.module("POS17").controller("attributeGroups",e).controller("attributeModal",t),e.$inject=["$scope","$uibModal","$filter","$state","ngDialog","toastr","$timeout","attributeFactory","$log","ngTableParams"],t.$inject=["$scope","$state","$uibModalInstance","items","attributeFactory","$timeout","toastr","$q"]}();
!function(){"use strict";function e(c,n,e,t,a,s){c.selectDeselectAll=!1,c.selectedDatas=[],c.txtSearch={text:""};c.refresh=function(){c.attribisLoading=!1,c.attributeTypesTable.reload()},c.changeSelectDeselectAll=function(){c.selectDeselectAll=!c.selectDeselectAll,_.each(c.types,function(e){e.selected=c.selectDeselectAll,c.deleteSomeData=c.selectDeselectAll,c.checkDataChanges(e)})},c.searchData=function(){c.attributeTypesTable.reload()},c.checkDataChanges=function(t){t.selected?_.find(c.selectedDatas,function(e){return e.id===t.id})||c.selectedDatas.push(t):c.selectedDatas=_.filter(c.selectedDatas,function(e){return e.id!==t.id}),c.deleteSomeData=0<c.selectedDatas.length},c.deleteSelected=function(){e.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:c,className:"ngdialog-theme-default"}).then(function(){})},c.attribisLoading=!0,c.types=[],c.typescopy=[],c.attributeTypesTable=new s({page:1,count:10,filter:c.txtSearch},{counts:[10,25,50,100],getData:function(s,l){a.getAllAttributeTypes().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;_.each(c.types,function(e){e.date_created=moment(e.date_created).format("YYYY-MM-DD")}),c.attributecopy=angular.copy(c.types),l.filter().text?c.types=n("filter")(t,l.filter().text):c.types=t,c.selectedDatas&&0<c.selectedDatas.length&&_.each(c.types,function(t){_.find(c.selectedDatas,function(e){return e.id===t.id})&&(t.selected=!0)}),c.attribisLoading=!1,l.total(c.types.length);var a=c.types.slice((l.page()-1)*l.count(),l.page()*l.count());s.resolve(a)}else c.attribisLoading=!1,console.log(e.response.msg)})}})}angular.module("POS17").controller("attributeTypes",e),e.$inject=["$scope","$filter","ngDialog","toastr","attributeFactory","ngTableParams"]}();
!function(){"use strict";function t(t,e,a,i,r,u,n,l){t.attrib={},t.attrib.attribute_list_value=[],t.attrib.attribute_list_value2=[];var o=_.find(a.attributeTypes,{attrib_type_id:a.attrib_type_id});t.attrib.attrib_type=o;var s=JSON.parse(n.get("user")),b=t.uploader=new i({url:r+u+"/attributevalues/"+a.attribute_id,method:"PUT",headers:{Authorization:"Bearer "+l.getUserToken(),accesskey:s.subscriptionKey}});b.filters.push({name:"imageFilter",fn:function(t,e){var a="|"+t.type.slice(t.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(a)}}),b.onBeforeUploadItem=function(t){t.alias="pb_image"},t.removethumb=function(){t.attrib.value_image=null},t.addtoList=function(){t.attrib.attribute_list_value.push({name:t.attrib.name,value:t.attrib.value}),t.attrib.name="",t.attrib.value=""},t.addtoList2=function(){t.attrib.attribute_list_value2.push({name:t.attrib.name,value:t.attrib.value}),t.attrib.name="",t.attrib.value=""},t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}angular.module("POS17").controller("producttypeAttributeModalCtrl",t),t.inject=["$scope","$uibModalInstance","attributes","FileUploader","API_URL","API_VERSION","localStorageService","AuthFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,e){e.state("main.settings-categories",{url:"/settings/categories",templateUrl:"modules/category/categories.html",controller:"categoryController"}).state("main.export-category",{url:"/settings/categories/exports",templateUrl:"modules/category/categories.export-pdf.html",controller:"categoryExportsController"}).state("main.settings-categories-add",{url:"/settings/categories/:c_id",templateUrl:"modules/category/category.detail.html",controller:"categoryDetailsController"})}])}();
!function(){"use strict";function e(n,e,r,t,s,a,c,o,l,i,u,g,d,f){n.selectDeselectAll=!1,n.selectedDatas=[],n.txtSearch={text:""},n.reportFields={c_id:"ID",name:"Name",label:"Label",description:"Description",c_image:"Image",parent_id:"Parent Category"};var p=JSON.parse(i.get("user"));u.logTransaction("View Categories","CATEGORIES","ALL","User:="+p.username+" View all list of categories");var m=function(){n.categoryIsLoading=!0,n.categories=[],n.categoriescopy=[],n.categoryTable=new l({page:1,count:10,filter:n.txtSearch},{counts:[10,25,50,100],getData:function(o,a){c.getAllCategory().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;n.categoriescopy=angular.copy(n.categories),a.filter().text?n.categories=r("filter")(t,a.filter().text):n.categories=t,n.selectedDatas&&0<n.selectedDatas.length&&_.each(n.categories,function(t){_.find(n.selectedDatas,function(e){return e.c_id===t.c_id})&&(t.selected=!0)}),a.total(n.categories.length);var s=n.categories.slice((a.page()-1)*a.count(),a.page()*a.count());o.resolve(s),n.categoryIsLoading=!1}else n.categoryIsLoading=!1,console.log(e.response.msg)})}})};n.refresh=function(){n.categoryIsLoading=!0,n.categoryTable.reload()},n.edit=function(e){t.go("main.settings-categories-add",{c_id:e})},n.searchData=function(){n.categoryTable.reload()},n.changeSelectDeselectAll=function(){n.selectDeselectAll=!n.selectDeselectAll,_.each(n.categories,function(e){e.selected=n.selectDeselectAll,n.deleteSomeData=n.selectDeselectAll,n.checkDataChanges(e)})},n.checkDataChanges=function(t){t.selected?_.find(n.selectedDatas,function(e){return e.c_id===t.c_id})||n.selectedDatas.push(t):n.selectedDatas=_.filter(n.selectedDatas,function(e){return e.c_id!==t.c_id}),n.deleteSomeData=0<n.selectedDatas.length},n.toggleModal=function(e){s.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){c.deleteCategory(e).then(function(e){200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),t.reload()):a.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},n.deleteSelected=function(){s.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){async.each(n.selectedDatas,function(e,t){e.selected&&c.deleteCategory(e.c_id).then(function(e){if(e.response.result.warning_msg)a.warning(e.response.result.warning_msg,"Warning");else{if(200!=e.statusCode||!e.response.success)return void a.error(e.response.msg,"Error");a.success(e.response.msg,"Success"),t()}})},function(){m()})})},n.publishSelectedItem=function(e){n.modal={title:"Publish Category?",message:"Are you sure to Publish this selected category?"},s.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){c.publishCategory(e).then(function(e){200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),o(function(){m()},1e3)):a.error(e.response.msg,"Error")})})},n.unpublishSelectedItem=function(e){n.modal={title:"Unpublish Category?",message:"Are you sure to Unpublish this selected category?"},s.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){c.unpublishCategory(e).then(function(e){200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),o(function(){m()},1e3)):a.error(e.response.msg,"Error")})})},n.importCategory=function(e){if("csv"==e){var s=g.open({animation:!0,backdrop:"static",size:"sm",templateUrl:"modules/dialog/importCategory.modal.html",scope:n});s.result.then(function(){},function(){}),n.uploadCategory=function(){angular.forEach(n.files,function(t){t.upload=d.upload({url:f.configuration.baseUrl+"/categories/import",data:{file:t}}),t.upload.then(function(e){o(function(){t.result=e.data,200==e.status?(a.success(e.data.response.msg,"Success"),n.files=[],n.progressState=0,s.dismiss("close")):500==e.status?(n.files=[],n.progressState=0,a.error(e.data.response.msg,"Error")):(n.files=[],n.progressState=0,a.warning(e.data.response.msg,"Error")),m()})},function(e){0<e.status&&(n.errorMsg=e.status+": "+e.data)},function(e){t.progress=Math.min(100,parseInt(100*e.loaded/e.total)),n.progressState=Math.min(100,parseInt(100*e.loaded/e.total))})})},n.cancel=function(){s.dismiss("close"),n.files=[],n.progressState=0}}},n.setUploadFile=function(e,t,s,o){console.log("files ",e),"csv"==e[0].name.split(".")[e[0].name.split(".").length-1]?(n.files=e,n.errFiles=t,n.param=s,n.classification=o):(a.warning("Format of the choosen File is invalid, please choose CSV file","Warning"),n.files=[])},m()}angular.module("POS17").controller("categoryController",e),e.$inject=["$scope","$http","$filter","$state","ngDialog","toastr","categoryFactory","$timeout","ngTableParams","localStorageService","transLogFctry","$uibModal","Upload","Restangular"]}();
!function(){"use strict";function t(r,t,e){console.log("categoryExportsController"),r.currentDate=Date.now(),r.categories=[],r.IsExport=!1,t.getAllCategory().then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;_.isEmpty(e)||(r.categories=e)}else console.log(t.response.msg)}),r.myFunction=function(){r.IsExport=!0,angular.element(document).ready(function(){e(function(){console.log("basic-table"),$("#basic-table").trigger("footable_redraw")},1e3)})},r.export=function(){var t=Date.now()+"categories.pdf",o="{total_pages_count_string}",n=new jsPDF({orientation:"landscape",format:"a4"}),e=document.getElementById("basic-table"),a=n.autoTableHtmlToJson(e);n.autoTable(a.columns,a.data,{addPageContent:function(t){n.setFontSize(20),n.setTextColor(40),n.setFontStyle("normal"),n.text("Category --- Date: "+moment(r.currentDate).format("MM/DD/YYYY hh:mm a"),t.settings.margin.left,15);var e="Page "+t.pageCount;"function"==typeof n.putTotalPages&&(e=e+" of "+o),n.setFontSize(10),n.text(e,t.settings.margin.left,n.internal.pageSize.height-5)},startY:20,margin:{top:30},styles:{overflow:"linebreak",columnWidth:"wrap"},columnStyles:{0:{columnWidth:55},1:{columnWidth:60},2:{columnWidth:100},3:{columnWidth:55}}}),"function"==typeof n.putTotalPages&&n.putTotalPages(o),n.save(t)}}angular.module("POS17").controller("categoryExportsController",t),t.$inject=["$scope","categoryFactory","$timeout"]}();
!function(){"use strict";function e(c,n,t,o,e,r,a,i,u,l,s,g){c.details={},c.details.tags=[],c.tagsArr=[],c.categoryData=[],c.newImage=!1;var d=[],p=[];c.loading=!1;var m=JSON.parse(s.get("user"));o.article_id?g.logTransaction("View Category Details","CATEGORIES",o.c_id,"User:="+m.username+" View category details:="+o.c_id):g.logTransaction("Add New Category","CATEGORIES","N/A","User:="+m.username+" Add new category entry"),l.getAllTags().then(function(e){200==e.statusCode&&e.response.success?c.tagsArr=e.response.result:console.log(e.response.msg)}),c.generateCategory=function(){e.getAllCategory().then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;console.log("categories:",s);for(var t=0;t<s.length;t++){var r=s[t],n=r.name,o=r.parent_id,a=r.c_id;_.isEmpty(p[o])?(p[a]={parentid:o,label:n,item:r},d[a]=p[a]):null!=(r={parentid:o,label:n,item:r})&&(p[o].items||(p[o].items=[]),p[o].items[p[o].items.length]=r,p[a]=r)}c.categoryData=_.omitBy(_.uniq(d),_.isEmpty)}})},c.generateCategory(),o.c_id&&e.getCategoryDetails(o.c_id).then(function(e){var s,t,r;200==e.statusCode&&e.response.success&&(c.details=e.response.result,(s=c.details.c_image,t=n.defer(),r=new Image,r.onerror=function(){t.resolve(!1)},r.onload=function(){t.resolve(!0)},r.src=s,t.promise).then(function(e){console.log("bool:",e),c.isimage=!!e}),l.getAllCategoryTags(o.c_id).then(function(e){200==e.statusCode&&e.response.success&&(c.details.tags=e.response.result)}))}),c.deleteProductTags=function(e){o.c_id&&l.deleteCategoryTag(o.c_id,e.tags_id).then(function(e){200==e.statusCode&&e.response.success?u.success(e.response.msg,"Success"):u.error(e.response.msg,"Error")})},c.tagTransform=function(e){return{tags:e}},c.clearInput=function(e){e.search=""},c.toplevelCategory=function(){c.TPchecked?c.mytree.currentNode={}:c.generateCategory()},c.changeItem=function(e){c.selectedItem=e},c.removethumb=function(){c.details.c_image=null,c.newImage=!1},c.upload=function(e){c.newImage=!0},c.saveCategory=function(){c.loading=!0,c.mytree&&angular.isObject(c.mytree.currentNode)&&!_.isEmpty(c.mytree.currentNode)?c.details.parent_id=c.mytree.currentNode.item.c_id:c.TPchecked&&(c.details.parent_id=null),async.waterfall([function(s){o.c_id?e.updateCategory(o.c_id,c.details).then(function(e){if(200==e.statusCode&&e.response.success)u.success(e.response.msg,"Success"),s(null,o.c_id);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return u.error(e.response.msg,"Error"),void(c.loading=!1);_.each(e.response.result,function(e){u.warning(e.msg,"Warning")})}}):e.saveCategory(c.details).then(function(e){if(200==e.statusCode&&e.response.success)u.success(e.response.msg,"Success"),s(null,e.response.result);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return u.error(e.response.msg,"Error"),void(c.loading=!1);_.each(e.response.result,function(e){u.warning(e.msg,"Warning")}),c.loading=!1}})},function(t,e){0<c.details.tags.length?async.eachSeries(c.details.tags,function(e,s){e.isTag?l.saveTags(e).then(function(e){if(200!=e.statusCode||!e.response.success)return u.error(e.response.msg,"Error"),void(c.loading=!1);l.saveCategoryTags(t,{tag_id:e.response.result}).then(function(e){if(200!=e.statusCode||!e.response.success)return u.error(e.response.msg,"Error"),void(c.loading=!1);s()})}):l.saveCategoryTags(t,{tag_id:e.tags_id}).then(function(e){if(200!=e.statusCode||!e.response.success)return u.error(e.response.msg,"Error"),void(c.loading=!1);s()})},function(){e(null,t)}):e(null,t)},function(s,e){c.newImage&&c.details.c_image?r.upload({url:a+i+"categories/"+s+"/upload-image",data:{c_image:c.details.c_image},method:"PUT"}).then(function(e){if(200===e.data.statusCode&&e.data.response.success)u.success("Image successfully uploaded","Success"),t.go(t.current,{c_id:s},{reload:!0});else{if(400!==e.data.statusCode||e.data.response.success||!_.isArray(e.data.response.result))return void u.error(e.data.response.msg,"Error");_.each(e.data.response.result,function(e){u.warning(e.msg,"Warning")}),c.loading=!1}},function(e){console.log("Error status: "+e.status)},function(e){parseInt(100*e.loaded/e.total)}).catch(function(e){console.log("Error: ",e)}):t.go("main.settings-categories",null,{reload:!0})}])},c._reloadCategories=function(){t.reload()}}angular.module("POS17").controller("categoryDetailsController",e),e.$inject=["$scope","$q","$state","$stateParams","categoryFactory","Upload","API_URL","API_VERSION","toastr","tagsFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(e,r){r.state("main.settings-currencies",{url:"/settings/currencies",templateUrl:"modules/currencies/currencies.html",controller:"currenciesController"})}])}();
!function(){"use strict";function e(s,i,e,r,c,n,t,o){var a=JSON.parse(t.get("user"));o.logTransaction("View Currencies","CURRENCIES","ALL","User:="+a.username+" View all list of currencies"),s.txtSearch={text:""};s.searchData=function(){s.currenciesTable.reload()},s.refresh=function(){s.currencyisLoading=!0,s.currenciesTable.reload()},s.currencyisLoading=!0,s.currencies=[],s.currenciescopy=[],s.currenciesTable=new c({page:1,count:10,filter:s.txtSearch},{counts:[10,25,50,100],getData:function(n,t){r.getAllCurrencies().then(function(e){if(200==e.statusCode&&e.response.success){var r=e.response.result;if(s.currenciescopy=angular.copy(s.currencies),t.filter().text){s.currencies=i("filter")(r,t.filter().text),t.total(s.currencies.length);var c=s.currencies.slice((t.page()-1)*t.count(),t.page()*t.count());n.resolve(c)}else s.currencies=r,t.total(s.currencies.length),c=s.currencies.slice((t.page()-1)*t.count(),t.page()*t.count()),n.resolve(c);s.currencyisLoading=!1}else s.currencyisLoading=!1,console.log(e.response.msg)})}})}angular.module("POS17").controller("currenciesController",e),e.$inject=["$scope","$filter","$timeout","currencyFactory","ngTableParams","toastr","localStorageService","transLogFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,e){e.state("main.settings-producttype",{url:"/settings/producttype",templateUrl:"modules/producttype/productTypes.html",controller:"productTypeController"}).state("main.settings-producttype-add",{url:"/settings/producttype/:ptype_id",templateUrl:"modules/producttype/productType.detail.html",controller:"producttypeDetailController"})}])}();
!function(){"use strict";function e(l,e,o,n,t,a,c,r,s,i,p,d,u,g){l.typeisLoading=!0,l.selectDeselectAll=!1,l.selectedDatas=[];var f=JSON.parse(i.get("user"));p.logTransaction("View Product Types","PRODUCT TYPES","ALL","User:="+f.username+" View all list of product types");var y=function(){l.typeisLoading=!0,l.producttypes=[],l.producttypescopy=[],l.txtSearch={text:""},l.productTypeTable=new s({page:1,count:l.txtSearch?10:l.producttypes.length,filter:l.txtSearch},{counts:[10,25,50,100],getData:function(o,a){c.getAllProdType().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;l.producttypescopy=angular.copy(l.producttypes),a.filter().text?l.producttypes=n("filter")(t,a.filter().text):l.producttypes=t,l.selectedDatas&&0<l.selectedDatas.length&&_.each(l.producttypes,function(t){_.find(l.selectedDatas,function(e){return e.ptype_id===t.ptype_id})&&(t.selected=!0)}),l.typeisLoading=!1,a.total(l.producttypes.length);var s=l.producttypes.slice((a.page()-1)*a.count(),a.page()*a.count());o.resolve(s)}else l.typeisLoading=!1,console.log(e.response.msg)})}})};y(),l.refresh=function(){l.typeisLoading=!0,l.productTypeTable.reload()},l.edit=function(e){o.go("main.settings-producttype-add",{ptype_id:e})},l.searchData=function(){l.productTypeTable.reload()},l.changeSelectDeselectAll=function(){l.selectDeselectAll=!l.selectDeselectAll,_.each(l.producttypes,function(e){e.selected=l.selectDeselectAll,l.deleteSomeData=l.selectDeselectAll,l.checkDataChanges(e)})},l.checkDataChanges=function(t){t.selected?_.find(l.selectedDatas,function(e){return e.ptype_id===t.ptype_id})||l.selectedDatas.push(t):l.selectedDatas=_.filter(l.selectedDatas,function(e){return e.ptype_id!==t.ptype_id}),l.deleteSomeData=0<l.selectedDatas.length},l.toggleModal=function(e){t.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:l,className:"ngdialog-theme-default"}).then(function(){c.deleteProductType(e).then(function(e){200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),o.reload()):a.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},l.deleteSelected=function(){t.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:l,className:"ngdialog-theme-default"}).then(function(){var s=0;async.each(l.selectedDatas,function(e,t){e.selected&&c.deleteProductType(e.ptype_id).then(function(e){200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),++s==l.selectedDatas.length&&o.reload(),t()):a.warning("Unable to Delete : Product type is used by other module","Warning")})})})},l.importProductType=function(e){if("csv"==e){var s=d.open({animation:!0,backdrop:"static",size:"sm",templateUrl:"modules/dialog/importProducttype.modal.html",scope:l});s.result.then(function(){},function(){}),l.uploadProductType=function(){angular.forEach(l.files,function(t){t.upload=u.upload({url:g.configuration.baseUrl+"/producttype/import",data:{file:t}}),t.upload.then(function(e){r(function(){t.result=e.data,200==e.status?(a.success(e.data.response.msg,"Success"),l.files=[],l.progressState=0,s.dismiss("close")):500==e.status?(l.files=[],l.progressState=0,a.error(e.data.response.msg,"Error")):(l.files=[],l.progressState=0,a.warning(e.data.response.msg,"Error")),y()})},function(e){0<e.status&&(l.errorMsg=e.status+": "+e.data)},function(e){t.progress=Math.min(100,parseInt(100*e.loaded/e.total)),l.progressState=Math.min(100,parseInt(100*e.loaded/e.total))})})},l.cancel=function(){s.dismiss("close"),l.files=[],l.progressState=0}}},l.setUploadFile=function(e,t,s,o){console.log("files ",e),"csv"==e[0].name.split(".")[e[0].name.split(".").length-1]?(l.files=e,l.errFiles=t,l.param=s,l.classification=o):(a.warning("Format of the choosen File is invalid, please choose CSV file","Warning"),l.files=[])}}angular.module("POS17").controller("productTypeController",e),e.$inject=["$scope","$http","$state","$filter","ngDialog","toastr","ptypeFactory","$timeout","ngTableParams","localStorageService","transLogFctry","$uibModal","Upload","Restangular"]}();
!function(){"use strict";function e(t,n,o,e,a,r,u,c,p,i,d,s,l){o.details={},o.details.tags=[],o.tags=[],o.tagsArr=[],o.newImage=!1,o._productTypeExist=!1;var g=JSON.parse(s.get("user"));a.ptype_id?l.logTransaction("View Product Type Details","PRODUCT TYPES",a.ptype_id,"User:="+g.username+" View product type details:="+a.ptype_id):l.logTransaction("Add New Product Type","PRODUCT TYPES","N/A","User:="+g.username+" Add new product type entry"),d.getAllTags().then(function(e){200==e.statusCode&&e.response.success?o.tagsArr=e.response.result:console.log(e.response.msg)}),a.ptype_id&&r.getAllProdTypeDetails(a.ptype_id).then(function(e){var s,t,r;200==e.statusCode&&e.response.success&&(o.details=e.response.result,(s=o.details.ptype_image,t=n.defer(),r=new Image,r.onerror=function(){t.resolve(!1)},r.onload=function(){t.resolve(!0)},r.src=s,t.promise).then(function(e){o.isimage=!!e}),d.getAllProductTypeTags(a.ptype_id).then(function(e){200==e.statusCode&&e.response.success&&(o.details.tags=e.response.result)}))}),o.removethumb=function(){o.details.ptype_image=null,o.newImage=!1},o.upload=function(e){o.newImage=!0},o.tagTransform=function(e){return{tags:e}},o.clearInput=function(e){console.log("$select;",e),e.search=""},o.deleteProductTags=function(e){a.ptype_id&&d.deleteProductTypeTag(a.ptype_id,e.tags_id).then(function(e){200==e.statusCode&&e.response.success?c.success(e.response.msg,"Success"):c.error(e.response.msg,"Error")})},o.saveProductType=function(){async.waterfall([function(s){a.ptype_id?r.updateProductType(a.ptype_id,o.details).then(function(e){if(200==e.statusCode&&e.response.success)c.success(e.response.msg,"Success"),s(null,a.ptype_id);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void c.error(e.response.msg,"Error");_.each(e.response.result,function(e){c.warning(e.msg,"Warning")})}}):r.saveProductType(o.details).then(function(e){if(200==e.statusCode&&e.response.success)c.success(e.response.msg,"Success"),s(null,e.response.result),t.go("main.settings-producttype-add",{ptype_id:e.response.result},{reload:!0});else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void c.error(e.response.msg,"Error");_.each(e.response.result,function(e){c.warning(e.msg,"Warning")})}})},function(t,r){var n=1;0<o.details.tags.length?async.eachSeries(o.details.tags,function(e,s){e.isTag?d.saveTags(e).then(function(e){200==e.statusCode&&e.response.success?d.saveProductTypeTags(t,{tag_id:e.response.result}).then(function(e){200==e.statusCode&&e.response.success?(n++,s()):c.error(e.response.msg,"Error")}):c.error(e.response.msg,"Error")}):d.saveProductTypeTags(t,{tag_id:e.tags_id}).then(function(e){200==e.statusCode&&e.response.success?(n++,s()):c.error(e.response.msg,"Error")}),n>=o.details.tags.length&&r(null,t)}):r(null,t)},function(s,e){o.newImage&&o.details.ptype_image?u.upload({url:p+i+"producttype/"+s+"/upload-image",data:{ptype_image:o.details.ptype_image},method:"PUT"}).then(function(e){if(200===e.data.statusCode&&e.data.response.success)o.newImage&&c.success("Image successfully uploaded","Success"),t.go(t.current,{ptype_id:s},{reload:!0});else{if(400!==e.data.statusCode||e.data.response.success||!_.isArray(e.data.response.result))return void c.error(e.data.response.msg,"Error");_.each(e.data.response.result,function(e){c.warning(e.msg,"Warning")})}},function(e){console.log("Error status: "+e.status)},function(e){parseInt(100*e.loaded/e.total)}):t.go("main.settings-producttype",null,{reload:!0})}])},o._checkProductTypeIfExist=function(){o.details.name;r.getAllProdType().then(function(e){var s=_.some(e.response.result,function(e){return e.name.toLowerCase()===o.details.name.toLowerCase()});o._productTypeExist=!!s})}}angular.module("POS17").controller("producttypeDetailController",e),e.$inject=["$state","$q","$scope","$http","$stateParams","ptypeFactory","Upload","toastr","API_URL","API_VERSION","tagsFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(s,e){e.state("main.settings-suppliers",{url:"/settings/suppliers",templateUrl:"modules/suppliers/suppliers.html",controller:"suppliersController"}).state("main.export-suppliers",{url:"/settings/suppliers/exports",templateUrl:"modules/suppliers/suppliers.export-pdf.html",controller:"suppliersExportsController"}).state("main.settings-suppliers-add",{url:"/settings/suppliers/:s_id",templateUrl:"modules/suppliers/supplier.detail.html",controller:"suppliersDetailsController"})}])}();
!function(){"use strict";function e(n,e,o,l,s,c,t,a,r,i,p){n.selectDeselectAll=!1,n.selectedDatas=[],n.txtSearch={text:""},n.reportFields={s_id:"ID",name:"Name",contact_number:"Contact Number",contact_person:"Contact Person",address:"Address",date_created:"Date Created",_id:"UUID"};var u=JSON.parse(i.get("user"));p.logTransaction("View Suppliers","SUPPLIERS","ALL","User:="+u.username+" View all list of suppliers");n.refresh=function(){n.supplierisLoading=!0,n.supplierTable.reload()},n.edit=function(e){l.go("main.settings-suppliers-add",{s_id:e})},n.searchData=function(){n.supplierTable.reload()},n.changeSelectDeselectAll=function(){n.selectDeselectAll=!n.selectDeselectAll,_.each(n.suppliers,function(e){e.selected=n.selectDeselectAll,n.deleteSomeData=n.selectDeselectAll,n.checkDataChanges(e)})},n.checkDataChanges=function(s){s.selected?_.find(n.selectedDatas,function(e){return e.s_id===s.s_id})||n.selectedDatas.push(s):n.selectedDatas=_.filter(n.selectedDatas,function(e){return e.s_id!==s.s_id}),n.deleteSomeData=0<n.selectedDatas.length},n.toggleModal=function(e){s.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){c.deleteSupplier(e).then(function(e){200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),l.reload()):a.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},n.deleteSelected=function(){s.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){var t=0;async.each(n.selectedDatas,function(e,s){e.selected&&(console.log("supplier: ",e),c.deleteSupplier(e.s_id).then(function(e){console.log("data: ",e.response),200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),++t==n.selectedDatas.length&&l.reload(),s()):a.error(e.response.msg,"Error")}))})})},n.supplierisLoading=!0,n.suppliers=[],n.supplierscopy=[],n.supplierTable=new r({page:1,count:10,filter:n.txtSearch},{counts:[10,25,50,100],getData:function(l,a){c.getAllSuppliers().then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;n.supplierscopy=angular.copy(n.suppliers),a.filter().text?n.suppliers=o("filter")(s,a.filter().text):n.suppliers=s,n.selectedDatas&&0<n.selectedDatas.length&&_.each(n.suppliers,function(s){_.find(n.selectedDatas,function(e){return e.s_id===s.s_id})&&(s.selected=!0)}),a.total(n.suppliers.length);var t=n.suppliers.slice((a.page()-1)*a.count(),a.page()*a.count());l.resolve(t),n.supplierisLoading=!1}else n.supplierisLoading=!1,console.log(e.response.msg)})}})}angular.module("POS17").controller("suppliersController",e),e.$inject=["$scope","$http","$filter","$state","ngDialog","supplierFctry","$timeout","toastr","ngTableParams","localStorageService","transLogFctry"]}();
!function(){"use strict";function t(l,t,e){console.log("suppliersExportsController"),l.currentDate=Date.now(),l.suppliers=[],l.IsExport=!1,t.getAllSuppliers().then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;_.isEmpty(e)||(l.suppliers=e)}else console.log(t.response.msg)}),l.myFunction=function(){l.IsExport=!0,angular.element(document).ready(function(){e(function(){console.log("basic-table"),$("#basic-table").trigger("footable_redraw")},1e3)})},l.export=function(){var t=Date.now()+"suppliers.pdf",o="{total_pages_count_string}",n=new jsPDF({orientation:"landscape",format:"a4"}),e=document.getElementById("basic-table"),s=n.autoTableHtmlToJson(e);n.autoTable(s.columns,s.data,{addPageContent:function(t){n.setFontSize(20),n.setTextColor(40),n.setFontStyle("normal"),n.text("Suppliers --- Date: "+moment(l.currentDate).format("MM/DD/YYYY hh:mm a"),t.settings.margin.left,15);var e="Page "+t.pageCount;"function"==typeof n.putTotalPages&&(e=e+" of "+o),n.setFontSize(10),n.text(e,t.settings.margin.left,n.internal.pageSize.height-5)},startY:20,margin:{top:30},styles:{overflow:"linebreak",columnWidth:"wrap"},columnStyles:{0:{columnWidth:50},1:{columnWidth:100},2:{columnWidth:50},3:{columnWidth:40},4:{columnWidth:30}}}),"function"==typeof n.putTotalPages&&n.putTotalPages(o),n.save(t)}}angular.module("POS17").controller("suppliersExportsController",t),t.$inject=["$scope","supplierFctry","$timeout"]}();
!function(){"use strict";function s(o,s,r,t,a,n,e,i,u,c){o.details={},o.details.tags=[],o.tagsArr=[];var l=JSON.parse(u.get("user"));r.s_id?c.logTransaction("View Supplier Details","SUPPLIERS",r.s_id,"User:="+l.username+" View supplier details:="+r.s_id):c.logTransaction("Add New Supplier","SUPPLIERS","N/A","User:="+l.username+" Add new supplier entry"),i.getAllTags().then(function(s){200==s.statusCode&&s.response.success?o.tagsArr=s.response.result:console.log(s.response.msg)}),r.s_id&&t.getAllSuppliersDetails(r.s_id).then(function(s){200==s.statusCode&&s.response.success&&(o.details=s.response.result,i.getAllSupplierTags(r.s_id).then(function(s){200==s.statusCode&&s.response.success&&(o.details.tags=s.response.result)}))}),o.deleteProductTags=function(s){r.s_id&&i.deleteSupplierTag(r.s_id,s.tags_id).then(function(s){200==s.statusCode&&s.response.success?a.success(s.response.msg,"Success"):a.error(s.response.msg,"Error")})},o.tagTransform=function(s){return{tags:s}},o.clearInput=function(s){s.search=""},o.saveSupplier=function(){async.waterfall([function(e){r.s_id?t.updateSupplier(r.s_id,o.details).then(function(s){if(200==s.statusCode&&s.response.success)a.success(s.response.msg,"Success"),e(null,r.s_id);else{if(400!==s.statusCode||s.response.success||!_.isArray(s.response.result))return void a.error(s.response.msg,"Error");_.each(s.response.result,function(s){a.warning(s.msg,"Warning")})}}):t.saveSupplier(o.details).then(function(s){if(200==s.statusCode&&s.response.success)a.success(s.response.msg,"Success"),e(null,s.response.result);else{if(400!==s.statusCode||s.response.success||!_.isArray(s.response.result))return void a.error(s.response.msg,"Error");_.each(s.response.result,function(s){a.warning(s.msg,"Warning")})}})},function(r,t){console.log("s_id: ",r);var n=1;0<o.details.tags.length?async.eachSeries(o.details.tags,function(s,e){s.isTag?i.saveTags(s).then(function(s){200==s.statusCode&&s.response.success?i.saveSupplierTags(r,{tag_id:s.response.result}).then(function(s){200==s.statusCode&&s.response.success?(n++,e()):a.error(s.response.msg,"Error")}):a.error(s.response.msg,"Error")}):i.saveSupplierTags(r,{tag_id:s.tags_id}).then(function(s){200==s.statusCode&&s.response.success?(n++,e()):a.error(s.response.msg,"Error")}),n>=o.details.tags.length&&t(null,r)}):t(null,r)},function(s,e){console.log("callback s_id: ",s),n.go("main.settings-suppliers-add",{s_id:s},{reload:!0})}])}}angular.module("POS17").controller("suppliersDetailsController",s),s.$inject=["$scope","$http","$stateParams","supplierFctry","toastr","$state","$timeout","tagsFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(r,a){a.state("main.calendars",{url:"/calendars",templateUrl:"modules/calendar/calendar.html",controller:"calendarCtrl"})}])}();
!function(){"use strict";function e(e){$(function(){function r(e){e.each(function(){var e={title:$.trim($(this).text())};$(this).data("eventObject",e)})}r($("#external-events div.external-event"));var e=new Date,t=e.getDate(),o=e.getMonth(),a=e.getFullYear();$("#calendar").fullCalendar({header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},buttonText:{today:"today",month:"month",week:"week",day:"day"},events:[{title:"All Day Event",start:new Date(a,o,1),backgroundColor:"#f56954",borderColor:"#f56954"},{title:"Long Event",start:new Date(a,o,t-5),end:new Date(a,o,t-2),backgroundColor:"#f39c12",borderColor:"#f39c12"},{title:"Meeting",start:new Date(a,o,t,10,30),allDay:!1,backgroundColor:"#0073b7",borderColor:"#0073b7"},{title:"Lunch",start:new Date(a,o,t,12,0),end:new Date(a,o,t,14,0),allDay:!1,backgroundColor:"#00c0ef",borderColor:"#00c0ef"},{title:"Birthday Party",start:new Date(a,o,t+1,19,0),end:new Date(a,o,t+1,22,30),allDay:!1,backgroundColor:"#00a65a",borderColor:"#00a65a"},{title:"Click for Google",start:new Date(a,o,28),end:new Date(a,o,29),url:"http://google.com/",backgroundColor:"#3c8dbc",borderColor:"#3c8dbc"}],editable:!0,droppable:!0,drop:function(e,t){var o=$(this).data("eventObject"),r=$.extend({},o);r.start=e,r.allDay=t,r.backgroundColor=$(this).css("background-color"),r.borderColor=$(this).css("border-color"),$("#calendar").fullCalendar("renderEvent",r,!0),$("#drop-remove").is(":checked")&&$(this).remove()}});var n="#3c8dbc";$("#color-chooser-btn");$("#color-chooser > li > a").click(function(e){e.preventDefault(),n=$(this).css("color"),$("#add-new-event").css({"background-color":n,"border-color":n})}),$("#add-new-event").click(function(e){e.preventDefault();var t=$("#new-event").val();if(0!=t.length){var o=$("<div />");o.css({"background-color":n,"border-color":n,color:"#fff"}).addClass("external-event"),o.html(t),$("#external-events").prepend(o),r(o),$("#new-event").val("")}})})}angular.module("POS17").controller("calendarCtrl",e),e.$inject=["$scope"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(e,r){r.state("main.settings-humanresource",{url:"/settings/humanresource",templateUrl:"modules/humanresource/humanresource.html",controller:"personController"}).state("main.export-humanresource",{url:"/settings/humanresource/exports",templateUrl:"modules/humanresource/humanresource.exports-pdf.html",controller:"personsExportsController"}).state("main.settings-humanresource-detail",{url:"/settings/humanresource/:person_id",templateUrl:"modules/humanresource/humanresource.detail.html",controller:"personDetailController"}).state("main.settings-customergroup",{url:"/settings/customergroup",templateUrl:"modules/humanresource/customer.groups.html",controller:"customerGroupController"})}])}();
!function(){"use strict";function e(o,e,t,i,n,s,l,a,r,c,p,d){console.log("personController"),o.selectDeselectAll=!1,o.applicationStatus="All",o.displayModel="List",o.selectedDatas=[],o.txtSearch={text:""},o.reportFields={person_id:"ID",firstname:"First Name",middlename:"Middle Name",lastname:"Last Name",thumbnail_media:"Thumbnail Media",displayName:"Display Name",mobile:"Mobile No.",email:"Email Address",address:"Address 1",address2:"Address 2",country:"country",city:"City",state:"State",zipcode:"Zip Code",timeZone:"Time Zone",company_id:"Company ID",company_name:"Company Name",company_username:"Company Username",locale:"Locale",tin:"TIN",per_type_id:"Type ID",person_type:"Type",date_start:"Valid From",date_end:"Valid Until",image:"Image Path",image_etag:"Image eTag",image_key:"Image Key",image_mimetype:"Image MimeType",image_originalname:"Image Original Name",image_size:"Image Size",store_id:"Store ID",isActive:"isActive",isActiveAcnt:"isActiveAcnt",isSubscriber:"isSubscriber",date_created:"Date Created",_id:"UUID"};o.personisLoading=!0,o.persons=[],o.personscopy=[],o.personsTable=new c({page:1,count:10,filter:o.txtSearch},{counts:[10,25,50,100],getData:function(n,a){l.getAllPerson().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;o.personscopy=angular.copy(o.persons),_.each(t,function(e){if(_.isNull(e.date_end))e.isActiveAcnt=!0;else{var t=new Date,s=new Date(e.date_end),n=moment(t),a=moment(s),o=moment.duration(n.diff(a)).asDays();e.isActiveAcnt=!(1<=o)}}),a.filter().text&&"All"==o.applicationStatus?o.persons=i("filter")(t,a.filter().text):a.filter().text&&"Active"==o.applicationStatus?(o.persons=_.filter(t,{isActiveAcnt:!0}),o.persons=i("filter")(o.persons,a.filter().text)):a.filter().text&&"Inactive"==o.applicationStatus?(o.persons=_.filter(t,{isActiveAcnt:!1}),o.persons=i("filter")(o.persons,a.filter().text)):_.isEmpty(a.filter().text)&&"All"==o.applicationStatus?o.persons=t:_.isEmpty(a.filter().text)&&"Active"==o.applicationStatus?o.persons=_.filter(t,{isActiveAcnt:!0}):_.isEmpty(a.filter().text)&&"Inactive"==o.applicationStatus?o.persons=_.filter(t,{isActiveAcnt:!1}):o.persons=t,o.persons=_.filter(o.persons,function(e){return"Employee"==e.person_type?e:1==e.isSubscriber?e:void 0}),o.selectedDatas&&0<o.selectedDatas.length&&_.each(o.persons,function(t){_.find(o.selectedDatas,function(e){return e.person_id===t.person_id})&&(t.selected=!0)}),a.total(o.persons.length);var s=o.persons.slice((a.page()-1)*a.count(),a.page()*a.count());n.resolve(s),o.personisLoading=!1}else o.personisLoading=!1,console.log(e.response.msg)})}}),o.refresh=function(){o.personsTable.reload()},o.updateStatus=function(e){o.applicationStatus=e,o.personsTable.reload()},o.searchData=function(){o.personsTable.reload()},o.changeSelectDeselectAll=function(){o.selectDeselectAll=!o.selectDeselectAll,_.each(o.persons,function(e){e.selected=o.selectDeselectAll,o.deleteSomeData=o.selectDeselectAll,o.checkDataChanges(e)})},o.checkDataChanges=function(t){t.selected?_.find(o.selectedDatas,function(e){return e.person_id===t.person_id})||o.selectedDatas.push(t):o.selectedDatas=_.filter(o.selectedDatas,function(e){return e.person_id!==t.person_id}),o.deleteSomeData=0<o.selectedDatas.length},o.toggleModal=function(e){s.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:o,className:"ngdialog-theme-default"}).then(function(){l.deletePersonel(e).then(function(e){200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),n.reload()):a.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},o.deleteSelected=function(){s.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:o,className:"ngdialog-theme-default"}).then(function(){var s=0;async.each(o.selectedDatas,function(e,t){e.selected&&(console.log("person: ",e),l.deletePersonel(e.person_id).then(function(e){console.log("data: ",e.response),200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),++s==o.selectedDatas.length&&n.reload(),t()):a.error(e.response.msg,"Error")}))})})}}angular.module("POS17").controller("personController",e),e.$inject=["$scope","$rootScope","$http","$filter","$state","ngDialog","humanFactory","toastr","$timeout","ngTableParams","localStorageService","transLogFctry"]}();
!function(){"use strict";function t(a,t,e){console.log("personsExportsController"),a.currentDate=Date.now(),a.persons=[],a.IsExport=!1,t.getAllPerson().then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;e=_.filter(e,function(t){return"Employee"==t.person_type?t:1==t.isSubscriber?t:void 0}),_.isEmpty(e)||(a.persons=e)}else console.log(t.response.msg)}),a.myFunction=function(){a.IsExport=!0,angular.element(document).ready(function(){e(function(){console.log("basic-table"),$("#basic-table").trigger("footable_redraw")},1e3)})},a.export=function(){var t=Date.now()+"Staffs.pdf",o="{total_pages_count_string}",n=new jsPDF({orientation:"landscape",format:"a4"}),e=document.getElementById("basic-table"),s=n.autoTableHtmlToJson(e);n.autoTable(s.columns,s.data,{addPageContent:function(t){n.setFontSize(20),n.setTextColor(40),n.setFontStyle("normal"),n.text("Staffs --- Date: "+moment(a.currentDate).format("MM/DD/YYYY hh:mm a"),t.settings.margin.left,15);var e="Page "+t.pageCount;"function"==typeof n.putTotalPages&&(e=e+" of "+o),n.setFontSize(10),n.text(e,t.settings.margin.left,n.internal.pageSize.height-5)},startY:20,margin:{top:30},styles:{overflow:"linebreak",columnWidth:"wrap"},columnStyles:{0:{columnWidth:60},1:{columnWidth:50},2:{columnWidth:40},3:{columnWidth:100},4:{columnWidth:30}}}),"function"==typeof n.putTotalPages&&n.putTotalPages(o),n.save(t)}}angular.module("POS17").controller("personsExportsController",t),t.$inject=["$scope","humanFactory","$timeout"]}();
!function(){"use strict";function e(a,n,t,e,s,r,o,i,u,l,c){a.stores=[],a.persons=[],a.details={},a.enableEndTerm=!1,a.newImage=!1;var d=JSON.parse(l.get("user"));t.article_id?c.logTransaction("View Staff Details","STAFF MANAGEMENT",t.person_id,"User:="+d.username+" View staff details:="+t.person_id):c.logTransaction("Add New Staff","STAFF MANAGEMENT","N/A","User:="+d.username+" Add new staff entry"),e.getPersonType().then(function(e){200==e.statusCode&&e.response.success&&(a.persons=e.response.result)}),s.getAllCountries().then(function(e){200==e.statusCode&&e.response.success&&(a.countries=e.response.result)}),e.getTimeZone().then(function(e){200==e.statusCode&&e.response.success&&(a.timezone=e.response.result)}),t.person_id&&e.getAllPersonDetail(t.person_id).then(function(e){if(200==e.statusCode&&e.response.success)if(a.details=e.response.result,a.details.isActive=1==a.details.isActive,a.details.person_img=a.details.image,_.isNull(a.details.date_end))a.details.isActiveAcnt=!0;else{var s=new Date,n=new Date(a.details.date_end),t=moment(s),r=moment(n),o=moment.duration(t.diff(r)).asDays();a.details.isActiveAcnt=!(1<=o)}}),a.$watch("enableEndTerm",function(e){a.details.date_end=1==e?new Date:null}),a.changeType=function(e){console.log("name:",e)},a.removethumb=function(){a.details.image=null,a.newImage=!1},a.upload=function(e){a.newImage=!0},a.savePersonel=function(){async.waterfall([function(s){t.person_id?e.updatePersonel(t.person_id,a.details).then(function(e){if(200==e.statusCode&&e.response.success)u.success(e.response.msg,"Success"),s(null,t.person_id);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void u.error(e.response.msg,"Error");_.each(e.response.result,function(e){u.warning(e.msg,"Warning")})}}):e.savePersonel(a.details).then(function(e){if(200==e.statusCode&&e.response.success)u.success(e.response.msg,"Success"),s(null,e.response.result);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void u.error(e.response.msg,"Error");_.each(e.response.result,function(e){u.warning(e.msg,"Warning")})}})},function(s,n){a.newImage&&a.details.image?r.upload({url:o+i+"persons/"+s+"/upload-image",data:{person_img:a.details.image},method:"PUT"}).then(function(e){if(200===e.data.statusCode&&e.data.response.success)u.success("Image successfully uploaded","Success"),n(null,s);else{if(400!==e.data.statusCode||e.data.response.success||!_.isArray(e.data.response.result))return void u.error(e.data.response.msg,"Error");_.each(e.data.response.result,function(e){u.warning(e.msg,"Warning")})}},function(e){console.log("Error status: "+e.status)},function(e){parseInt(100*e.loaded/e.total)}):n(null,s)},function(e,s){console.log("personel: ",e),n.go(n.current,{person_id:e},{reload:!0})}])}}angular.module("POS17").controller("personDetailController",e),e.$inject=["$scope","$state","$stateParams","humanFactory","countryFactory","Upload","API_URL","API_VERSION","toastr","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(r,e,t,c,o,s,n,l,a,u,i,d){r.selectDeselectAll=!1,r.selectedDatas=[],r.txtSearch2={text:""};var g=JSON.parse(i.get("user"));d.logTransaction("View Customer Groups","CUSTOMER GROUPS","ALL","User:="+g.username+" View all list of customer groups");r.groups=[],r.groupscopy=[],r.attributeGroupTable=new u({page:1,count:10,filter:r.txtSearch2},{counts:[10,25,50,100],getData:function(o,l){n.getCustomerGroup().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;r.groupscopy=angular.copy(e.response.result),l.filter().text?r.groups=c("filter")(t,l.filter().text):r.groups=t,r.selectedDatas&&0<r.selectedDatas.length&&_.each(r.groups,function(t){_.find(r.selectedDatas,function(e){return e.cg_id===t.cg_id})&&(t.selected=!0)}),l.total(r.groups.length);var s=r.groups.slice((l.page()-1)*l.count(),l.page()*l.count());r.personisLoading=!1,o.resolve(s)}else r.personisLoading=!1,console.log(e.response.msg)})}}),r.refresh=function(){console.log("refresh"),r.attributeGroupTable.reload()},r.searchData=function(){console.log("searchData"),r.attributeGroupTable.reload()},r.changeSelectDeselectAll=function(){r.selectDeselectAll=!r.selectDeselectAll,_.each(r.groups,function(e){e.selected=r.selectDeselectAll,r.deleteSomeData=r.selectDeselectAll,r.checkDataChanges(e)})},r.addGroups=function(e){t.open({animation:!0,templateUrl:"./modules/humanresource/groups/customer.groups.modal.html",controller:"customerGroupModalController",size:"md",resolve:{selected:function(){return e}}}).result.then(function(e){r.selected=e},function(){})},r.checkDataChanges=function(t){t.selected?_.find(r.selectedDatas,function(e){return e.cg_id===t.cg_id})||r.selectedDatas.push(t):r.selectedDatas=_.filter(r.selectedDatas,function(e){return e.cg_id!==t.cg_id}),r.deleteSomeData=0<r.selectedDatas.length},r.toggleModal=function(e){s.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){n.deleteCustomerGroup(e).then(function(e){200==e.statusCode&&e.response.success?(l.success(e.response.msg,"Success"),o.reload()):l.error(e.response.msg,"Error")})},function(){})},r.deleteSelected=function(){s.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){var s=0;async.each(r.selectedDatas,function(e,t){e.selected&&n.deleteCustomerGroup(e.cg_id).then(function(e){200==e.statusCode&&e.response.success?(l.success(e.response.msg,"Success"),++s==r.selectedDatas.length&&o.reload(),t()):l.error(e.response.msg,"Error")})})})}}angular.module("POS17").controller("customerGroupController",e),e.$inject=["$scope","$rootScope","$uibModal","$filter","$state","ngDialog","humanFactory","toastr","$timeout","ngTableParams","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(s,t,e,r,o,n,a){s.selectedStores=[],s.originalSelected=[],s.selectDeselectAll=!1,s.applicationStatus="",s.getAllStore=function(){s.stores=[],s.storesCopy=[],async.waterfall([function(t){n.getAllStore().then(function(e){200==e.statusCode&&e.response.success?(s.stores=e.response.result,s.storesCopy=angular.copy(s.stores),t(null,s.stores)):console.log(e.response.msg)})},function(t,e){a.person_id?o.getAssignedStorePerson(a.person_id).then(function(e){200==e.statusCode&&e.response.success&&0<e.response.result.length?(s.prodStore=e.response.result,_.each(s.storesCopy,function(t){_.find(s.prodStore,function(e){return t.store_id===e.store_id})&&(t.selected=!0,s.selectedStores.push(t),s.originalSelected=angular.copy(s.selectedStores))}),s.itemArray=angular.copy(s.storesCopy)):200==e.statusCode&&e.response.success&&0===e.response.result.length?s.itemArray=angular.copy(t):console.log(e.response.msg)}):s.itemArray=angular.copy(t)}])},s.getAllStore(),s.paginate=function(){$("#tblStore").trigger("footable_redraw")},s.updateStatus=function(e){""===(s.applicationStatus=e)?s.itemArray=angular.copy(s.storesCopy):(s.itemArray.splice(0,s.itemArray.length),_.each(s.storesCopy,function(t){_.find(s.selectedStores,function(e){return t.store_id===e.store_id})&&s.itemArray.push(t)}))},s.searchStore=function(){if(s.txtSearch){s.itemArray.splice(0,s.itemArray.length);var e=t("filter")(s.storesCopy,s.txtSearch);s.itemArray=angular.copy(e)}},s.searchStatus=function(){""===s.txtSearch&&(s.itemArray.splice(0,s.itemArray.length),s.itemArray=angular.copy(s.storesCopy))},s.changeSelectDeselectAll=function(){_.each(s.itemArray,function(e){e.selected=s.selectDeselectAll,s.checkStoresChanges(e)})},s.checkStoresChanges=function(t){t.selected?_.find(s.selectedStores,function(e){return e.store_id===t.store_id})||s.selectedStores.push(t):s.selectedStores=_.filter(s.selectedStores,function(e){return e.store_id!==t.store_id})},s.refresh=function(){s.storeTable.reload()},s.saveStore=function(e){a.person_id?(s.params={oldparams:s.originalSelected,newparams:s.selectedStores},o.assignedStorePerson(a.person_id,s.params).then(function(e){200===e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),s.storeTable.reload(),s.originalSelected=angular.copy(s.selectedStores)):r.error(e.response.msg,"Error")})):r.warning("WARNING: Unable to save.. no available products","WARNING")}}angular.module("POS17").controller("perStotreController",e),e.$inject=["$scope","$filter","$state","toastr","personFctry","storeFactory","$stateParams"]}();
!function(){"use strict";function e(o,e,s,r,t,n,c,a,u,l,i,p,g,d){o.groups=[],o.groupsCopy=[],o.selectDeselectAll=!1,o.selectedDatas=[];var f=JSON.parse(d.get("user"));g.logTransaction("View Customer Groupings","CUSTOMER GROUPINGS","ALL","User:="+f.username+" View all list of customer groupings"),o.refreshData=function(){console.log("refreshData"),async.waterfall([function(t){o.groups=[],o.groupsCopy=[],a.getCustomerGroup().then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;o.groups=s,t(null,s)}})},function(e,s){l.person_id&&c.getCustomerGroup(l.person_id).then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;_.each(o.groups,function(e){_.find(s,{customer_group_id:e.cg_id})?(e.selected=!0,o.checkDataChanges(e)):e.selected=!1}),o.groupsCopy=[],o.groupsCopy=angular.copy(o.groups)}})}])},o.refreshData(),o.addGroups=function(e){p.open({animation:!0,templateUrl:"./modules/humanresource/groups/customer.groups.modal.html",controller:"customerGroupModalController",size:"md",resolve:{selected:function(){return e}}}).result.then(function(e){o.refreshData()})},o.searchData=function(){o.txtSearch?o.groups=s("filter")(o.groupsCopy,o.txtSearch):o.groups=o.groupsCopy},o.changeSelectDeselectAll=function(){_.each(o.groups,function(e){e.selected=o.selectDeselectAll,o.deleteSomeData=o.selectDeselectAll,o.checkDataChanges(e)})},o.checkDataChanges=function(s){s.selected?_.find(o.selectedDatas,function(e){return e.cg_id===s.cg_id})||o.selectedDatas.push(s):o.selectedDatas=_.filter(o.selectedDatas,function(e){return e.cg_id!==s.cg_id}),o.deleteSomeData=0<o.selectedDatas.length},o.saveCustomerGrouping=function(){if(l.person_id){if(!(0<o.selectedDatas.length))return void n.warning("Please select groups for customer grouping","WARNING");console.log("$scope.selectedDatas",o.selectedDatas),async.waterfall([function(s){c.deleteCustomerGroup(l.person_id).then(function(e){200==e.statusCode&&e.response.success&&s(null,l.person_id)})},function(e,s){var t=0;async.each(o.selectedDatas,function(e,s){e.selected&&c.saveCustomerGroup(l.person_id,{customer_group_id:e.cg_id}).then(function(e){200==e.statusCode&&e.response.success?(n.success(e.response.msg,"Success"),++t==o.selectedDatas.length&&r.reload(),s()):n.error(e.response.msg,"Error")})})}])}}}angular.module("POS17").controller("customerGroupingsController",e),e.$inject=["$scope","$http","$filter","$state","$timeout","toastr","companyFactory","humanFactory","ngDialog","$stateParams","countryFactory","$uibModal","transLogFctry","localStorageService"]}();
!function(){"use strict";function s(e,r,o,s,t,n,c,u){console.log("selected:",n),e.details=n,e.stores=[],e.tagsArr=[],u.getAllStore().then(function(s){200==s.statusCode&&s.response.success&&(e.stores=s.response.result)}),e.saveGroup=function(){n?c.updateCustomerGroup(n.cg_id,e.details).then(function(s){if(200!=s.statusCode||!s.response.success)return 400===s.statusCode&&!s.response.success&&_.isArray(s.response.result)?void _.each(s.response.result,function(s){t.warning(s.msg,"Warning")}):void t.error(s.response.msg,"Error");t.success(s.response.msg,"Success"),o.dismiss("cancel"),r.reload()}):c.saveCustomerGroup(e.details).then(function(s){if(200!=s.statusCode||!s.response.success)return 400===s.statusCode&&!s.response.success&&_.isArray(s.response.result)?void _.each(s.response.result,function(s){t.warning(s.msg,"Warning")}):void t.error(s.response.msg,"Error");t.success(s.response.msg,"Success"),o.dismiss("cancel"),r.reload()})},e.cancel=function(){o.dismiss("cancel")}}angular.module("POS17").controller("customerGroupModalController",s),s.$inject=["$scope","$state","$uibModalInstance","$timeout","toastr","selected","humanFactory","storeFactory"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(s,e){e.state("main.settings-useraccounts",{url:"/settings/useraccounts",templateUrl:"modules/useraccess/useraccess.html",controller:"useraccountsCtrl"}).state("main.settings-permissions",{url:"/settings/permissions/:groupId",templateUrl:"modules/useraccess/permission.html",controller:"permissionCtrl"})}])}();
!function(){"use strict";function e(u,s,t,r,o,n,c,l,i,e,a,p){u.selectDeselectAll=!1,u.selectDeselectAll2=!1,u.usergroups=[],u.selectedUsers=[],u.selectedGroups=[];var f=JSON.parse(e.get("user"));a.logTransaction("View User Accounts","USER ACCOUNTS","ALL","User:="+f.username+" View all list of user accounts"),u.changeSelectDeselectAll=function(){u.selectDeselectAll=!u.selectDeselectAll,_.each(u.users,function(e){e.selected=u.selectDeselectAll})},u.showUserRoles=function(s){u.useraccountRoles=_.map(u.usergroups,function(e){return e.role_id==s})},u.initialize=function(){async.waterfall([function(n){u.usersGroupTable=new i({page:1,count:10},{counts:[10,25,50,100],getData:function(r,o){l.getAllUserGroups().then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;u.usersgroupcopy=angular.copy(e.response.result),u.txtSearch?u.usergroups=p("filter")(s,u.txtSearch):u.usergroups=s,u.selectedDatas&&0<u.selectedDatas.length&&_.each(u.usergroups,function(s){_.find(u.selectedDatas,function(e){return e.role_id===s.role_id})&&(s.selected=!0)}),o.total(u.usergroups.length);var t=u.usergroups.slice((o.page()-1)*o.count(),o.page()*o.count());r.resolve(t),n(null,t)}else console.log(e.response.msg),n(null,"error")})}})},function(e,n){u.usersTable=new i({page:1,count:10},{counts:[10,25,50,100],getData:function(r,o){c.getAllUserAccounts().then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;_.each(s,function(e){e.role_id&&(e.userRoles=_.map(e.role_id.split(","),function(s){return _.find(u.usersgroupcopy,function(e){return e.role_id==s})}))}),u.txtSearch2?u.users=p("filter")(s,u.txtSearch2):u.users=s,u.selectedDatas&&0<u.selectedDatas.length&&_.each(u.users,function(s){_.find(u.selectedDatas,function(e){return e.uc_id===s.uc_id})&&(s.selected=!0)}),o.total(u.users.length);var t=u.users.slice((o.page()-1)*o.count(),o.page()*o.count());r.resolve(t)}else console.log(e.response.msg),$activityIndicator.stopAnimating(),n(null,"error")})}})}])},u.initialize(),u.newUserAccount=function(e,s){t.open({animation:!0,templateUrl:"modules/useraccess/users.modal.html",controller:"useraccountCtrl",backdrop:"static",size:"lg",resolve:{user:function(){return{userID:e,person_id:s}}}}).result.then(function(){console.log("modalInstance"),u.initialize()},function(){console.info("Modal dismissed")})},u.mapUserToStore=function(e){t.open({animation:!0,templateUrl:"modules/useraccess/user.store.modal.html",controller:"useraccountStoreCtrl",backdrop:"static",size:"lg",resolve:{user:function(){return{userID:e}}}}).result.then(function(){u.initialize()},function(){console.info("Modal dismissed")})},u.newUserGroup=function(e){t.open({animation:!0,templateUrl:"modules/useraccess/usergroups.modal.html",controller:"usergroupCtrl",backdrop:"static",size:"lg",resolve:{userGroup:function(){return e}}}).result.then(function(e){"save"===e&&u.initialize()},function(){})},u.toggleModal=function(e,s,t){n.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:u,className:"ngdialog-theme-default"}).then(function(){"users"===t?u.removeUser(e):u.removeUserGroup(e)},function(e){})},u.removeUserGroup=function(e){l.deleteUserGroup(e).then(function(e){200==e.statusCode&&e.response.success?(o.success(e.response.msg,"Success"),r(function(){u.initialize()},300)):o.error(e.response.msg,"Error")})},u.removeUser=function(e){c.deleteUserAccount(e).then(function(e){200==e.statusCode&&e.response.success?(o.success(e.response.msg,"Success"),r(function(){u.initialize()},300)):o.error(e.response.msg,"Error")})},u.setUsersSubscription=function(e){t.open({animation:!0,templateUrl:"modules/useraccess/subscription.modal.html",controller:"usersubscriptionCtrl",backdrop:"static",size:"sm",resolve:{user:function(){return e}}}).result.then(function(){s.reload()},function(){})},u.refreshUser=function(){u.usersTable.reload()},u.refreshUserGroup=function(){u.usersGroupTable.reload()},u.searchData=function(){u.usersGroupTable.reload()},u.searchData2=function(){u.usersTable.reload()}}angular.module("POS17").controller("useraccountsCtrl",e),e.$inject=["$scope","$state","$uibModal","$timeout","toastr","ngDialog","useraccountsFctry","usergroupsFctry","ngTableParams","localStorageService","transLogFctry","$filter"]}();
!function(){"use strict";function e(n,r,o,t,u,e,a,s,i,c,l,p,m){n.inputType="password",n.inputType2="password",n.activeTab="info",n.users={},n.emails={},n.users.valid_until=new Date,n.employees=[],n.usergroups=[],n.popup1={opened:!1},n.hashkey=null,n.frontend_host_url=null,n.verifyLink=null,n.showUsername=!1,n.showPassword=!1,n.showRecovery=!1,n.showPIN=!1,u.userID&&u.person_id?l.logTransaction("View User Account Info","USER ACCOUNTS","PERSON:="+u.person_id+" USER:="+u.userID,"User:="+u.username+" View user account information for PERSON:="+u.person_id+" USER:="+u.userID):l.logTransaction("Add New Account Info","USER ACCOUNTS","PERSON:="+u.person_id,"User:="+u.username+" Add new account information for PERSON:="+u.person_id),async.waterfall([function(s){e.getAllEmployees().then(function(e){200==e.statusCode&&e.response.success?(n.employees=e.response.result,n.employees=_.filter(n.employees,function(e){return"Employee"==e.person_type?e:1==e.isSubscriber?e:void 0}),s(null,n.employees)):s(null,"error")})},function(s,r){a.getAllUserGroups().then(function(e){200==e.statusCode&&e.response.success?(n.usergroups=e.response.result,r(null,s,n.usergroups)):r(null,"error")})},function(e,s,r){u.userID&&u.person_id&&t.getUserAccount(u.userID,u.person_id).then(function(e){if(200==e.statusCode&&e.response.success){n.users=e.response.result,n.showUsername=!0,n.showPassword=!0,n.showRecovery=!0,n.showPIN=!0;var s=_.isEmpty(n.users.role_id)?null:n.users.role_id.split(",");n.users.employee=n.users.profile,n.users.role=_.map(s,function(s){return _.find(n.usergroups,function(e){return e.role_id==s})}),n.users.valid_until=new Date(n.users.valid_until),r()}else o.error(e.response.msg,"Error")})},function(s){t.getUserEmailRecovery(u.userID).then(function(e){200==e.statusCode&&e.response.success?(n.users.recovery_email=e.response.result.recovery_email,s()):o.error(e.response.msg,"Error")})},function(s){t.getUserPIN(u.userID).then(function(e){200==e.statusCode&&e.response.success?(n.users.pos_pin=e.response.result.pos_pin,s()):o.error(e.response.msg,"Error")})}]),n.open1=function(){n.popup1.opened=!0},n.hideShowPassword=function(){"password"==n.inputType?n.inputType="text":n.inputType="password"},n.hideShowPassword2=function(){"password"==n.inputType2?n.inputType2="text":n.inputType2="password"},n.generatePassword=function(){var e=t.generatePasswordString(8);n.users.password=e},n.setDefaultUName=function(e){var s=t.generatePasswordString(6);e&&(n.users.username=s.toUpperCase())},n.setActiveTab=function(e){n.activeTab=e},n.saveUser=function(){var s=[];n.users.person_id=n.users.employee.person_id,n.users.role&&0<n.users.role.length?(_.each(n.users.role,function(e){s.push(e.role_id)}),n.users.role_id=s.join()):n.users.role_id="",u&&u.userID?t.updateUserAccount(u.userID,n.users).then(function(e){200==e.statusCode&&e.response.success?(o.success(e.response.msg,"Success"),r.close("save")):400===e.statusCode&&!e.response.success&&_.isArray(e.response.result)?_.each(e.response.result,function(e){o.warning(e.msg,"Warning")}):o.error(e.response.msg,"Error")}):async.waterfall([function(s){t.saveUserAccount(n.users).then(function(e){200==e.statusCode&&e.response.success?(n.hashkey=e.response.result.hashkey,n.frontend_host_url=e.response.result.frontend_host_url,n.verifyLink=n.frontend_host_url+"/#/verify/"+n.hashkey,n.emails=e.response.result,o.success(e.response.msg,"Success"),s()):400===e.statusCode&&!e.response.success&&_.isArray(e.response.result)?_.each(e.response.result,function(e){o.warning(e.msg,"Warning")}):o.error(e.response.msg,"Error")})},function(s){_.isEmpty(n.emails.email)||i(function(){var e={subject:"Symphony Account Email Verification",message:$("#subscriptionEmail").html(),from:"support@symphony.com.ph",email:n.emails.email};p.sendEmail(e).then(function(e){if(200!=e.statusCode||!e.response.success)return 400===e.statusCode&&!e.response.success&&_.isArray(e.response.result)?void _.each(e.response.result,function(e){o.warning(e.msg,"Warning")}):void o.error(e.response.msg,"Error");s()})},1e3)}],function(){r.close("save")})},n.saveUserName=function(){s.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){u&&u.userID&&async.waterfall([function(s){t.updateUserUsername(u.userID,{username:n.users.username,person_id:n.users.profile.person_id}).then(function(e){if(200==e.statusCode&&e.response.success)n.emails={username:e.response.result.username,firstname:e.response.result.firstname,middlename:e.response.result.middlename,lastname:e.response.result.lastname,email:e.response.result.email,frontend_host_url:e.response.result.frontend_host_url},o.success("Successfully Update","Success"),s();else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void o.error(resp.data.response.msg,"Error");_.each(e.response.result,function(e){o.warning(e.msg,"Warning")})}})},function(e){i(function(){var e={subject:"Symphony Username changed",message:$("#usernameEmail").html(),from:"support@symphony.com.ph",email:n.emails.email};p.sendEmail(e).then(function(e){200==e.statusCode&&e.response.success&&i(function(){r.dismiss("cancel"),c.reload()},1e3)})},1e3)}])})},n.saveUserPassword=function(){s.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){if(u&&u.userID){if(n.users.password!==n.users.confirm_password)return void o.warning("Password and Confirm Password do not match");async.waterfall([function(s){t.updateUserPassword(u.userID,{password:n.users.password,confirm_password:n.users.confirm_password,person_id:n.users.profile.person_id}).then(function(e){if(200==e.statusCode&&e.response.success)n.emails={password:e.response.result.password,firstname:e.response.result.firstname,middlename:e.response.result.middlename,lastname:e.response.result.lastname,email:e.response.result.email,frontend_host_url:e.response.result.frontend_host_url},o.success("Successfully Update","Success"),s();else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void o.error(e.response.msg,"Error");_.each(e.response.result,function(e){o.warning(e.msg,"Warning")})}})},function(e){i(function(){var e={subject:"Symphony Password changed",message:$("#passwordEmail").html(),from:"support@symphony.com.ph",email:n.emails.email};p.sendEmail(e).then(function(e){200==e.statusCode&&e.response.success&&i(function(){r.dismiss("cancel"),c.reload()},1e3)})},1e3)}])}})},n.saveUserEmailRecovery=function(){s.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){u&&u.userID&&async.waterfall([function(s){t.updateUserEmailRecovery(u.userID,{email_recovery:n.users.recovery_email,person_id:n.users.employee.person_id}).then(function(e){if(200==e.statusCode&&e.response.success)n.emails={email_recovery:e.response.result.email_recovery,hashkey:e.response.result.hashkey,firstname:e.response.result.firstname,middlename:e.response.result.middlename,lastname:e.response.result.lastname,email:e.response.result.email,frontend_host_url:e.response.result.frontend_host_url},n.hashkey=e.response.result.hashkey,n.frontend_host_url=e.response.result.frontend_host_url,n.verifyLink=n.frontend_host_url+"/#/verify/"+n.hashkey+"/recovery",o.success("Successfully Update","Success"),s();else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void o.error(e.response.msg,"Error");_.each(e.response.result,function(e){o.warning(e.msg,"Warning")})}})},function(e){async.parallel([function(s){i(function(){var e={subject:"Symphony Account Recovery Email Address changed",message:$("#recoveryEmail").html(),from:"support@symphony.com.ph",email:n.emails.email};p.sendEmail(e).then(function(e){200==e.statusCode&&e.response.success&&s()})},1e3)},function(s){i(function(){var e={subject:"Symphony Account Recovery Email Address changed",message:$("#recoveryEmail").html(),from:"support@symphony.com.ph",email:n.emails.email_recovery};p.sendEmail(e).then(function(e){200==e.statusCode&&e.response.success&&s()})},1e3)}],function(){i(function(){c.reload()},1e3)})}])})},n.saveUserPIN=function(){s.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){u&&u.userID&&t.updateUserPIN(u.userID,{pin:n.users.pos_pin}).then(function(e){if(200==e.statusCode&&e.response.success)o.success("Successfully Update","Success"),i(function(){r.dismiss("cancel"),c.reload()},1e3);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void o.error(e.response.msg,"Error");_.each(e.response.result,function(e){o.warning(e.msg,"Warning")})}})})},n.cancelUser=function(){r.dismiss("cancel")}}angular.module("POS17").controller("useraccountCtrl",e),e.$inject=["$scope","$uibModalInstance","toastr","useraccountsFctry","user","personFctry","usergroupsFctry","ngDialog","$timeout","$state","transLogFctry","sharerFactory","$filter"]}();
!function(){"use strict";function s(e,r,s,o,u,n,c){var t=JSON.parse(n.get("user"));_.isUndefined(s)?c.logTransaction("Add New User Group","USER GROUPS","N/A","User:="+t.username+" Add new user group entry"):c.logTransaction("View User Group Details","USER GROUPS",s,"User:="+t.username+" View user group details:="+s),_.isUndefined(s)||u.getUserGroupById(s).then(function(s){200==s.statusCode&&s.response.success?_.isArray(s.response.result)&&(e.usergroup=s.response.result[0],console.log("$scope.usergroup: ",e.usergroup)):o.error(s.response.msg,"Error")}),e.saveUserGroup=function(){_.isUndefined(s)?u.createUserGroup(e.usergroup).then(function(s){200==s.statusCode&&s.response.success?(o.success(s.response.msg,"Success"),r.close("save")):o.error(s.response.msg,"Error")}):u.updateUserGroup(s,e.usergroup).then(function(s){console.log("data: ",s),200==s.statusCode&&s.response.success?(o.success(s.response.msg,"Success"),r.close("save")):o.error(s.response.msg,"Error")})},e.cancelUserGroup=function(){r.dismiss("cancel")}}angular.module("POS17").controller("usergroupCtrl",s),s.$inject=["$scope","$uibModalInstance","userGroup","toastr","usergroupsFctry","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(o,s,e,t,r,i,n,u,l,a){o.permissions=[],o.Groups=[],o.usergroups=[],o.isReset=!0,o.isUpdate=!0;var c=JSON.parse(l.get("user"));e.article_id&&a.logTransaction("View User Group Permission","USER GROUPS",e.groupId,"User:="+c.username+" View user group permission for GROUP:="+e.groupId),_.isUndefined(e.groupId)?(console.log("sadasda"),r.getAllModulesPermissions().then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;0<s.length&&(o.permissions=s,_.each(o.permissions,function(e){e.DefaultReadDisable=!0,e.DefaultWriteDisable=!0,e.DefaultDeleteDisable=!0,e.DefaultPrintDisable=!0}))}})):(console.log("sadasda 111"),async.waterfall([function(n){r.getAllModulesPermissions().then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;0<s.length&&(o.permissions=s),n()}})},function(n){console.log("sadasda"),i.getUserGroupById(e.groupId).then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;s&&0<s.length&&(o.usergroup=e.response.result[0],o.usergroupSelected=e.response.result[0],o.generateAccessPermission(o.usergroup.role_id),n())}else t.error(e.response.msg,"Error")})}])),o.generateAccessPermission=function(e){s(function(){_.isUndefined(e)?o.clear():r.generateAccessPermission(e).then(function(e){if(200==e.statusCode&&e.response.success){o.isUpdate=!1,o.isReset=!1;var n=e.response.result;0<n.length&&_.each(o.permissions,function(e){var s=_.find(n,{mf_id:e.mf_id});s&&(e.DefaultDelete=s.DefaultDelete,e.DefaultPrint=s.DefaultPrint,e.DefaultRead=s.DefaultRead,e.DefaultWrite=s.DefaultWrite)})}})},300)},o.clear=function(){o.isUpdate=!0,o.isReset=!0,o.usergroupSelected=void 0,o.permissions=[],r.getAllModulesPermissions().then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;0<s.length&&(o.permissions=s,_.each(o.permissions,function(e){e.DefaultRead=!1,e.DefaultReadDisable=!0,e.DefaultWrite=!1,e.DefaultWriteDisable=!0,e.DefaultDelete=!1,e.DefaultDeleteDisable=!0,e.DefaultPrint=!1,e.DefaultPrintDisable=!0}))}})},o.reloadData=function(){_.isUndefined(o.usergroup)?o.clear():o.generateAccessPermission(o.usergroup.role_id)},o.resetPermission=function(){n.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:o,className:"ngdialog-theme-default"}).then(function(){async.waterfall([function(s){r.resetGroupPrivilege(o.usergroupSelected.role_id).then(function(e){200==e.statusCode&&e.response.success?(t.success(e.response.msg,"Success"),s()):t.error(e.response.msg,"Error")})},function(e){r.getAllModulesPermissions().then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;0<s.length&&(o.permissions=s)}})}])})},o.UpdatePermission=function(){n.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:o,className:"ngdialog-theme-default"}).then(function(){o.newPermission=angular.copy(o.permissions),console.log("$scope.newPermission: ",o.newPermission),r.setGroupPrivilege(o.usergroupSelected.role_id,o.newPermission).then(function(e){200==e.statusCode&&e.response.success?(t.success(e.response.msg,"Success"),s(function(){u.reload()},1e3)):t.error(e.response.msg,"Error")})})},o.IntToBoolean=function(e){return 1==e},o.BooleanToInt=function(e){return!0===e?1:0},o.myFunction=function(){console.log("myFunction"),s(function(){angular.element(document).ready(function(){$("#myTable").each(function(){var s=null,n=1;$("tbody",this).find("tr").each(function(){var e=$(this).find("td:nth-child(1)");null==s?(s=e,n=1):e.text()==s.text()?(e.remove(),s.attr("rowspan",n+1),n+=1):(s=e,n=1)})})})},100)}}angular.module("POS17").controller("permissionCtrl",e),e.$inject=["$scope","$timeout","$stateParams","toastr","permissionFctry","usergroupsFctry","ngDialog","$state","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(s,e,c,t,n,l){s.selectDeselectAll=!1,s.selectedDatas=[],_.isUndefined(t),s.changeSelectDeselectAll=function(){console.log("usersubscriptionCtrl"),_.each(e.profile.subscriptions,function(e){e.selected=s.selectDeselectAll})},s.saveUser=function(){_.isUndefined(t)},s.cancelUser=function(){c.dismiss("cancel")}}angular.module("POS17").controller("usersubscriptionCtrl",e),e.$inject=["$scope","$rootScope","$uibModalInstance","user","toastr","useraccountsFctry"]}();
!function(){"use strict";function e(r,s,t,o,n,e,c,a,i,l,u,f){r.selectedStores=[],r.originalSelected=[],r.selectDeselectAll=!1,r.getAllStore=function(){r.stores=[],r.storesCopy=[],async.waterfall([function(s){e.getAllStore().then(function(e){200==e.statusCode&&e.response.success?(r.stores=e.response.result,r.storesCopy=angular.copy(r.stores),s(null,r.stores)):console.log(e.response.msg)})},function(t,e){n&&n.userID?o.getUserStores(n.userID).then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result.assigned_stores;_.each(r.storesCopy,function(e){_.find(s,{store_id:e.store_id})&&(e.selected=!0,r.selectedStores.push(e),r.originalSelected=angular.copy(r.selectedStores))}),r.itemArray=angular.copy(r.storesCopy)}else r.itemArray=angular.copy(t)}):r.itemArray=angular.copy(t)}])},r.getAllStore(),r.paginate=function(){$("#tblStore").trigger("footable_redraw")},r.changeSelectDeselectAll=function(){_.each(r.itemArray,function(e){e.selected=r.selectDeselectAll,r.checkStoresChanges(e)})},r.checkStoresChanges=function(s){s.selected?_.find(r.selectedStores,function(e){return e.store_id===s.store_id})||r.selectedStores.push(s):r.selectedStores=_.filter(r.selectedStores,function(e){return e.store_id!==s.store_id})},r.searchStatus=function(){""===r.txtSearch&&(r.itemArray.splice(0,r.itemArray.length),r.itemArray=angular.copy(r.storesCopy))},r.searchStore=function(){if(r.txtSearch){r.itemArray.splice(0,r.itemArray.length);var e=f("filter")(r.storesCopy,r.txtSearch);r.itemArray=angular.copy(e)}},r.refresh=function(){r.storeTable.reload()},r.saveUserMapping=function(){c.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){if(n&&n.userID){if(!(r.selectedStores&&0<r.selectedStores.length))return void t.warning("Please select store to map","Warning");async.waterfall([function(s){o.removeUserToStore(n.userID).then(function(e){if(200==e.statusCode&&e.response.success)t.success(e.response.msg,"Success"),s();else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void t.error(e.response.msg,"Error");_.each(e.response.result,function(e){t.warning(e.msg,"Warning")})}})},function(e){async.eachSeries(r.selectedStores,function(e,s){o.mapUserToStore(n.userID,e.store_id).then(function(e){if(200==e.statusCode&&e.response.success)t.success(e.response.msg,"Success"),s();else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void t.error(e.response.msg,"Error");_.each(e.response.result,function(e){t.warning(e.msg,"Warning")})}})},function(){s.dismiss("cancel")})}])}})},r.cancelUser=function(){s.dismiss("cancel")}}angular.module("POS17").controller("useraccountStoreCtrl",e),e.$inject=["$scope","$uibModalInstance","toastr","useraccountsFctry","user","storeFactory","ngDialog","$timeout","$state","transLogFctry","$stateParams","$filter"]}();
!function(){"use strict";function e(e,s,r,o,n){var t=JSON.parse(o.get("user"));n.logTransaction("View User Profile","USER PROFILE",t.username,"User:="+t.username+" View user profile information")}function s(r,e,s,o,n,t,a,i,l,u,c,p,d,m,f){var g=s.getCurrentUser(),h=JSON.parse(g);r.inputType="password",r.pw1="password",r.user=h,r.details={},r.social={},r.emails={},r.showFacebook=!0,r.showGoogle=!0,r.showTwitter=!0,r.showLinkedin=!0,r.showUpload=!1,r.timezone=[],r.newImage=!1,r.hashkey=null,r.frontend_host_url=null,r.verifyLink=null,m.logTransaction("View User Profile","USER PROFILE",h.username,"User:="+h.username+" View user profile for modification"),h.person_id&&async.waterfall([function(s){t.getAllPersonDetail(h.person_id).then(function(e){200==e.statusCode&e.response.success&&(r.details=e.response.result,s())})},function(s){t.getUserSocial().then(function(e){200==e.statusCode&e.response.success&&(r.social=e.response.result,r.showFacebook=!_.isEmpty(r.social.facebook_uuid),r.showGoogle=!_.isEmpty(r.social.google_uuid),r.showTwitter=!_.isEmpty(r.social.twitter_uuid),r.showLinkedin=!_.isEmpty(r.social.linkedin_uuid),s())})},function(s){t.getUserPIN().then(function(e){200==e.statusCode&e.response.success&&(r.details.pos_pin=e.response.result.pos_pin,s())})}]),t.getTimeZone().then(function(e){200==e.statusCode&&e.response.success&&(r.timezone=e.response.result)}),r.hideShowPassword=function(){"password"==r.inputType?r.inputType="text":r.inputType="password"},r.upload=function(e){console.log("file",e),r.newImage=!0,r.showUpload=!0},r.removethumb=function(){r.showUpload=!1,r.details.image=null,r.newImage=!1},r.savePersonDetail=function(){async.waterfall([function(s){m.logTransaction("Update User Profile","USER PROFILE",JSON.stringify(r.details),"User:="+h.username+" Update user profile"),h.person_id?t.updatePersonel(h.person_id,r.details).then(function(e){if(200==e.statusCode&&e.response.success)a.success(e.response.msg,"Success"),s(null,h.person_id),o.reload();else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void a.error(e.response.msg,"Error");_.each(e.response.result,function(e){a.warning(e.msg,"Warning")})}}):t.savePersonel(r.details).then(function(e){if(200==e.statusCode&&e.response.success)a.success(e.response.msg,"Success"),s(null,e.response.result),o.reload();else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void a.error(e.response.msg,"Error");_.each(e.response.result,function(e){a.warning(e.msg,"Warning")})}})},function(e,s){console.log("user:",e),r.newImage&&r.details.image&&(m.logTransaction("Update User Profile: Image Upload","USER PROFILE",r.details.image,"User:="+h.username+" Update user profile - Upload Image"),i.upload({url:l+u+"persons/"+e+"/upload-image",data:{person_img:r.details.image},method:"PUT"}).then(function(e){if(200===e.data.statusCode&&e.data.response.success)a.success("Image successfully uploaded","Success"),o.reload();else{if(400!==e.data.statusCode||e.data.response.success||!_.isArray(e.data.response.result))return void a.error(e.data.response.msg,"Error");_.each(e.data.response.result,function(e){a.warning(e.msg,"Warning")})}},function(e){console.log("Error status: "+e.status)},function(e){parseInt(100*e.loaded/e.total)}))}])},r.saveUsername=function(){c.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){m.logTransaction("Update User Profile: USERNAME","USER PROFILE",JSON.stringify(e.profile),"User:="+h.username+" Update user profile - USERNAME"),async.waterfall([function(s){t.updateUsername(e.profile).then(function(e){if(200==e.statusCode&&e.response.success)r.emails={username:e.response.result.username,firstname:e.response.result.firstname,middlename:e.response.result.middlename,lastname:e.response.result.lastname,email:e.response.result.email,frontend_host_url:e.response.result.frontend_host_url},a.success("Successfully Update","Success"),s();else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void a.error(e.response.msg,"Error");_.each(e.response.result,function(e){a.warning(e.msg,"Warning")})}})},function(e){n(function(){var e={subject:"Symphony Username changed",message:$("#usernameEmail").html(),from:"support@symphony.com.ph",email:r.emails.email};f.sendEmail(e).then(function(e){200==e.statusCode&&e.response.success&&n(function(){o.reload()},1e3)})},1e3)}])})},r.savePassword=function(){c.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){m.logTransaction("Update User Profile: USER PASSWORD","USER PROFILE",JSON.stringify(r.details),"User:="+h.username+" Update user profile - USER PASSWORD"),async.waterfall([function(s){t.updatePassword(r.details).then(function(e){if(200==e.statusCode&&e.response.success)r.emails={password:e.response.result.password,firstname:e.response.result.firstname,middlename:e.response.result.middlename,lastname:e.response.result.lastname,email:e.response.result.email,frontend_host_url:e.response.result.frontend_host_url},a.success("Successfully Update Password","Success"),s();else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void a.error(e.response.msg,"Error");_.each(e.response.result,function(e){a.warning(e.msg,"Warning")})}})},function(e){n(function(){var e={subject:"Symphony Password changed",message:$("#passwordEmail").html(),from:"support@symphony.com.ph",email:r.emails.email};f.sendEmail(e).then(function(e){200==e.statusCode&&e.response.success&&n(function(){o.reload()},1e3)})},1e3)}])})},r.addRecoveryEmail=function(){c.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){m.logTransaction("Update User Profile: EMAIL RECOVERY","USER PROFILE",r.details.recovery_email,"User:="+h.username+" Update user profile - EMAIL RECOVERY"),async.waterfall([function(s){t.addRecoveryPassword({email_recovery:r.details.recovery_email}).then(function(e){if(200==e.statusCode&&e.response.success)r.emails={email_recovery:e.response.result.email_recovery,hashkey:e.response.result.hashkey,firstname:e.response.result.firstname,middlename:e.response.result.middlename,lastname:e.response.result.lastname,email:e.response.result.email,frontend_host_url:e.response.result.frontend_host_url},r.hashkey=e.response.result.hashkey,r.frontend_host_url=e.response.result.frontend_host_url,r.verifyLink=r.frontend_host_url+"/#/verify/"+r.hashkey+"/recovery",a.success("Successfully Update","Success"),s();else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void a.error(resp.data.response.msg,"Error");_.each(e.response.result,function(e){a.warning(e.msg,"Warning")})}})},function(e){async.parallel([function(s){n(function(){var e={subject:"Symphony Account Recovery Email Address changed",message:$("#recoveryEmail").html(),from:"support@symphony.com.ph",email:r.emails.email};f.sendEmail(e).then(function(e){200==e.statusCode&&e.response.success&&s()})},1e3)},function(s){n(function(){var e={subject:"Symphony Account Recovery Email Address changed",message:$("#recoveryEmail").html(),from:"support@symphony.com.ph",email:r.emails.email_recovery};f.sendEmail(e).then(function(e){200==e.statusCode&&e.response.success&&s()})},1e3)}],function(){n(function(){o.reload()},1e3)})}])})},r.addPOSPIN=function(){c.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){m.logTransaction("Update User Profile: PERSONAL IDENTIFICATION NUMBER","USER PROFILE",r.details.pos_pin,"User:="+h.username+" Update user profile - PERSONAL IDENTIFICATION NUMBER"),t.addUserPIN({pin:r.details.pos_pin}).then(function(e){if(200==e.statusCode&&e.response.success)a.success(e.response.msg,"Success"),n(function(){o.reload()},1e3);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void a.error(e.response.msg,"Error");_.each(e.response.result,function(e){a.warning(e.msg,"Warning")})}})})},r.unlinkAccount=function(s){m.logTransaction("Update User Profile: SOCIAL MEDIA="+s,"USER PROFILE",s,"User:="+h.username+" Update user profile - SOCIAL MEDIA="+s),p.unlink(s,{method:"POST",url:l+"/auth/unlink"}).then(function(e){a.success("You have successfully unlinked "+s+" to your profile!"),n(function(){o.reload()},400)}).catch(function(e){error.message?a.error(error.message):error.data?a.error(error.data.message,error.status):a.error(error)})},r.viewProfile=function(e,s){if(m.logTransaction("View Social Media Profile:="+e,"USER PROFILE",e,"User:="+h.username+" View social media profile:="+e),"facebook"==e)d.open("https://www.facebook.com/app_scoped_user_id/"+s+"/","_blank").focus();else if("google"==e){d.open("https://plus.google.com/"+s,"_blank").focus()}else if("linkedin"==e){d.open("http://www.linkedin.com/profile/view?id="+s,"_blank").focus()}else if("twitter"==e){d.open("https://twitter.com/intent/user?user_id="+s,"_blank").focus()}},r.authenticate=function(s){m.logTransaction("Link Social Media Profile:="+s,"USER PROFILE",s,"User:="+h.username+" Link social media profile:="+s),p.link(s).then(function(e){a.success("You have successfully linked your profile with "+s+"!"),n(function(){o.reload()},400)}).catch(function(e){e.message?a.error(e.message):e.data?a.error(e.data.message,e.status):a.error(e)})},r.init=function(){r.status=!0},r.changeStatus=function(){r.status=!r.status}}angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(e,s){s.state("main.settings-profile",{url:"/settings/profile",templateUrl:"modules/profile/profile.html",controller:"ProfileDetailCtrl"}).state("main.settings-profile-details",{url:"/settings/profile/details/",templateUrl:"modules/profile/profile.details.html",controller:"ProfileDetailCtrl"})}]).controller("ProfileCtrl",e).controller("ProfileDetailCtrl",s),e.$inject=["$scope","$state","AuthFctry","localStorageService","transLogFctry"],s.$inject=["$scope","$rootScope","AuthFctry","$state","$timeout","humanFactory","toastr","Upload","API_URL","API_VERSION","ngDialog","$auth","$window","transLogFctry","sharerFactory"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(r,t){t.state("main.reports-invoice",{url:"/reports/invoice",templateUrl:"modules/reports/invoice.html"}).state("main.reports-dashboard",{url:"/reports/dashboard",templateUrl:"modules/reports/reportdashboard.html",controller:"reportDashboardController"}).state("main.reports-inventory",{url:"/reports/inventory",templateUrl:"modules/reports/inventoryReport.html",controller:"reportDashboardController"}).state("main.reports-sales",{url:"/reports/sales",templateUrl:"modules/reports/salesReport.html",controller:"reportDashboardController"}).state("main.reports-subscription",{url:"/reports/subscription",templateUrl:"modules/reports/subscriptionreports.html",controller:"reportDashboardController"})}])}();
!function(){"use strict";function e(n,e,o,t,a,s,r,l,i,c,u,p){console.log("reportDashboardController.."),n.isloadingGraphs=!1,n.selectedParam1="User",n.selectedParam2="Revenue",n.selectedParam3="Stock On Hand",n.selectedParam4="All Stores",n.data2=[],n.cssPre="",n.storeids="_all_",n.arrOfStores=[],n.prevDay=moment().subtract(1,"days").format("YYYY-MM-DD"),n.currDate=moment().format("YYYY-MM-DD");var d=JSON.parse(a.get("user")),m=moment(),f=moment.tz.guess(),y=moment(m).tz(f).format("Z");n.timezone=y,n.statsOfPrevDay={},n.statsOfCurrDay={},String.prototype.insert=function(e,t){return 0<e?this.substring(0,e)+t+this.substring(e,this.length):t+this},n.date={startDate:moment().subtract(1,"days"),endDate:moment()},n.opts={locale:{applyClass:"btn-green",applyLabel:"Apply",fromLabel:"Start Date:",toLabel:"End Date:",cancelLabel:"Cancel",customRangeLabel:"Custom Range",firstDay:1},ranges:{Today:[moment().subtract("days"),moment()],Yesterday:[moment().subtract(1,"days"),moment()],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()]}},n.filterBy="day",n.sub_id=d.sub_id,n.dateTo=moment().format("YYYY-MM-DD"),n.arg=1,n.filterBy_2="user",n.sub_id_2=d.sub_id,n.rs_dateTo=moment().format("YYYY-MM-DD"),n.rs_dateFrom=moment(n.rs_dateTo).subtract(7,"days").format("YYYY-MM-DD"),n.timezone_2=n.timezone,n.changeOf_revenue_Stat={},n.changeOf_items_sold_Stat={},n.changeOf_customers_Stat={},n.changeOf_discount_Stat={},n.changeOf_discount_percent_Stat={},n.changeOf_basket_value_Stat={},n.changeOf_basket_size_Stat={},n.changeOf_gross_profit_Stat={},n.formatoDouble=function(e){return e&&e!=1/0?p("number")(e,2)+"%":"previous value is 0"},n.checkFiltered=function(){return"day"==n.filterBy?(console.log("checkFiltered : day"),"date"):(console.log("checkFiltered : not day"),"linear")},n.checkKey=function(){return"day"==n.filterBy?(console.log("checkKey : day"),"x"):(console.log("checkKey : not day"),"_label")},n.pickAcolor=function(e){return-1==Math.sign(e)?"red":1==Math.sign(e)?"green":"dark-gray"},n.pickAnArrow=function(e){return-1==Math.sign(e)?"zmdi zmdi-trending-down":1==Math.sign(e)?"zmdi zmdi-trending-up":""},n.layout={autosize:!0,width:300,height:180,xaxis:{title:"",autorange:!0,showgrid:!1,zeroline:!1,showline:!1,autotick:!0,ticks:"",tickfont:{size:10,color:"gray"},nticks:7,showticklabels:!0},yaxis:{title:"",tickfont:{size:10,color:"gray"},autorange:!0,showgrid:!1,zeroline:!1,showline:!1,autotick:!0,ticks:"",showticklabels:!0},margin:{l:50,r:20,t:5,b:50,autoexpand:!0}};var v=moment().startOf("year").format("YYYY-MM-DD");n.getDateFrom=function(){return"day"==n.filterBy?moment(n.dateTo).subtract(7,"days").format("YYYY-MM-DD")<v?v:moment(n.dateTo).subtract(7,"days").format("YYYY-MM-DD"):"week"==n.filterBy?moment(n.dateTo).subtract(49,"days").format("YYYY-MM-DD")<v?v:moment(n.dateTo).subtract(49,"days").format("YYYY-MM-DD"):"month"==n.filterBy?moment(n.dateTo).subtract(212,"days").format("YYYY-MM-DD")<v?v:moment(n.dateTo).subtract(212,"days").format("YYYY-MM-DD"):"year"==n.filterBy?moment(n.dateTo).subtract(2555,"days").format("YYYY-MM-DD")<v?v:moment(n.dateTo).subtract(2555,"days").format("YYYY-MM-DD"):void 0};function g(a){var e=function(e,t){for(var a=moment(e),s=[];a.isBefore(t)||a.isSame(t);)s.push(a.format("YYYY-MM-DD")),a.add("days",1);return s}(n.getDateFrom(),moment(n.dateTo).format("YYYY-MM-DD"));return _.each(e,function(e,t){_.find(a,{transaction_date:e})||(a.success?a.splice(t,0,{transaction_date:e,basket_size:0,basket_value:0,customers:0,discount:0,discount_percent:0,gross_profit:0,items_sold:0,label:moment(e).format("MMM Do"),revenue:0}):console.log("err_msg @function addZeroPaddingToReturnedDates()"))}),a}n.clearStatsValue=function(){n.changeOf_revenue_Stat="",n.changeOf_items_sold_Stat="",n.changeOf_customers_Stat="",n.changeOf_discount_Stat="",n.changeOf_discount_percent_Stat="",n.changeOf_basket_value_Stat="",n.changeOf_basket_size_Stat="",n.changeOf_gross_profit_Stat=""},n.getDashboardReports=function(){n.data1=[],n.isloadingGraphs=!0,n.paramobj={sub_id:n.sub_id,filterBy:n.filterBy,dateFrom:n.getDateFrom(),dateTo:moment(n.dateTo).format("YYYY-MM-DD"),timezone:n.timezone,arg:1},u.getDashboardReport(n.paramobj).then(function(a){n.data1="day"==n.filterBy?g(a.response):a.response,n.getOverall_Revenue=n.data1&&n.data1[a.response.length-1]&&n.data1[a.response.length-1].revenue?n.data1[a.response.length-1].revenue-n.data1[a.response.length-1].discount:null,n.getOverall_Salecount=n.data1&&n.data1[a.response.length-1]&&n.data1[a.response.length-1].items_sold?n.data1[a.response.length-1].items_sold:null,n.getOverall_Customercount=n.data1&&n.data1[a.response.length-1]&&n.data1[a.response.length-1].customers?n.data1[a.response.length-1].customers:null,n.getOverall_Grossprofit=n.data1&&n.data1[a.response.length-1]&&n.data1[a.response.length-1].gross_profit?n.data1[a.response.length-1].gross_profit:null,n.getOverall_Discount=n.data1&&n.data1[a.response.length-1]&&n.data1[a.response.length-1].discount?n.data1[a.response.length-1].discount:null,n.getOverall_Discountpercent=n.data1&&n.data1[a.response.length-1]&&n.data1[a.response.length-1].discount_percent?n.data1[a.response.length-1].discount_percent:null,n.getOverall_Basketsize=n.data1&&n.data1[a.response.length-1]&&n.data1[a.response.length-1].basket_size?n.data1[a.response.length-1].basket_size:null,n.getOverall_Basketvalue=n.data1&&n.data1[a.response.length-1]&&n.data1[a.response.length-1].basket_value?n.data1[a.response.length-1].basket_value:null,_.each(n.data1,function(e,t){n.trace1.x.push(e.label),n.trace1.y.push(e.revenue?e.revenue:0),n.trace2.x.push(e.label),n.trace2.y.push(e.gross_profit?e.gross_profit:0),n.trace3.x.push(e.label),n.trace3.y.push(e.items_sold?e.items_sold:0),n.trace4.x.push(e.label),n.trace4.y.push(e.customers?e.customers:0),n.trace5.x.push(e.label),n.trace5.y.push(e.basket_size?e.basket_size:0),n.trace6.x.push(e.label),n.trace6.y.push(e.basket_value?e.basket_value:0),n.trace7.x.push(e.label),n.trace7.y.push(e.discount?e.discount:0),n.trace8.x.push(e.label),n.trace8.y.push(e.discount_percent?e.discount_percent:0),"day"==n.filterBy?e&&e.transaction_date&&n.data1[a.response.length-2]&&n.data1[a.response.length-2].transaction_date&&n.data1[a.response.length-1]&&n.data1[a.response.length-1].transaction_date&&(moment(e.transaction_date).format("YYYY-MM-DD")==n.data1[a.response.length-2].transaction_date&&(e.prev_revenue_Stat=e.revenue,e.prev_items_sold_Stat=e.items_sold,e.prev_customers_Stat=e.customers,e.prev_discount_Stat=e.discount,e.prev_discount_percent_Stat=e.discount_percent,e.prev_basket_value_Stat=e.basket_value,e.prev_basket_size_Stat=e.basket_size,e.prev_gross_profit_Stat=e.gross_profit,n.statsOfPrevDay=e),moment(e.transaction_date).format("YYYY-MM-DD")==n.data1[a.response.length-1].transaction_date&&(e.prev_revenue_Stat=n.statsOfPrevDay.revenue,e.prev_items_sold_Stat=n.statsOfPrevDay.items_sold,e.prev_customers_Stat=n.statsOfPrevDay.customers,e.prev_discount_Stat=n.statsOfPrevDay.discount,e.prev_discount_percent_Stat=n.statsOfPrevDay.discount_percent,e.prev_basket_value_Stat=n.statsOfPrevDay.basket_value,e.prev_basket_size_Stat=n.statsOfPrevDay.basket_size,e.prev_gross_profit_Stat=n.statsOfPrevDay.gross_profit,n.changeOf_revenue_Stat=(e.revenue-e.prev_revenue_Stat)/e.prev_revenue_Stat*100,n.changeOf_items_sold_Stat=(e.items_sold-e.prev_items_sold_Stat)/e.prev_items_sold_Stat*100,n.changeOf_customers_Stat=(e.customers-e.prev_customers_Stat)/e.prev_customers_Stat*100,n.changeOf_discount_Stat=(e.discount-e.prev_discount_Stat)/e.prev_discount_Stat*100,n.changeOf_discount_percent_Stat=(e.discount_percent-e.prev_discount_percent_Stat)/e.prev_discount_percent_Stat*100,n.changeOf_basket_value_Stat=(e.basket_value-e.prev_basket_value_Stat)/e.prev_basket_value_Stat*100,n.changeOf_basket_size_Stat=(e.basket_size-e.prev_basket_size_Stat)/e.prev_basket_size_Stat*100,n.changeOf_gross_profit_Stat=(e.gross_profit-e.prev_gross_profit_Stat)/e.prev_gross_profit_Stat*100)):"week"==n.filterBy?e&&e.transaction_week&&n.data1[a.response.length-2]&&n.data1[a.response.length-2].transaction_week&&n.data1[a.response.length-1]&&n.data1[a.response.length-1].transaction_week&&(e.transaction_week==n.data1[a.response.length-2].transaction_week&&(e.prev_revenue_Stat=e.revenue,e.prev_items_sold_Stat=e.items_sold,e.prev_customers_Stat=e.customers,e.prev_discount_Stat=e.discount,e.prev_discount_percent_Stat=e.discount_percent,e.prev_basket_value_Stat=e.basket_value,e.prev_basket_size_Stat=e.basket_size,e.prev_gross_profit_Stat=e.gross_profit,n.statsOfPrevDay=e),e.transaction_week==n.data1[a.response.length-1].transaction_week&&(e.prev_revenue_Stat=n.statsOfPrevDay.revenue,e.prev_items_sold_Stat=n.statsOfPrevDay.items_sold,e.prev_customers_Stat=n.statsOfPrevDay.customers,e.prev_discount_Stat=n.statsOfPrevDay.discount,e.prev_discount_percent_Stat=n.statsOfPrevDay.discount_percent,e.prev_basket_value_Stat=n.statsOfPrevDay.basket_value,e.prev_basket_size_Stat=n.statsOfPrevDay.basket_size,e.prev_gross_profit_Stat=n.statsOfPrevDay.gross_profit,n.changeOf_revenue_Stat=(e.revenue-e.prev_revenue_Stat)/e.prev_revenue_Stat*100,n.changeOf_items_sold_Stat=(e.items_sold-e.prev_items_sold_Stat)/e.prev_items_sold_Stat*100,n.changeOf_customers_Stat=(e.customers-e.prev_customers_Stat)/e.prev_customers_Stat*100,n.changeOf_discount_Stat=(e.discount-e.prev_discount_Stat)/e.prev_discount_Stat*100,n.changeOf_discount_percent_Stat=(e.discount_percent-e.prev_discount_percent_Stat)/e.prev_discount_percent_Stat*100,n.changeOf_basket_value_Stat=(e.basket_value-e.prev_basket_value_Stat)/e.prev_basket_value_Stat*100,n.changeOf_basket_size_Stat=(e.basket_size-e.prev_basket_size_Stat)/e.prev_basket_size_Stat*100,n.changeOf_gross_profit_Stat=(e.gross_profit-e.prev_gross_profit_Stat)/e.prev_gross_profit_Stat*100)):"month"==n.filterBy?e&&e.transaction_month&&n.data1[a.response.length-2]&&n.data1[a.response.length-2].transaction_month&&n.data1[a.response.length-1]&&n.data1[a.response.length-1].transaction_month&&(e.transaction_month==n.data1[a.response.length-2].transaction_month&&(e.prev_revenue_Stat=e.revenue,e.prev_items_sold_Stat=e.items_sold,e.prev_customers_Stat=e.customers,e.prev_discount_Stat=e.discount,e.prev_discount_percent_Stat=e.discount_percent,e.prev_basket_value_Stat=e.basket_value,e.prev_basket_size_Stat=e.basket_size,e.prev_gross_profit_Stat=e.gross_profit,n.statsOfPrevDay=e),e.transaction_month==n.data1[a.response.length-1].transaction_month&&(e.prev_revenue_Stat=n.statsOfPrevDay.revenue,e.prev_items_sold_Stat=n.statsOfPrevDay.items_sold,e.prev_customers_Stat=n.statsOfPrevDay.customers,e.prev_discount_Stat=n.statsOfPrevDay.discount,e.prev_discount_percent_Stat=n.statsOfPrevDay.discount_percent,e.prev_basket_value_Stat=n.statsOfPrevDay.basket_value,e.prev_basket_size_Stat=n.statsOfPrevDay.basket_size,e.prev_gross_profit_Stat=n.statsOfPrevDay.gross_profit,n.changeOf_revenue_Stat=(e.revenue-e.prev_revenue_Stat)/e.prev_revenue_Stat*100,n.changeOf_items_sold_Stat=(e.items_sold-e.prev_items_sold_Stat)/e.prev_items_sold_Stat*100,n.changeOf_customers_Stat=(e.customers-e.prev_customers_Stat)/e.prev_customers_Stat*100,n.changeOf_discount_Stat=(e.discount-e.prev_discount_Stat)/e.prev_discount_Stat*100,n.changeOf_discount_percent_Stat=(e.discount_percent-e.prev_discount_percent_Stat)/e.prev_discount_percent_Stat*100,n.changeOf_basket_value_Stat=(e.basket_value-e.prev_basket_value_Stat)/e.prev_basket_value_Stat*100,n.changeOf_basket_size_Stat=(e.basket_size-e.prev_basket_size_Stat)/e.prev_basket_size_Stat*100,n.changeOf_gross_profit_Stat=(e.gross_profit-e.prev_gross_profit_Stat)/e.prev_gross_profit_Stat*100)):"year"==n.filterBy&&e&&e.transaction_year&&n.data1[a.response.length-2]&&n.data1[a.response.length-2].transaction_year&&n.data1[a.response.length-1]&&n.data1[a.response.length-1].transaction_year&&(e.transaction_year==n.data1[a.response.length-2].transaction_year&&(e.prev_revenue_Stat=e.revenue,e.prev_items_sold_Stat=e.items_sold,e.prev_customers_Stat=e.customers,e.prev_discount_Stat=e.discount,e.prev_discount_percent_Stat=e.discount_percent,e.prev_basket_value_Stat=e.basket_value,e.prev_basket_size_Stat=e.basket_size,e.prev_gross_profit_Stat=e.gross_profit,n.statsOfPrevDay=e),e.transaction_year==n.data1[a.response.length-1].transaction_year&&(e.prev_revenue_Stat=n.statsOfPrevDay.revenue,e.prev_items_sold_Stat=n.statsOfPrevDay.items_sold,e.prev_customers_Stat=n.statsOfPrevDay.customers,e.prev_discount_Stat=n.statsOfPrevDay.discount,e.prev_discount_percent_Stat=n.statsOfPrevDay.discount_percent,e.prev_basket_value_Stat=n.statsOfPrevDay.basket_value,e.prev_basket_size_Stat=n.statsOfPrevDay.basket_size,e.prev_gross_profit_Stat=n.statsOfPrevDay.gross_profit,n.changeOf_revenue_Stat=(e.revenue-e.prev_revenue_Stat)/e.prev_revenue_Stat*100,n.changeOf_items_sold_Stat=(e.items_sold-e.prev_items_sold_Stat)/e.prev_items_sold_Stat*100,n.changeOf_customers_Stat=(e.customers-e.prev_customers_Stat)/e.prev_customers_Stat*100,n.changeOf_discount_Stat=(e.discount-e.prev_discount_Stat)/e.prev_discount_Stat*100,n.changeOf_discount_percent_Stat=(e.discount_percent-e.prev_discount_percent_Stat)/e.prev_discount_percent_Stat*100,n.changeOf_basket_value_Stat=(e.basket_value-e.prev_basket_value_Stat)/e.prev_basket_value_Stat*100,n.changeOf_basket_size_Stat=(e.basket_size-e.prev_basket_size_Stat)/e.prev_basket_size_Stat*100,n.changeOf_gross_profit_Stat=(e.gross_profit-e.prev_gross_profit_Stat)/e.prev_gross_profit_Stat*100))}),"main.reports-dashboard"==o.current.name&&(n.isloadingGraphs=!1,n.t1_data=[n.trace1],Plotly.newPlot("myDiv1",n.t1_data,n.layout),n.t2_data=[n.trace2],Plotly.newPlot("myDiv2",n.t2_data,n.layout),n.t3_data=[n.trace3],Plotly.newPlot("myDiv3",n.t3_data,n.layout),n.t4_data=[n.trace4],Plotly.newPlot("myDiv4",n.t4_data,n.layout),n.t5_data=[n.trace5],Plotly.newPlot("myDiv5",n.t5_data,n.layout),n.t6_data=[n.trace6],Plotly.newPlot("myDiv6",n.t6_data,n.layout),n.t7_data=[n.trace7],Plotly.newPlot("myDiv7",n.t7_data,n.layout),n.t8_data=[n.trace8],Plotly.newPlot("myDiv8",n.t8_data,n.layout),n.loadSummaryReports())})},n.getDashboardReportsByStore=function(){n.paramobj={sub_id:n.sub_id,filterBy:n.filterBy,dateFrom:n.getDateFrom(),dateTo:moment(n.dateTo).format("YYYY-MM-DD"),timezone:n.timezone,arg:2},u.getDashboardReport(n.paramobj).then(function(e){n.data2=e.response,n.getOverall_Revenue_byStore=_.sumBy(n.data2,"revenue"),n.getOverall_Salecount_byStore=_.sumBy(n.data2,"items_sold"),n.getOverall_Customercount_byStore=_.sumBy(n.data2,"customers"),n.getOverall_Grossprofit_byStore=_.sumBy(n.data2,"gross_profit"),n.getOverall_Discount_byStore=_.sumBy(n.data2,"discount"),n.getOverall_Discountpercent_byStore=_.sumBy(n.data2,"discount_percent"),n.getOverall_Basketsize_byStore=_.sumBy(n.data2,"basket_size"),n.getOverall_Basketvalue_byStore=_.sumBy(n.data2,"basket_value"),_.each(n.data2,function(e,t){e.percent_revenue_by_store=e.revenue/n.getOverall_Revenue_byStore*100,e.percent_items_sold_by_store=e.items_sold/n.getOverall_Salecount_byStore*100,e.percent_customers_by_store=e.customers/n.getOverall_Customercount_byStore*100,e.percent_gross_profit_by_store=e.gross_profit/n.getOverall_Grossprofit_byStore*100,e.percent_discount_by_store=e.discount/n.getOverall_Discount_byStore*100,e.percent_discount_percent_by_store=e.discount_percent/n.getOverall_Discountpercent_byStore*100,e.percent_basket_size_by_store=e.basket_size/n.getOverall_Basketsize_byStore*100,e.percent_basket_value_by_store=e.basket_value/n.getOverall_Basketvalue_byStore*100})})},n.getDashboardSalesReports=function(a){n.paramobj2={sub_id:n.sub_id_2,filterBy:a,dateFrom:moment(n.rs_dateFrom).format("YYYY-MM-DD"),dateTo:moment(n.dateTo).format("YYYY-MM-DD"),timezone:n.timezone_2,store_id:n.storeids,arg:1},u.getDashboardSalesAndInventoryReport(n.paramobj2).then(function(e){if(e.success){n.arrOfStores=[];var t=_.groupBy(e.response,"store_id");switch(_.each(t,function(e,t){var a={store_id:e[0].store_id,store_name:e[0].store_name};n.arrOfStores.push(a)}),a){case"product":n.productPerformance(e.response),n.productSalesByDate(e.response);break;case"customer":_.each(e.response,function(e,t){});break;case"user":n.getsatbsp_div(e.response),n.calculateUserStats(e.response);break;default:console.log("case not defined, return nothing")}}else console.log("err_msg @function getDashboardSalesReports()",e)})},n.getDashboardInventoryReports=function(){n.selectedParam3="Stock on hand",n.paramobj2={sub_id:n.sub_id_2,arg:2,filterBy:"on hand"},u.getDashboardSalesAndInventoryReport(n.paramobj2).then(function(e){n.invProducts=_.filter(e.response,function(e){return"on hand"==e.stock_status})})},n._getAllProductsUnFiltered=function(){r.getProductAndVariants({isExportAction:!0}).then(function(e){n.tmpA=_.filter(e.response.result.result,function(e){return null!=e.inventory_id}),n.tmpB=_.each(n.tmpA,function(e,t){e.magicId=t}),n.uniq_products1=_.uniqBy(_.filter(n.tmpB,function(e){return null!=e.variant_id}),"variant_id"),n.uniq_products2=_.filter(n.tmpB,function(e){return null==e.variant_id}),n.products=_.uniqBy(_.concat(n.uniq_products1,n.uniq_products2),"magicId")})},n.updateInventoryReportType=function(e){n.selectedParam3="Low in stocks",n.paramobj2={sub_id:n.sub_id_2,arg:2,filterBy:"out of stock"},u.getDashboardSalesAndInventoryReport(n.paramobj2).then(function(e){n.invProducts=_.filter(e.response,function(e){return"out of stock"==e.stock_status})})},n.productSalesByDate=function(e){n.arr=[];var t=_.groupBy(e,"transaction_date"),r=0;_.each(t,function(e,a){r++;var s={x:[],y:[],name:"",type:"bar"};_.each(e,function(e,t){s.x.push(a),s.y.push(e.total_sales),s.name=e.product_name}),n.arr.push(s),r==e.length-1&&(n.srlayout={height:200,margin:{l:50,r:20,t:5,b:50,autoexpand:!0},barmode:"stack",xaxis:{title:""}},o.current.name)})},n.productPerformance=function(e){var t=_.groupBy(e,"product_name");n.groupedbyproductname=[],_.each(t,function(e,t){var a={discount:_.sumBy(e,"discount"),product_name:e[0].product_name,product_type:e[0].product_type,quantity:_.sumBy(e,"quantity"),store_name:e[0].store_name,total_sales:_.sumBy(e,"total_sales")-_.sumBy(e,"discount")};n.groupedbyproductname.push(a)}),n.productPerformance_data=p("limitTo")(_.orderBy(n.groupedbyproductname,["quantity"],["desc"]),5),n.pp={height:500,margin:{l:200,r:0,t:5,b:50,autoexpand:!0},xaxis:{title:""}},_.each(n.groupedbyproductname,function(e,t){n.prod_performance[0].y.push(e.product_name),n.prod_performance[0].x.push(e.total_sales),n.groupedbyproductname.length-1==t&&o.current.name})},n.getsatbsp_div=function(a){n.arr2=[],n.user_sblayout={height:220,margin:{l:50,r:20,t:5,b:50,autoexpand:!0},xaxis:{title:""}},_.each(a,function(e,t){n.prod_user_1.x.push(e.sales_person),n.prod_user_1.y.push(e.total_sales),n.prod_user_sales.x.push(e.sales_person),n.prod_user_sales.y.push(e.total_sales),n.prod_user_discount.x.push(e.sales_person),n.prod_user_discount.y.push(e.discount),n.prod_user_itemsold.x.push(e.sales_person),n.prod_user_itemsold.y.push(e.total_items),n.prod_user_transaction.x.push(e.sales_person),n.prod_user_transaction.y.push(e.transactions),n.arr2=[n.prod_user_1,n.prod_user_sales,n.prod_user_discount,n.prod_user_itemsold,n.prod_user_transaction],t==a.length-1&&o.current.name})},n.calculateUserStats=function(e){n.copyOfFilteredSalesPerson=[],n.groupedBy_sales_person=_.groupBy(e,"sales_person"),n.filteredSalesPerson=p("limitTo")(_.orderBy(n.groupedBy_sales_person,["total_sales"],["desc"]),5),_.each(n.filteredSalesPerson,function(e,t){if(e&&e[0]&&e[0].sales_person){var a={sales_person:e[0].sales_person,total_sales:_.sumBy(e,"total_sales")-_.sumBy(e,"discount"),total_transactions:_.sumBy(e,"transactions")};n.copyOfFilteredSalesPerson.push(a)}})},n.formatSalesReport=function(e,t){if(n.formattedSalesReport=[],"product_name"==t){var a=_.groupBy(e,t);n.cformat=[],n.cformat=["product_name","product_type","store_name","quantity","revenue","costofgoods","gross"],_.each(a,function(e,t){var a={product_name:t,product_type:e[0].product_type,store_name:e[0].store_name,store_id:e[0].store_id,quantity:_.sumBy(e,"quantity"),revenue:_.sumBy(e,"total_sales")-_.sumBy(e,"discount"),costofgoods:_.sumBy(e,"total_sales")-_.sumBy(e,"gross_profit"),gross:_.sumBy(e,"gross_profit")};n.formattedSalesReport.push(a)})}else if("customer"==t){a=_.groupBy(e,t);n.cformat=[],n.cformat=["customer","store_name","discount","total_items","revenue","gross"],_.each(a,function(e,t){var a={customer:t,store_name:e[0].store_name,store_id:e[0].store_id,discount:_.sumBy(e,"discount"),total_items:_.sumBy(e,"total_items"),revenue:_.sumBy(e,"revenue")-_.sumBy(e,"discount"),gross:_.sumBy(e,"gross_profit")};n.formattedSalesReport.push(a)})}else if("sales_person"==t){a=_.groupBy(e,t);n.cformat=[],n.cformat=["sales_person","store_name","discount","total_items","total_sales","revenue","gross"],_.each(a,function(e,t){var a={sales_person:e[0].sales_person,store_name:e[0].store_name,store_id:e[0].store_id,discount:_.sumBy(e,"discount"),total_items:_.sumBy(e,"total_items"),total_sales:_.sumBy(e,"total_sales"),revenue:_.sumBy(e,"total_sales")-_.sumBy(e,"discount"),gross:_.sumBy(e,"gross_profit")};n.formattedSalesReport.push(a)})}},n.selectedArrOfStores=[],n.arrOfStores=[{id:"_all_",label:"_all_"}],n.updateSalesSummary=function(a){n.paramobj2={sub_id:n.sub_id_2,filterBy:a,dateTo:moment(n.rs_dateTo).format("YYYY-MM-DD"),dateFrom:moment(n.rs_dateFrom).format("YYYY-MM-DD"),timezone:n.timezone_2,store_id:n.storeids,arg:1},u.getDashboardSalesAndInventoryReport(n.paramobj2).then(function(e){var t=_.groupBy(e.response,"store_id");switch(_.each(t,function(e,t){var a={id:e[0].store_id,label:e[0].store_name};n.arrOfStores.push(a)}),n.arrOfStores=_.remove(_.uniqBy(n.arrOfStores,"id"),function(e){return null!=e.id}),a.toLowerCase()){case"product":n.filteredSalesRep=e.response,n.selectedParam1="Product",n.formatSalesReport(e.response,"product_name");break;case"customer":n.filteredSalesRep=e.response,n.selectedParam1="Customer",n.formatSalesReport(e.response,"customer");break;case"user":n.filteredSalesRep=e.response,n.selectedParam1="User",n.formatSalesReport(e.response,"sales_person");break;default:console.log("case not defined, return nothing")}})},n.eventlistener1={onItemSelect:function(e){var a;"_all_"==e.id?(n.selectedArrOfStores=[{id:"_all_",label:"_all_"}],n.arrOfStores=[{id:"_all_",label:"_all_"}],n.changeSelectedStore("_all_")):(n.arrOfStores=_.uniq(n.arrOfStores),n.selectedArrOfStores=_.uniq(_.filter(n.selectedArrOfStores,function(e){return"_all_"!=e.id})),a=[],_.each(_.uniq(n.selectedArrOfStores),function(e,t){a.push(e.id)}),n.changeSelectedStore(a.toString()))},onItemDeselect:function(e){console.log("$scope.selectedArrOfStores ",n.selectedArrOfStores)}},n.settings1={scrollableHeight:"200px",scrollable:!0,enableSearch:!0,showCheckAll:!1,closeOnSelect:!1,closeOnBlur:!0,dynamicTitle:!0},n.updateSalesMeasures=function(e){},n.changeSelectedStore=function(e){"_all_"==e?(n.storeids="_all_",n.selectedParam4="All Stores"):n.storeids=e,n.updateSalesSummary(n.selectedParam1)},n.dashboardreportChangeDate=function(){n.rs_dateFrom=n.getDateFrom(),n.refresh()},n.getSalesReportsByStore=function(e,t,a){n.paramobj={sub_id:n.sub_id,filterBy:e,dateFrom:t,dateTo:moment(n.dateTo).format("YYYY-MM-DD"),timezone:n.timezone,arg:2}},n.default_trace_format=function(){return{x:[],y:[],type:"line",fill:"tonexty",mode:"lines+markers",marker:{color:"#34a8a5"}}};function h(e,t){if(0==e)return"0 Bytes";var a=t||3,s=Math.floor(Math.log(e)/Math.log(1e3));return parseFloat((e/Math.pow(1e3,s)).toFixed(a))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][s]}n.loadSummaryReports=function(){n.srlayout={height:200,margin:{l:50,r:20,t:5,b:50,autoexpand:!0},barmode:"stack",xaxis:{title:""}},n.summary_data=[n.trace9,n.trace10,n.trace11]},n.refresh=function(){n.trace1=n.default_trace_format(),n.trace2=n.default_trace_format(),n.trace3=n.default_trace_format(),n.trace4=n.default_trace_format(),n.trace5=n.default_trace_format(),n.trace6=n.default_trace_format(),n.trace7=n.default_trace_format(),n.trace8=n.default_trace_format(),n.trace9={x:n.trace7.x,y:n.trace7.y,type:"bar",fill:"tonexty",mode:"lines+markers",marker:{color:"#247571"},showlegend:!0,name:"Discount"},n.trace10={x:n.trace1.x,y:n.trace1.y,type:"bar",fill:"tonexty",mode:"lines+markers",marker:{color:"#35aaa6"},showlegend:!0,name:"Revenue"},n.trace11={x:n.trace3.x,y:n.trace3.y,type:"line",fill:"tonexty",mode:"lines+markers",marker:{color:"#09211f"},showlegend:!0,name:"Item Sold"},n.prod_sales_s1={x:[],y:[],name:"",type:""},n.prod_user_1={x:[],y:[],showlegend:!0,name:"Users",type:"bar"},n.prod_user_sales={x:[],y:[],type:"line",fill:"tonexty",mode:"lines",marker:{color:"orange"},showlegend:!0,name:"Sales"},n.prod_user_discount={x:[],y:[],type:"line",fill:"tonexty",mode:"lines",marker:{color:"red"},showlegend:!0,name:"Discount"},n.prod_user_itemsold={x:[],y:[],type:"line",fill:"tonexty",mode:"lines",marker:{color:"green"},showlegend:!0,name:"Item Sold"},n.prod_user_transaction={x:[],y:[],type:"line",fill:"tonexty",mode:"lines",marker:{color:"blue"},showlegend:!0,name:"Transactions"},n.prod_performance=[{y:[],x:[],type:"bar",orientation:"h"}],n.clearStatsValue(),n.getDashboardReports(),n.getDashboardReportsByStore(),n.getDashboardSalesReports("product"),n.getDashboardSalesReports("user"),n.getDashboardSalesReports("customer")},n.setActive=function(e){switch(n.filterBy="",e){case"day":case"week":case"month":case"year":n.filterBy=e,n.refresh();break;default:n.filterBy="day",n.refresh()}},n.isloadingApiCalls=!1,n.apicallParam={},n.subscriptionUsers=0,n.apicallsreportChangeDate=function(){n.apicallParam={sub_id:n.sub_id,start:0,limit:"all",date_from:n.apicalls_dateFrom,date_to:n.apicalls_dateTo,timezone:n.timezone},u.getApicallsReport(n.apicallParam).then(function(e){if(e&&e.response&&e.response.response&&e.response.response.result&&e.response.response.result.info&&0<e.response.response.result.info.length){n.allapicallscount=e.response.response.result.info.length;var t=e.response.response.result.info;n.allapicallsbytesRead=h(_.sumBy(t,"bytesRead")),n.allapicallsbytesWritten=h(_.sumBy(t,"bytesWritten"));var a=_.filter(e.response.response.result.info,function(e){return"GET"==e.methods});n.getapicallscount=a?a.length:0,n.getapicallsbytesRead=h(_.sumBy(a,"bytesRead")),n.getapicallsbytesWritten=h(_.sumBy(a,"bytesWritten"));var s=_.filter(e.response.response.result.info,function(e){return"POST"==e.methods});n.postapicallscount=s?s.length:0,n.postapicallsbytesRead=h(_.sumBy(s,"bytesRead")),n.postapicallsbytesWritten=h(_.sumBy(s,"bytesWritten"));var r=_.filter(e.response.response.result.info,function(e){return"PUT"==e.methods});n.putapicallscount=r?r.length:0,n.putapicallsbytesRead=h(_.sumBy(r,"bytesRead")),n.putapicallsbytesWritten=h(_.sumBy(r,"bytesWritten"));var o=_.filter(e.response.response.result.info,function(e){return"DELETE"==e.methods});n.deleteapicallscount=o?o.length:0,n.deleteapicallsbytesRead=h(_.sumBy(o,"bytesRead")),n.deleteapicallsbytesWritten=h(_.sumBy(o,"bytesWritten")),n.users_sub=_.groupBy(e.response.response.result.info,"person_id")}else n.allapicallscount,n.allapicallsbytesRead,n.allapicallsbytesWritten=0,n.getapicallscount,n.getapicallsbytesRead,n.getapicallsbytesWritten=0,n.postapicallscount,n.postapicallsbytesRead,n.postapicallsbytesWritten=0,n.putapicallscount,n.putapicallsbytesRead,n.putapicallsbytesWritten=0,n.deleteapicallscount,n.deleteapicallsbytesRead,n.deleteapicallsbytesWritten=0}),u.getAssetTotalStorageUsed().then(function(e){e&&e.response&&e.response.result?n.storageUsed=h(e.response.result):n.storageUsed="--"}),i.getAllUserAccounts().then(function(e){e&&e.response&&e.response.result?(n.allUsers=e.response.result,n.allUsersLength=e.response.result.length):n.allUsers=0})},n.init=function(){"main.reports-inventory"==o.current.name?(n.getDashboardInventoryReports(),n._getAllProductsUnFiltered()):"main.reports-sales"==o.current.name?n.updateSalesSummary(n.selectedParam1):n.setActive("")},n.init()}angular.module("POS17").controller("reportDashboardController",e),e.$inject=["$scope","$timeout","$state","$stateParams","localStorageService","toastr","productFactory","humanFactory","useraccountsFctry","usergroupsFctry","dashboardReportsFctry","$filter"]}();
!function(){"use strict";function o(o){}angular.module("POS17").controller("SalesReportController",o),o.$inject=["$scope"]}();
!function(){"use strict";function t(o,n,t,e,s,r,u,c,a){o.currentPage=1,o.itemsPerPage=4,s.getAllProduct().then(function(t){if(o.products=[],200==t.statusCode&t.response.success){var e=t.response.result;n(function(){o.$apply(function(){o.products=e}),o.totalItems=o.products.length,n(function(){o.productIsLoading=!1},2e3)},100)}}),r.getAllPerson().then(function(t){if(o.persons=[],200==t.statusCode&&t.response.result){o.totalPersonel=t.response.result.length;var e=t.response.result;n(function(){o.$apply(function(){o.persons=e}),n(function(){o.productIsLoading=!1},2e3)},100)}}),async.waterfall([function(e){c.getAllUserGroups().then(function(t){200==t.statusCode&&t.response.success?e(null,t.response.result):(console.log(t.response.msg),e(null,"error"))})},function(s,t){u.getAllUserAccounts().then(function(t){if(o.useraccounts=[],200==t.statusCode&&t.response.success){var e=t.response.result;_.each(e,function(t){t.role_id&&(t.userRoles=_.map(t.role_id.split(","),function(e){return _.find(s,function(t){return t.role_id==e})}))}),n(function(){o.$apply(function(){o.useraccounts=e}),n(function(){o.productIsLoading=!1},2e3)},100)}})}])}angular.module("POS17").config(["$stateProvider",function(t){t.state("main.dashboard",{url:"/dashboard",templateUrl:"modules/dashboard/dashboard1.html",controller:"DashboardCtrl"})}]).controller("DashboardCtrl",t),t.$inject=["$scope","$timeout","localStorageService","toastr","productFactory","humanFactory","useraccountsFctry","usergroupsFctry","dashboardReportsFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,e){e.state("main.quotes",{url:"/quotes",templateUrl:"modules/quotes/quotes.html",controller:"quotesController"}).state("main.export-quotes",{url:"/articles/quotes",templateUrl:"modules/quotes/quotes.export-pdf.html",controller:"quotesExportsController"}).state("main.quotes-detail",{url:"/quotes/:quote_id",templateUrl:"modules/quotes/quotes.detail.html",controller:"quotesDetailController"}).state("main.quotesprint",{url:"/quotesprint",templateUrl:"modules/quotes/quote.report.html",controller:"quotesPrintController"})}])}();
!function(){"use strict";function e(l,o,a,i,e,t,s,n,u,c,r,d){l.selectDeselectAll=!1,l.applicationStatus="All",l.selectedDatas=[],l.txtSearch={text:""},l.reportFields={quote_id:"Quotation ID",quote_number:"Quote Number",quote_status:"Status",quote_date:"Quote Date",customer_id:"Customer ID",company_id:"Company ID",currency_id:"Currency ID",comments:"Quote Memo",terms:"Quote Terms",other_fee:"Other Fee",tax:"Tax",sub_total:"Sub-Total",total_fee:"Total Fee",bill_to_name:"Bill To",bill_to_address:"Billing Address",bill_to_city:"Billing City",bill_to_state:"Billing State",bill_to_zipcode:"Billing Zip Code",bill_to_country:"Billing Country",ship_to:"Ship To Customer ID",ship_to_name:"Ship To",ship_to_address:"Shipping Address",ship_to_city:"Shipping City",ship_to_state:"Shipping State",ship_to_zipcode:"Shippping Zip Code",ship_to_country:"Shipping Country",sp_id:"SP_ID",sub_id:"Subscription ID",store_id:"Store ID",staff_id:"Created By",valid_until:"Valid Quote Until",date_created:"Date Created",quote_item_list:"Items",_id:"UUID"};var p=JSON.parse(c.get("user"));r.logTransaction("View Quotes","QUOTES","ALL","User:="+p.username+" View all list of Quotes");l.quotes=[],l.quoteTable=new s({page:1,count:10,filter:l.txtSearch},{counts:[10,25,50,100],getData:function(o,i){u.getAllQuotes().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;i.filter().text&&"All"==l.applicationStatus?l.quotes=a("filter")(t,i.filter().text):i.filter().text&&"Active"==l.applicationStatus?(l.quotes=a("filter")(t,{is_active:1}),l.quotes=a("filter")(l.quotes,i.filter().text)):i.filter().text&&"Inactive"==l.applicationStatus?(l.quotes=a("filter")(t,{is_active:0}),l.quotes=a("filter")(l.quotes,i.filter().text)):_.isUndefined(i.filter().text)&&"All"==l.applicationStatus?l.quotes=t:_.isUndefined(i.filter().text)&&"Active"==l.applicationStatus?l.quotes=a("filter")(t,{is_active:1}):_.isUndefined(i.filter().text)&&"Inactive"==l.applicationStatus?l.quotes=a("filter")(t,{is_active:0}):l.quotes=t,l.selectedDatas&&0<l.selectedDatas.length&&_.each(l.quotes,function(t){_.find(l.selectedDatas,function(e){return e.quote_id===t.quote_id})&&(t.selected=!0)}),i.total(l.quotes.length);var s=l.quotes.slice((i.page()-1)*i.count(),i.page()*i.count());o.resolve(s)}else console.log(e.response.msg)})}}),l.refresh=function(){l.quoteTable.reload()},l.edit=function(e){o.go("main.quotes-detail",{quote_id:e})},l.updateStatus=function(e){l.applicationStatus=e,l.quoteTable.reload()},l.searchData=function(){l.quoteTable.reload()},l.changeSelectDeselectAll=function(){l.selectDeselectAll=!l.selectDeselectAll,_.each(l.quotes,function(e){e.selected=l.selectDeselectAll,l.deleteSomeData=l.selectDeselectAll,l.checkDataChanges(e)})},l.checkDataChanges=function(t){t.selected?_.find(l.selectedDatas,function(e){return e.quote_id===t.quote_id})||l.selectedDatas.push(t):l.selectedDatas=_.filter(l.selectedDatas,function(e){return e.quote_id!==t.quote_id}),l.deleteSomeData=0<l.selectedDatas.length},l.deleteSelected=function(){n.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:l,className:"ngdialog-theme-default"}).then(function(){var s=0;async.each(l.selectedDatas,function(e,t){e.selected&&u.deleteQuoteInfo(e.quote_id).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),++s==l.selectedDatas.length&&o.reload(),t()):i.error(e.response.msg,"Error")})})})}}angular.module("POS17").controller("quotesController",e),e.$inject=["$scope","$state","$filter","toastr","$timeout","$stateParams","ngTableParams","ngDialog","quoteFactory","localStorageService","transLogFctry","$uibModal"]}();
!function(){"use strict";function e(r,s,e,a,o,i,t,l,u,n,d,c,p,g,m,f,h,y,q){console.log("quotesDetailController:"),r.persons=[],r.store=[],r.products=[],r.countries=[],r.currencies=[],r.productBundles=[],r.items={},r.tags=[],r.tagsArr=[],r.details={},r.details.subtotal=0,r.details.other_fee=0,r.details.tax=0,r.details.quoteproduct_list=[],r.details.tags=[],r.itemList=[],r.radioModel="product",r.billingAddress=!1,r.shippingAddress=!1;var b=JSON.parse(m.get("user"));i.quote_id?q.logTransaction("View Quotes","QUOTES",i.quote_id,"User:="+b.username+" View quote details:="+i.quote_id):q.logTransaction("Add New Quotes","QUOTES","N/A","User:="+b.username+" Add new quote entry"),y.getAllCountries().then(function(e){200==e.statusCode&&e.response.success&&(r.countries=e.response.result)}),h.getAllCurrencies().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;r.currencies=t}else console.log(e.response.msg)}),n.getAllPerson().then(function(e){200==e.statusCode&&e.response.success?(r.persons=e.response.result,r.details.person_id=r.persons[0].person_id):console.log(e.response.msg)}),d.getAllStore().then(function(e){200==e.statusCode&&e.response.success?r.store=e.response.result:console.log(e.response.msg)}),c.getAllProduct().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;_.each(t,function(e){0==e.is_archived&&r.products.push(e)})}}),c.getAllProductBundle().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;_.each(t,function(e){1!==e.is_archived&&r.productBundles.push(e)})}}),f.getAllTags().then(function(e){200==e.statusCode&&e.response.success?r.tagsArr=e.response.result:console.log(e.response.msg)}),i.quote_id&&g.getDetailQuote(i.quote_id).then(function(e){if(200==e.statusCode&&e.response.success){r.details=e.response.result,r.detailcopy=angular.copy(e.response.result),r.details.customer=r.details.bill_qoute_info,r.details.quoteproduct_list=[];var t=r.details.quote_item_list;_.each(t,function(e){_.isNull(e.product_id)||r.details.quoteproduct_list.push({item_name:e.product_details.item_name,quantity:e.quantity,price:e.price,discount:e.discount,total:(e.price-e.discount)*e.quantity,product_id:e.product_id,bundle_id:null}),_.isNull(e.bundle_id)||r.details.quoteproduct_list.push({item_name:e.bundle_details.bundle_name,quantity:e.quantity,price:e.price,discount:e.discount,total:(e.price-e.discount)*e.quantity,product_id:null,bundle_id:e.bundle_id})}),console.log("$scope.details: ",r.details)}f.getAllQuoteTags(i.quote_id).then(function(e){200==e.statusCode&&e.response.success&&(r.details.tags=e.response.result)})}),r.changeData=function(e){r.radioModel=e},r.tagTransform=function(e){return{tags:e}},r.clearInput=function(e){e.search=""},r.addToList=function(e){console.log("$scope.radioModel:",r.radioModel),"product"==r.radioModel?_.isUndefined(e.product)||_.isEmpty(e.product)||(_.find(r.details.quoteproduct_list,{product_id:e.product.p_id})?a.warning("Product Item already existed","Warning"):r.details.quoteproduct_list.push({item_name:e.product.item_name,quantity:e.quantity,price:e.price,discount:e.discount,total:e.total,product_id:e.product.p_id,bundle_id:null})):"productgroup"==r.radioModel&&(console.log("SURE"),_.isUndefined(e.productgroup)||_.isEmpty(e.productgroup)||(_.find(r.details.quoteproduct_list,{product_id:e.productgroup.p_id})?a.warning("Bundle Item already existed","Warning"):r.details.quoteproduct_list.push({item_name:e.productgroup.bundle_name,quantity:e.quantity,price:e.price,discount:e.discount,total:e.total,product_id:null,bundle_id:e.productgroup.pb_id}))),e.product=null,e.productgroup=null,e.quantity=0,e.price=0,e.discount=0,e.total=0,console.log("$scope.details.quoteproduct_list: ",r.details.quoteproduct_list),r.calculateItems()},r.calculateItem=function(e){var t,s=0;return t=(e.price-e.discount)*e.quantity,s+=parseFloat(t),e.total=s,e.total},r.calculateItems=function(){var s=0,o=0;_.each(r.details.quoteproduct_list,function(e){var t=e.price-e.discount;s=t*e.quantity,o+=parseFloat(s)}),r.details.sub_total=o,r.calculateBilling()},r.calculateBilling=function(){r.details.total_fee=parseFloat(r.details.sub_total||0)+parseFloat(r.details.tax||0)+parseFloat(r.details.other_fee||0)},r.removeItem=function(e){r.details.quoteproduct_list.splice(e,1),r.calculateItems()},r.deleteQuoteTag=function(e){i.quote_id&&f.deleteQuoteTag(i.quote_id,e.tags_id).then(function(e){200==e.statusCode&&e.response.success?a.success(e.response.msg,"Success"):a.error(e.response.msg,"Error")})},r.useBillingAddress=function(e){e?(r.details.ship_to_name=r.details.bill_to_name,r.details.ship_to_address=r.details.bill_to_address,r.details.ship_to_state=r.details.bill_to_state,r.details.ship_to_zipcode=r.details.bill_to_zipcode,r.details.ship_to_country=r.details.bill_to_country):(r.details.ship_to_name=r.detailcopy.ship_to_name,r.details.ship_to_address=r.detailcopy.ship_to_address,r.details.ship_to_state=r.detailcopy.ship_to_state,r.details.ship_to_zipcode=r.detailcopy.ship_to_zipcode,r.details.ship_to_country=r.detailcopy.ship_to_country)},r.useCustomerAddress=function(e){e&&r.details.customer?(r.details.bill_to_address=r.details.customer.address,r.details.bill_to_state=r.details.customer.state,r.details.bill_to_zipcode=r.details.customer.zipcode,r.details.bill_to_country=r.details.customer.country):(r.details.bill_to_address="",r.details.bill_to_state="",r.details.bill_to_zipcode="",r.details.bill_to_country="")},r.saveQuoteInfo=function(){var e=JSON.parse(m.get("user"));r.details.staff_id=e.uc_id,r.details.store_id=r.details.store.store_id,r.details.customer_id=r.details.customer.person_id,r.details.ship_to=r.details.customer.person_id,r.details.currency_id=r.details.currency_id,r.details.quote_status="P",r.details.quote_date=new Date,console.log("$scope.details: ",r.details),async.waterfall([function(t){g.saveQuoteInfo(r.details).then(function(e){if(200==e.statusCode&&e.response.success)a.success(e.response.msg,"Success"),t(null,e.response.result);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void a.error(e.response.msg,"Error");_.each(e.response.result,function(e){a.warning(e.msg,"Warning")})}})},function(s,o){console.log("dri bai");var i=0;0<r.details.tags.length?async.eachSeries(r.details.tags,function(e,t){e.isTag?f.saveTags(e).then(function(e){200==e.statusCode&&e.response.success?f.saveQuoteTags(s,{tag_id:e.response.result}).then(function(e){200==e.statusCode&&e.response.success?(i++,t()):a.error(e.response.msg,"Error")}):a.error(e.response.msg,"Error")}):f.saveQuoteTags(s,{tag_id:e.tags_id}).then(function(e){200==e.statusCode&&e.response.success?(i++,t()):a.error(e.response.msg,"Error")}),i>=r.details.tags.length&&o(null,s)}):o(null,s)},function(e,t){o(function(){s.go(s.current,{quote_id:e},{reload:!0})},300)}])}}angular.module("POS17").controller("quotesDetailController",e),e.$inject=["$scope","$state","$filter","toastr","$timeout","$stateParams","ngTableParams","ngDialog","$uibModal","humanFactory","storeFactory","productFactory","categoryFactory","quoteFactory","localStorageService","tagsFactory","currencyFactory","countryFactory","transLogFctry"]}();
!function(){"use strict";function t(t,e,o,l,n,i,s,a){t.printQoute=function(){a.print()},t.updateBillingAddress=function(){t.modal={title:"Update Billing Address",message:"Are you sure to update Billing Address?"},s.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:t,className:"ngdialog-theme-default"}).then(function(){},function(t){console.log("Modal promise close: ")})}}angular.module("POS17").controller("quotesPrintController",t),t.$inject=["$scope","$state","$filter","toastr","$timeout","$stateParams","ngDialog","$window"]}();
!function(){"use strict";function t(s,t,e){console.log("quotesExportsController"),s.currentDate=Date.now(),s.quotes=[],s.IsExport=!1,t.getAllQuotes().then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;_.isEmpty(e)||(s.quotes=e)}else console.log(t.response.msg)}),s.myFunction=function(){s.IsExport=!0,angular.element(document).ready(function(){e(function(){console.log("basic-table"),$("#basic-table").trigger("footable_redraw")},1e3)})},s.export=function(){var t=Date.now()+"quotes.pdf",o="{total_pages_count_string}",n=new jsPDF({orientation:"landscape",format:"a4"}),e=document.getElementById("basic-table"),a=n.autoTableHtmlToJson(e);n.autoTable(a.columns,a.data,{addPageContent:function(t){n.setFontSize(20),n.setTextColor(40),n.setFontStyle("normal"),n.text("Quotation --- Date: "+moment(s.currentDate).format("MM/DD/YYYY hh:mm a"),t.settings.margin.left,15);var e="Page "+t.pageCount;"function"==typeof n.putTotalPages&&(e=e+" of "+o),n.setFontSize(10),n.text(e,t.settings.margin.left,n.internal.pageSize.height-5)},startY:20,margin:{top:30},styles:{overflow:"linebreak",columnWidth:"wrap"},columnStyles:{0:{columnWidth:20},1:{columnWidth:20},2:{columnWidth:35},3:{columnWidth:35},4:{columnWidth:50},5:{columnWidth:35},6:{columnWidth:50},7:{columnWidth:30}}}),"function"==typeof n.putTotalPages&&n.putTotalPages(o),n.save(t)}}angular.module("POS17").controller("quotesExportsController",t),t.$inject=["$scope","quoteFactory","$timeout"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(r,e){e.state("main.purchase_order",{url:"/purchaseorder",templateUrl:"modules/purchase_order/purchase_order.html",controller:"purchaseOrderController"}).state("main.add_order",{url:"/purchaseorder/:selected_id",templateUrl:"modules/purchase_order/addor.html",controller:"addOrderController"}).state("main.list",{url:"/purchaseorder/hold",templateUrl:"modules/purchase_order/producthold.html",controller:"holdController"}).state("main.productlist",{url:"/purchaseorder/productList",templateUrl:"modules/purchase_order/productList.html",controller:"productsController"}).state("main.stock",{url:"/purchaseorder/stocks",templateUrl:"modules/purchase_order/stocks.html",controller:"stocksController"}).state("main.view_savepo",{url:"/purchaseorder/:selected_id/view_savepo/:store_id",templateUrl:"modules/purchase_order/purchase_order-view.html",controller:"viewSavedPOController"})}])}();
!function(){"use strict";function e(r,s,e,t,a,o,n,l,c){r.puchaseorders=[],r.applicationStatus="All";var u=JSON.parse(t.get("user"));a.logTransaction("View Purchase Orders","PURCHASE ORDER","ALL","User:="+u.username+" View all list of Inventory - Purchase Order"),r.datenow=moment(new Date).format("MMM Do YYYY, h:mm:ss a"),r.updatePurchaseOrder=function(e,s){console.log("id",e),console.log("data",s)},r.parseDate=function(e){if(e)return moment(new Date(e)).format("MMM Do YYYY")},r.toggleModal=function(e){l.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){s.deletePurchaseOrder(e).then(function(e){200==e.statusCode&&e.response.success?(n.success(e.response.msg,"Success"),o.reload()):n.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},r.updateStatus=function(e){r.applicationStatus=e,i()};var i=function(){r.puchaseordersisLoading=!0,r.puchaseorders=[],r.paginate={offset:0,limit:10},r.txtSearch={text:""},r.puchaseordersTable=new e({page:1,count:10,filter:r.txtSearch},{counts:[10,25,50,100],getData:function(a,o){s.getAllPurchaseOrder(r.paginate).then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;if(r.puchaseorders=s.filter(function(e){return"Completed"==r.applicationStatus?null!=e.date_closed&&"Cancelled"!=e.po_status:"Open"==r.applicationStatus?null==e.date_closed&&"Cancelled"!=e.po_status:"Cancelled"==r.applicationStatus?"Cancelled"==e.po_status:(r.applicationStatus="All",""!=e.po_status)}),o.filter().text){r.puchaseorders=c("filter")(r.puchaseorders,o.filter().text),o.total(r.puchaseorders.length);var t=r.puchaseorders.slice(0,r.puchaseorders.length);a.resolve(t),r.puchaseordersisLoading=!1}else{o.total(r.puchaseorders.length);t=r.puchaseorders.slice((o.page()-1)*o.count(),o.page()*o.count());a.resolve(t),r.puchaseordersisLoading=!1}}else console.log(e.response.msg)})}})};r.searchData=function(){r.puchaseordersTable.reload()},r.callWhenEmpty=function(){i()},i(),r.refresh=function(){r.puchaseordersisLoading=!0,r.puchaseordersTable.reload()}}angular.module("POS17").controller("purchaseOrderController",e),e.$inject=["$scope","purchaseOrderFactory","ngTableParams","localStorageService","transLogFctry","$state","toastr","ngDialog","$filter"]}();
!function(){"use strict";function e(i,e,t,s,r,n,o,a,l,d,u,c,p,m,f,g,h){console.log("addOrderController"),i.isColl=!1,i.radioModel="product",i.products=[],i.productBundles=[],i.items={},i.suppliers=[],i.customers=[],i.stores=[],i.details={},i.details.details=[],i.details.products_list=[],i.details.emailsubject,i.details.currentemail="";var v=!1;i.showMessage=!1,i.showsecondMessage=!1,i.showExportMessage=!1,i.enAbleToSendForm,i.profile={},i.stores.selected={},i.datenow=h(new Date).format("MMMM Do YYYY"),i.doGreeting=function(){v&&a.cancel(v),i.showMessage=!0,v=a(function(){i.showMessage=!1,i.showsecondMessage=!0,v=a(function(){i.showsecondMessage=!1},2e3)},5e3)},i.doExport=function(){v&&a.cancel(v),i.showExportMessage=!0,v=a(function(){i.showExportMessage=!1,i.showsecondExportMessage=!0,v=a(function(){i.showsecondExportMessage=!1},2e3)},5e3)},i.changeData=function(e){i.radioModel=e},i.getoveralltotal=function(e){i.overalltotal=_.sumBy(e,function(e){return e.price*(e.quantity_ordered||e.quantity)})},i.getGeneratedPOId=function(){m.generatepoid().then(function(e){i.details.po_number=e.response.result})},i.loadpo=function(){m.getAllPurchaseOrderDetail(n.selected_id).then(function(e){e&&200==e.statusCode&&e.response.success&&(i.details=e.response.result,i.details.details_tmp=i.details.details,i.details.details=[],i.getCurrentUser(),i._getAllProducts(),_.each(i.details.details_tmp,function(e){i.details.details.push({item_name:e.details.product_has_variants?e.details.product_name_variant:e.details.product_name,quantity_ordered:e.quantity,quantity:e.quantity,price:e.price,discount:e.discount,total:e.total,product_id:e.details.product_id,bundle_id:null,total_cost:e.quantity*e.price,direct_sending:!0,prod_var_id:e.details.product_has_variants?e.details.variant_id:null,unit:e.details.unit})}),i.details.emailsubject="PO Number "+i.details.po_number,i.getoveralltotal(i.details.details))})};var y={offset:0,limit:0};i._getAllProducts=function(){y.limit+=10,i.uniq_products1=[],i.uniq_products2=[],i.merge_products=[],d.getProductAndVariants(y).then(function(e){i.tmpA=_.filter(e.response.result.result,function(e){return null!=e.inventory_id}),i.tmpB=_.each(i.tmpA,function(e,t){e.magicId=t}),i.uniq_products1=_.uniqBy(_.filter(i.tmpB,function(e){return null!=e.variant_id}),"variant_id"),i.uniq_products2=_.filter(i.tmpB,function(e){return null==e.variant_id}),i.products=_.uniqBy(_.concat(i.uniq_products1,i.uniq_products2),"magicId"),i.setSelectedStore(i.details.store_id)})},i._getAllProductsUnFiltered=function(){d.getProductAndVariants({isExportAction:!0}).then(function(e){i.tmpA=_.filter(e.response.result.result,function(e){return null!=e.inventory_id}),i.tmpB=_.each(i.tmpA,function(e,t){e.magicId=t}),i.uniq_products1=_.uniqBy(_.filter(i.tmpB,function(e){return null!=e.variant_id}),"variant_id"),i.uniq_products2=_.filter(i.tmpB,function(e){return null==e.variant_id}),i.products=_.uniqBy(_.concat(i.uniq_products1,i.uniq_products2),"magicId"),i.setSelectedStore(i.details.store_id)})},i.getCurrentUser=function(){e.userprofile().then(function(e){if(200==e.statusCode&&e.response.success)i.profile=e.response.result,i.currentemail=e.response.result.profile.email,i.details.currentemail=e.response.result.profile.email;else if(400==e.statusCode&&!e.response.success)return void l.error(e.response.msg,"Error")})},u.getAllSuppliers().then(function(e){e&&200==e.statusCode&&e.response.success&&(i.suppliers=e.response.result)}),p.getAllPerson().then(function(e){e&&200==e.statusCode&&e.response.success&&(i.customers=_.filter(e.response.result,function(e){return 2==e.per_type_id}))}),i._getAllStore=function(){f.getAllStore().then(function(e){e&&200==e.statusCode&&e.response.success&&(i.stores=e.response.result,n.selected_id||(i.stores.unshift({store_id:0,name:"--select store--"}),i.details.store_id=0))})},d.getAllProductBundle().then(function(e){if(e&&200==e.statusCode&&e.response.success){var t=e.response.result;_.each(t,function(e){1!==e.is_archived&&i.productBundles.push(e)})}}),i.setSelectedStore=function(t){i.stores.selected=t,i.filteredProducts=_.filter(i.products,function(e){return e.store_id==t}),i.filteredByPublicity=_.filter(i.filteredProducts,function(e){return e.product_has_variants?1==e.variant_is_published&&1!=e.variant_is_deleted:1==e.product_is_published&&1!=e.product_is_archived}),console.log("$scope.filteredByPublicity ",i.filteredByPublicity)},i.calculateItem=function(e){var t=0,s=e.price*e.quantity;return t+=parseFloat(s),e.total=t,e.total},i.parseDate=function(e){if(e)return h(new Date(e)).format("MMMM Do YYYY")},i.toast_emailnotifs=function(e){"Sent"==e||"sent"==e?l.success("Email Sent","Success"):l.warning("Email not Sent","Warning")},i.currentPage=1,i.entryLimit=5,i.selectDeselectAll=!1,i.applicationStatus="All",i.displayModel="List",i.viewby=25,i.pageSize=i.viewby,i.currentPage=1,i.itemsPerPage=20,i.totalUsers=0,i._getitemdetails=function(t,s){return s?_.filter(i.products,function(e){return t==e.product_id&&s==e.variant_id})[0]:_.filter(i.products,function(e){return t==e.product_id})[0]},i.addToList=function(e){_.isEmpty(e)?l.warning("Product list could not empty","Warning"):("product"==i.radioModel?_.isUndefined(e)||(i.details.details.push({item_name:e.details.product_has_variants?e.details.product_name_variant:e.details.product_name,quantity_ordered:e.quantity,quantity:e.quantity,price:e.price,discount:e.discount,total:e.total,product_id:e.details.product_id,bundle_id:null,total_cost:e.quantity*e.price,direct_sending:!0,prod_var_id:e.details.product_has_variants?e.details.variant_id:null,unit:e.details.unit}),i.getoveralltotal(i.details.details)):"productgroup"==i.radioModel&&(_.isUndefined(e.productgroup)||(i.details.details.push({item_name:e.productgroup.bundle_name,quantity:e.quantity,quantity_ordered:e.quantity,price:e.price,discount:e.discount,total:e.total,product_id:null,bundle_id:e.productgroup.pb_id,total_cost:e.quantity*e.price,direct_sending:!0}),i.getoveralltotal(i.details.details),i.items.quantity=null,i.items.price=null,i.items.total=null,i.items.product=null)),console.log("$scope.details:",i.details))},i.approvedPO=function(e){var t={approved_by:i.details.created_by};m.approvedPurchasedOrder(e,t).then(function(e){e&&200==e.statusCode&&e.response.success?l.success(e.response.msg,"Success"):l.error(e?e.response.msg:"Error Found","Eror")})},i.savePO=function(s){var e=JSON.parse(t.get("user"));i.details.created_by=e.uc_id,i.details.emailmessage="",i.details.toSend=s,i.details.po_date=h().format("YYYY-MM-DD HH:mm:ss"),i.details.supplier_id&&i.details.deliver_to&&i.details.po_number?(i.details.suppliername=function(t){if(t)return _.find(i.suppliers,function(e){return e.s_id==t})}(i.details.supplier_id).name,console.log("details:",i.details),n.selected_id?(console.log("$scope.details updating..",i.details),m.updatePurchaseOrder(n.selected_id,i.details).then(function(e){if(e&&200==e.statusCode&&e.response.success){l.success(e.response.msg,"Success");n.selected_id;s&&i.approvedPO(n.selected_id),o.go("main.view_savepo",{selected_id:n.selected_id,store_id:i.details.store_id})}else l.error(e?e.response.msg:"Error Found","Eror");s&&i.toast_emailnotifs(e&&e.response.email?e.response.email:"Error Found")})):(console.log("$scope.details saving..",i.details),m.savePurchaseOrder(i.details).then(function(e){if(e&&200==e.statusCode&&e.response.success){l.success(e.response.msg,"Success");var t=e.response.result.inserted_po_id;s&&t&&i.approvedPO(t),o.go("main.view_savepo",{selected_id:t,store_id:i.details.store_id})}else l.error(e?e.response.msg:"Error Found","Eror");s&&i.toast_emailnotifs(e&&e.response.email?e.response.email:"Error Found")}))):l.warning("Fill in all the required fields in the first tab","Warning")},i.toggleModal=function(){g.openConfirm({templateUrl:"modules/dialog/cancelDialog.html",scope:i,className:"ngdialog-theme-default"}).then(function(){i.backto_fstpasge()},function(e){})},i.calculateBilling=function(){i.total=parseFloat(i.details.sub_total||0)+parseFloat(i.details.tax||0)+parseFloat(i.details.shipping_fee||0)},i.removeProduct=function(e){i.details.details.splice(e,1),i.getoveralltotal(i.details.details)},i.edit=function(e){o.go("main.products-add",{p_id:e})},i.openPOUpdateModal=function(e){console.log("toSend:",e),i.enAbleToSendForm=e,i.details.po_status=e?"Sent":"Open",i.details.emailsubject="PO Number "+i.details.po_number,g.openConfirm({templateUrl:"./modules/purchase_order/po.update.modal.html",scope:i,className:"ngdialog-theme-default",appendClassName:"ngdialog-custom",width:"40%"}).then(function(){i.savePO(e)},function(e){console.log("Modal promise close: ")})},i.open_scndpage=function(){i.fstpasge=!1,i.scndpage=!0},i.onSelectedProduct=function(e){i.items.price=e.product_has_variants?e.variant_sell_price:e.product_sell_price,i.items.prod_var_id=e.product_has_variants?e.variant_id:null},i.goback=function(){o.go("main.purchase_order")},i.isQtyNotANumber=function(e){return null==e||null==e||""==e||isNaN(e)?!(i.items.quantity=""):(i.items.quantity=e,!1)},i.isPriceNotANumber=function(e){return null==e||null==e||""==e||isNaN(e)?!(i.items.price=""):(i.items.price=e,!1)},i.init=function(){console.log("init"),i.getCurrentUser(),n.selected_id?i.loadpo():(console.log("1"),i.getGeneratedPOId(),i._getAllProductsUnFiltered()),i._getAllStore()},i.init()}angular.module("POS17").controller("addOrderController",e),e.$inject=["$scope","AuthFctry","localStorageService","$http","$filter","$stateParams","$state","$timeout","toastr","productFactory","supplierFctry","ngTableParams","humanFactory","purchaseOrderFactory","storeFactory","ngDialog","moment"]}();
!function(){"use strict";function t(t,o){t.value=o.value,t.fetch=function(){o.callFunction(),t.value=o.value}}function o(t,o){o.callFunction=function(){alert("Function Called Successfully"),o.value="Edoy"}}angular.module("POS17").controller("testCtrl",t).controller("testRootCtrl",o),t.$inject=["$scope","$rootScope"],o.$inject=["$scope","$rootScope"]}();
!function(){"use strict";function o(o){}angular.module("POS17").controller("holdController",o),o.$inject=["$scope"]}();
!function(){"use strict";function t(l,t,i,e,d,r,s,o,c){l.search={},l.currentPage=1,l.entryLimit=5,l.selectDeselectAll=!1,l.applicationStatus="All",l.displayModel="List",l.viewby=25,l.pageSize=l.viewby,l.currentPage=1,l.itemsPerPage=20,l.totalUsers=0,l.categories=[];var n=[],a=[];l.side=!1,o.getAllCategory().then(function(t){if(200==t.statusCode&&t.response.success){for(var e=t.response.result,r=0;r<e.length;r++){var o=e[r],c=o.name,i=o.parent_id,s=o.c_id;a[i]?null!=(o={parentid:i,label:c,item:o})&&(a[i].items||(a[i].items=[]),a[i].items[a[i].items.length]=o,a[s]=o):(a[s]={parentid:s,label:c,item:o},n[s]=a[s])}l.categoryData=_(n).omit(_.isUndefined).omit(_.isNull).value(),l.categorycopy=angular.copy(l.categoryData)}});o.getAllCategory().then(function(t){200==t.statusCode&&t.response.success&&(l.categories=t.response.result)}),l.setPage=function(t){l.currentPage=t},l.setItemsPerPage=function(t){l.itemsPerPage=t,l.currentPage=1},l.edit=function(t){e.go("main.products-add",{p_id:t})},l.searchData=function(){l.productTable.reload()},l.refresh=function(){l.productIsLoading=!0,l.productTable.reload()},l.updateStatus=function(t){console.log("status: ",t),l.applicationStatus=t,l.productTable.reload()},l.changeSelectDeselectAll=function(){l.selectDeselectAll=!l.selectDeselectAll,_.each(l.products,function(t){t.selected=l.selectDeselectAll})},o.getAllCategory().then(function(t){200==t.statusCode&&t.response.success&&(l.categories=t.response.result)}),l.$watch("mytree.currentNode",function(t,e){var r=[],o={},c={};l.category=[],l.tree=[],l.currentNode=[];var i=[];if(l.mytree&&angular.isObject(l.mytree.currentNode)){l.currentNode=l.mytree.currentNode.item;var s=_.find(l.categorycopy,{parentid:l.currentNode.c_id});if(console.log("sample2:",s),_.isUndefined(s)){var n=_.map(l.productscopy,function(t){var e=_.filter(t.product_category,{category_id:l.currentNode.c_id});if(0<e.length)return _.find(e,function(t){return t})});console.log("product_categories:",n),c=_.filter(n,function(t){if(!_.isUndefined(t))return t}),console.log("product_categories2:",c),o=_.map(_.uniqBy(c,"product_id"),function(t){return t.product_id}),_.forEach(o,function(t){r.push(_.find(l.productscopy,{p_id:t}))})}else{var a=_.map(s.items,function(t){return{c_id:t.item.c_id}});_.each(l.productscopy,function(r){_.each(a,function(t){var e=_.filter(r.product_category,{category_id:t.c_id});e&&0<e.length&&i.push(e[0])})});var u=_.map(_.uniqBy(i,"product_id"),function(t){return t.product_id});_.forEach(u,function(t){r.push(_.find(l.productscopy,{p_id:t}))})}d(function(){l.$apply(function(){l.productTable.reload()})},100)}},!1),l.productIsLoading=!0,l.products=[],l.productscopy=[],l.txtSearch={text:""},l.productTable=new c({page:1,count:10,filter:l.txtSearch},{counts:[10,25,50,100],getData:function(o,c){s.getAllProduct().then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;l.totalItems=e.length,l.productscopy=angular.copy(l.products),c.filter().text&&"All"==l.applicationStatus?l.products=i("filter")(e,c.filter().text):c.filter().text&&"Publish"==l.applicationStatus?(l.products=i("filter")(e,{is_published:1}),l.products=i("filter")(l.products,c.filter().text)):c.filter().text&&"Archived"==l.applicationStatus?(l.products=i("filter")(e,{is_archived:1}),l.products=i("filter")(l.products,c.filter().text)):c.filter().text&&"Draft"==l.applicationStatus?(l.products=i("filter")(e,{is_published:0}),l.products=i("filter")(l.products,c.filter().text)):_.isUndefined(c.filter().text)&&"All"==l.applicationStatus?l.products=e:_.isUndefined(c.filter().text)&&"Publish"==l.applicationStatus?l.products=i("filter")(e,{is_published:1}):_.isUndefined(c.filter().text)&&"Archived"==l.applicationStatus?l.products=i("filter")(e,{is_archived:1}):_.isUndefined(c.filter().text)&&"Draft"==l.applicationStatus?l.products=i("filter")(e,{is_published:0}):l.products=e,c.total(l.products.length);var r=l.products.slice((c.page()-1)*c.count(),c.page()*c.count());o.resolve(r),l.productIsLoading=!1}else l.productIsLoading=!1,console.log(t.response.msg)})}})}angular.module("POS17").controller("productListController",t),t.$inject=["$scope","$http","$filter","$state","$timeout","toastr","productFactory","categoryFactory","ngTableParams"]}();
!function(){"use strict";function t(l,t,s,e,i){l.applicationStatus="All";l.refresh=function(){l.stocksTable.reload()},l.updateStatus=function(t){l.applicationStatus=t,l.stocksTable.reload()},l.searchData=function(){l.stocksTable.reload()},l.stocksisLoading=!0,l.stocks=[],l.txtSearch={text:""},l.stocksTable=new e({page:1,count:10,filter:l.txtSearch},{counts:[10,25,50,100],getData:function(o,a){s.getAllInventory().then(function(t){if(200==t.statusCode&&t.response.success){var s=t.response.result;_.each(s,function(t){return new Date(t.expiration_date)}),console.log("data.response.result:",t.response.result),a.filter().text&&"All"==l.applicationStatus?l.stocks=i("filter")(s,a.filter().text):a.filter().text&&"Published"==l.applicationStatus?(l.stocks=i("filter")(s,{status:1}),l.stocks=i("filter")(l.stocks,a.filter().text)):a.filter().text&&"Unpublished"==l.applicationStatus?(l.stocks=i("filter")(s,{status:0}),l.stocks=i("filter")(l.stocks,a.filter().text)):_.isUndefined(a.filter().text)&&"All"==l.applicationStatus?l.stocks=s:_.isUndefined(a.filter().text)&&"Published"==l.applicationStatus?l.stocks=i("filter")(s,{status:1}):_.isUndefined(a.filter().text)&&"Unpublished"==l.applicationStatus?l.stocks=i("filter")(s,{status:0}):l.stocks=s,a.total(l.stocks.length);var e=l.stocks.slice((a.page()-1)*a.count(),a.page()*a.count());o.resolve(e),l.stocksisLoading=!1}else console.log(t.response.msg)})}})}angular.module("POS17").controller("stocksController",t),t.$inject=["$scope","$rootScope","inventoryFactory","ngTableParams","$filter"]}();
!function(){"use strict";function e(r,e,t,s,a,n,i,o,d,l,c,p,u,m,f,g,v,h){r.datenow=v(new Date).format("MMMM Do YYYY"),r.parent_details={},r.parent_details.details=[],r.details=[],r.po_status="",r.po_id="",r.enAbleToSendForm,r.params={},r.params.arrOfPOIds=[],r.details2=[],r.specialVar1=[],r.specialVar2=[],r.receivedItems=[],n.selected_id?(r.po_id=n.selected_id,m.getAllPurchaseOrderDetail(r.po_id).then(function(e){if(e&&200==e.statusCode&&e.response.success){r.parent_details=e.response.result,r.parent_details.details_tmp=r.parent_details.details,r.parent_details.details=[],r.getCurrentUser(),r.parent_details.emailsubject="PO Number "+r.parent_details.po_number,r.receivedItems=r.parent_details.received_items,_.each(r.parent_details.details_tmp,function(e,t){var s,a;r.parent_details.details.push({item_name:e.details.product_has_variants?e.details.product_name_variant:e.details.product_name,quantity_ordered:e.quantity,quantity:e.quantity,price:e.price,discount:e.discount,total:e.total,product_id:e.details.product_id,bundle_id:null,total_cost:e.quantity*e.price,direct_sending:!0,prod_var_id:e.details.product_has_variants?e.details.variant_id:null,stock_on_hand:e.details.stock_on_hand,total_received:(s=e.details.product_id,a=e.details.product_has_variants?e.details.variant_id:null,_.find(r.receivedItems,{product_id:s,variant_id:a}).total_received),unit:e.details.unit}),t==r.parent_details.details_tmp.length-1&&console.log("$scope.parent_details ",r.parent_details)}),r.fstpasge=!1,r.scndpage=!0,r.getoveralltotal(r.parent_details.details);var t=r.parent_details.po_status;r.po_status="Open"==t||"open"==t||"OPEN"==t?"Saved":"Sent"==t||"sent"==t||"SENT"==t?"Sent":t,_.each(r.parent_details.details,function(e,t){r.parent_details.details[t].splycst=e.price})}else console.log("no data fetched !")}),r.getoveralltotal=function(e){r.overalltotal=_.sumBy(e,function(e){return e.price*e.quantity_ordered})},r.parseDate=function(e){if(e)return v(new Date(e)).format("MMMM Do YYYY")},r.backto_fstpasge=function(){g.openConfirm({templateUrl:"modules/dialog/cancelDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){r.fstpasge=!0,r.scndpage=!1;n.selected_id;i.go("main.purchase_order")},function(e){console.log("reason ",e)})},r.getCurrentUser=function(){e.userprofile().then(function(e){if(200==e.statusCode&&e.response.success)r.profile=e.response.result,r.currentemail=r.profile.profile.email,r.parent_details.currentemail=r.profile.profile.email;else if(400==e.statusCode&&!e.response.success)return void d.error(e.response.msg,"Error")})},r.toast_emailnotifs=function(e){"Sent"==e||"sent"==e?d.success("Email Sent","Success"):d.warning("Email not Sent","Warning")},r.cancelPO=function(){g.openConfirm({templateUrl:"modules/dialog/cancelDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){var e=JSON.parse(t.get("user"));r.parent_details.created_by=e.uc_id,r.parent_details.suppliername=r.parent_details.supplier.name,r.parent_details.po_status="Cancelled",r.parent_details.supplier_id&&r.parent_details.deliver_to&&r.parent_details.po_number?n.selected_id?m.updatePurchaseOrder(n.selected_id,r.parent_details).then(function(e){e&&200==e.statusCode&&e.response.success?(d.success("PO status Cancelled","Success"),i.reload()):d.error(e?e.response.msg:"Error Found","Eror")}):m.savePurchaseOrder(r.parent_details).then(function(e){e&&200==e.statusCode&&e.response.success?d.success("PO status Cancelled","Success"):d.error(e?e.response.msg:"Error Found","Eror")}):d.warning("Fill in all the required fields in the first tab","Warning")},function(e){console.log("reason ",e)})},r.approvedPO=function(e){var t={approved_by:r.parent_details.created_by};m.approvedPurchasedOrder(e,t).then(function(e){e&&200==e.statusCode&&e.response.success?d.success(e.response.msg,"Success"):d.error(e?e.response.msg:"Error Found","Eror"),i.reload()})},r.savePO2=function(s){var e=JSON.parse(t.get("user"));r.parent_details.created_by=e.uc_id,r.parent_details.po_status="Sent",r.parent_details.toSend=s,r.parent_details.supplier_id&&r.parent_details.deliver_to&&r.parent_details.po_number?(r.parent_details.suppliername=r.parent_details.supplier.name,n.selected_id&&(console.log("$scope.parent_details ",r.parent_details),m.updatePurchaseOrder(n.selected_id,r.parent_details).then(function(e){if(e&&200==e.statusCode&&e.response.success){d.success(e.response.msg,"Success");var t=n.selected_id;s&&(t?r.approvedPO(t):d.warning("PO not approved ! missing po_id"))}else d.error(e?e.response.msg:"Error Found","Eror");s&&r.toast_emailnotifs(e&&e.response.email?e.response.email:"Error Found")}))):d.warning("Fill in all the required fields in the first tab","Warning")},r.openPOUpdateModal2=function(e){r.enAbleToSendForm=e,r.parent_details.po_status="",g.openConfirm({templateUrl:"./modules/purchase_order/po.sendsaved.modal.html",scope:r,className:"ngdialog-theme-default",appendClassName:"ngdialog-custom",width:"40%"}).then(function(){r.savePO2(e)},function(e){console.log("Modal promise close: ")})},r.updateReceiveItemScope=function(e,t){r.parent_details.details[t].qtyrecv=r.specialVar1[t]},r.updateSupplyCostScope=function(e,t){r.parent_details.details[t].splycst=r.specialVar2[t]},r.promptMsg1=function(e){r.specialVar1[e]="",d.warning("Receive count must be less than or equal to number of items ordered","Warning")},r.checkSpecialVar1=function(){return _.find(r.specialVar1,"")},r.receivePO=function(){var t;r.obj={po_id:n.selected_id,receive_number:"",receive_date:v(new Date).format("MMMM Do YYYY, h:mm:ss a"),received_by:r.profile.profile.person_id,supplier_id:r.parent_details.supplier_id,products_list:(t=[],_.each(r.parent_details.details,function(e){console.log("innerval ",e),t.push({product_id:e.product_id,price:e.splycst,quantity:e.qtyrecv,quantity_ordered:e.quantity_ordered,stock_onhand:e.stock_on_hand,prod_var_id:e.prod_var_id?e.prod_var_id:null,fk_store_id:n.store_id})}),t),store_id:n.store_id},console.log("$scope.obj ",r.obj),m.receivePurchasedOrder(r.obj).then(function(e){e&&200==e.statusCode&&e.response.success?(d.success(e.response.msg,"Success"),i.reload()):d.error(e?e.response.msg:"Error Found","Eror")})},r.reactivatePO=function(){d.warning("This Feature is not yet implemented..","Warning")},r.init=function(){r.getCurrentUser()},r.init()):d.warning("state not available.")}angular.module("POS17").controller("viewSavedPOController",e),e.$inject=["$scope","AuthFctry","localStorageService","$http","$filter","$stateParams","$state","$timeout","toastr","productFactory","supplierFctry","ngTableParams","humanFactory","purchaseOrderFactory","storeFactory","ngDialog","moment"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(e,r){r.state("main.received_order",{url:"/receivedorder",templateUrl:"modules/received_order/received_order.html",controller:"receivedOrderController"}).state("main.rec_order",{url:"/recorder/rec_order",templateUrl:"modules/received_order/recOrder.html",controller:"recOrderController"}).state("main.rec_list",{url:"/recorder/receivedorderList",templateUrl:"modules/received_order/receivedHolder.html",controller:"receivedholdController"})}])}();
!function(){"use strict";function e(i,e,r,c,t,o){i.applicationStatus="All";var a=JSON.parse(t.get("user"));o.logTransaction("View Receivings","RECEIVED ORDER","ALL","User:="+a.username+" View all list of Inventory - Received Order");i.updateStatus=function(e){i.applicationStatus=e,i.receivedorderTable.reload()},i.searchData=function(){i.receivedorderTable.reload()},i.receivedorderisLoading=!0,i.receivedorder=[],i.receivedorderTable=new r({page:1,count:10},{counts:[10,25,50,100],getData:function(o,a){e.getAllPurchaseOrder().then(function(e){if(200==e.statusCode&&e.response.success){var r=e.response.result;console.log("receivedorder:",r),i.txtSearch&&"All"==i.applicationStatus?i.receivedorder=c("filter")(r,i.txtSearch):i.txtSearch&&"Approved"==i.applicationStatus?(i.receivedorder=c("filter")(r,{po_status:"Open"}),i.receivedorder=c("filter")(i.receivedorder,i.txtSearch)):i.txtSearch&&"Unapproved"==i.applicationStatus?(i.receivedorder=c("filter")(r,{po_status:"Closed"}),i.receivedorder=c("filter")(i.receivedorder,i.txtSearch)):_.isUndefined(i.txtSearch)&&"All"==i.applicationStatus?i.receivedorder=r:_.isUndefined(i.txtSearch)&&"Approved"==i.applicationStatus?i.receivedorder=c("filter")(r,{po_status:"Open"}):_.isUndefined(i.txtSearch)&&"Unapproved"==i.applicationStatus?i.receivedorder=c("filter")(r,{po_status:"Closed"}):i.receivedorder=r,a.total(i.receivedorder.length);var t=i.receivedorder.slice((a.page()-1)*a.count(),a.page()*a.count());o.resolve(t),i.receivedorderisLoading=!1}else console.log(e.response.msg)})}})}angular.module("POS17").controller("receivedOrderController",e),e.$inject=["$scope","purchaseOrderFactory","ngTableParams","$filter","localStorageService","transLogFctry"]}();
!function(){"use strict";function r(r){}angular.module("POS17").controller("recOrderController",r),r.$inject=["$scope"]}();
!function(){"use strict";function e(e){}angular.module("POS17").controller("receivedholdController",e),e.$inject=["$scope"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(r,e){e.state("main.return_order",{url:"/returnorder",templateUrl:"modules/re_order/returnOrder.html",controller:"returnOrderController"}).state("main.ret_order",{url:"/returnorder/return_orderform",templateUrl:"modules/re_order/reOrder.html",controller:"retOrderController"}).state("main.retorderHold",{url:"/returnorder/returnorderholdform",templateUrl:"modules/re_order/returnHold.html",controller:"returnholdController"})}])}();
!function(){"use strict";function e(o,s,e,r,t,a,c,l){o.puchaseorders=[];var n=JSON.parse(r.get("user"));t.logTransaction("View Purchase Orders","PURCHASE ORDER","ALL","User:="+n.username+" View all list of Inventory - Purchase Order"),o.updatePurchaseOrder=function(e,s){console.log("id",e),console.log("data",s)},o.toggleModal=function(e){l.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:o,className:"ngdialog-theme-default"}).then(function(){s.deletePurchaseOrder(e).then(function(e){if(200!=e.statusCode||!e.response.success)return console.log("data.response;",e),void c.error(e.response.msg,"Error");c.success(e.response.msg,"Success"),a.reload()})},function(e){console.log("Modal promise close: ")})};o.puchaseordersisLoading=!0,o.puchaseorders=[],o.puchaseordersTable=new e({page:1,count:10},{counts:[10,25,50,100],getData:function(t,a){s.getAllPurchaseOrder().then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;o.txtSearch&&"All"==o.applicationStatus?o.puchaseorders=$filter("filter")(s,o.txtSearch):o.txtSearch&&"Published"==o.applicationStatus?(o.puchaseorders=$filter("filter")(s,{status:1}),o.puchaseorders=$filter("filter")(o.puchaseorders,o.txtSearch)):o.txtSearch&&"Unpublished"==o.applicationStatus?(o.puchaseorders=$filter("filter")(s,{status:0}),o.puchaseorders=$filter("filter")(o.puchaseorders,o.txtSearch)):_.isUndefined(o.txtSearch)&&"All"==o.applicationStatus?o.puchaseorders=s:_.isUndefined(o.txtSearch)&&"Published"==o.applicationStatus?o.puchaseorders=$filter("filter")(s,{status:1}):_.isUndefined(o.txtSearch)&&"Unpublished"==o.applicationStatus?o.puchaseorders=$filter("filter")(s,{status:0}):o.puchaseorders=s,a.total(o.puchaseorders.length);var r=o.puchaseorders.slice((a.page()-1)*a.count(),a.page()*a.count());t.resolve(r),o.puchaseordersisLoading=!1}else console.log(e.response.msg)})}})}angular.module("POS17").controller("returnOrderController",e),e.$inject=["$scope","purchaseOrderFactory","ngTableParams","localStorageService","transLogFctry","$state","toastr","ngDialog"]}();
!function(){"use strict";function e(a,s,e,t,o,c,l,n,r,i,u,d,p,g,f){a.isColl=!1,a.radioModel="product",a.products=[],a.productBundles=[],a.items={},a.details={},a.suppliers=[],a.customers=[],a.stores=[];var h=!(a.details.products_list=[]);a.showMessage=!1,a.showsecondMessage=!1,a.showExportMessage=!1,a.doGreeting=function(){h&&l.cancel(h),a.showMessage=!0,h=l(function(){a.showMessage=!1,a.showsecondMessage=!0,h=l(function(){a.showsecondMessage=!1},2e3)},5e3)},a.doExport=function(){h&&l.cancel(h),a.showExportMessage=!0,h=l(function(){a.showExportMessage=!1,a.showsecondExportMessage=!0,h=l(function(){a.showsecondExportMessage=!1},2e3)},5e3)},a.changeData=function(e){a.radioModel=e},console.log("$stateParams",o),o.selected_id&&p.getAllPurchaseOrderDetail(o.selected_id).then(function(e){200==e.statusCode&&e.response.success&&(a.details=e.response.result,console.log("$scope.details:",a.details))}),i.getAllSuppliers().then(function(e){200==e.statusCode&&e.response.success&&(a.suppliers=e.response.result)}),d.getAllPerson().then(function(e){200==e.statusCode&&e.response.success&&(a.customers=_.filter(e.response.result,function(e){return 2==e.per_type_id}))}),r.getAllProduct().then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;_.each(s,function(e){0==e.is_archived&&a.products.push(e)})}}),g.getAllStore().then(function(e){200==e.statusCode&&e.response.success&&(a.stores=e.response.result,console.log("$scope.stores:",a.stores))}),r.getAllProductBundle().then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;_.each(s,function(e){1!==e.is_archived&&a.productBundles.push(e)})}}),a.calculateItem=function(e){var s=0,t=e.price*e.quantity;return s+=parseFloat(t),e.total=s,e.total},a.currentPage=1,a.entryLimit=5,a.selectDeselectAll=!1,a.applicationStatus="All",a.displayModel="List",a.viewby=25,a.pageSize=a.viewby,a.currentPage=1,a.itemsPerPage=20,a.totalUsers=0,a.addToList=function(e){console.log("$scope.radioModel:",a.radioModel),console.log("aww:",a.details.products_list),console.log("details:",e),_.isEmpty(e)?n.warning("Product list could not empty","Warning"):"product"==a.radioModel?_.isUndefined(e.product)||a.details.products_list.push({item_name:e.product.item_name,quantity:e.quantity,price:e.price,discount:e.discount,total:e.total,product_id:e.product.p_id,bundle_id:null}):"productgroup"==a.radioModel&&(console.log("SURE"),_.isUndefined(e.productgroup)||a.details.products_list.push({item_name:e.productgroup.bundle_name,quantity:e.quantity,price:e.price,discount:e.discount,total:e.total,product_id:null,bundle_id:e.productgroup.pb_id})),a.calculateItems(),console.log(" $scope.details:",a.details)},a.savePO=function(){var e=JSON.parse(s.get("user"));a.details.created_by=e.uc_id,console.log("$scope.details:",a.details),p.savePurchaseOrder(a.details).then(function(e){200==e.statusCode&&e.response.success&&n.success(e.response.msg,"Success")})},a.toggleModal=function(){f.openConfirm({templateUrl:"modules/dialog/cancelDialog.html",scope:a,className:"ngdialog-theme-default"})},a.calculateItems=function(e){var t=0,o=0;_.each(a.details.products_list,function(e){var s=e.price-e.discount;t=s*e.quantity,o+=parseFloat(t)}),a.details.sub_total=o,a.calculateBilling()},a.calculateBilling=function(){a.total=parseFloat(a.details.sub_total||0)+parseFloat(a.details.tax||0)+parseFloat(a.details.shipping_fee||0)},a.removeProduct=function(e){a.products_list.splice(e,1)},a.edit=function(e){c.go("main.products-add",{p_id:e})}}angular.module("POS17").controller("retOrderController",e),e.$inject=["$scope","localStorageService","$http","$filter","$stateParams","$state","$timeout","toastr","productFactory","supplierFctry","ngTableParams","humanFactory","purchaseOrderFactory","storeFactory","ngDialog"]}();
!function(){"use strict";function n(n){}angular.module("POS17").controller("returnholdController",n),n.$inject=["$scope"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,l){l.state("main.articles",{url:"/articles",templateUrl:"modules/articles/articles.html",controller:"articleController"}).state("main.export-articles",{url:"/articles/exports",templateUrl:"modules/articles/article-export-pdf.html",controller:"articleExportsController"}).state("main.articles-detail",{url:"/articles/:article_id",templateUrl:"modules/articles/article.detail.html",controller:"articleDetailController"})}])}();
!function(){"use strict";function e(c,s,r,a,e,t,n,l,i,o,d,u,f){c.selectDeselectAll=!1,c.applicationStatus="All",c.filterStatus="Relevance",c.txtSearch={text:""},c.selectedDatas=[],c.selectedPublishedDatas=[],c.selectedDraftedDatas=[],c.tagsArr=[],c.tagsFilter=[],c.example8settings={showCheckAll:!1,showUncheckAll:!1,enableSearch:!0,scrollableHeight:"300px",scrollable:!0},c.reportFields={article_id:"Article ID",title:"Article Title",article:"Overview",description:"Description",thumbnail_media:"Thumbnail Media",date_implemented:"Date Implemented",date_created:"Date Created",sp_id:"SP_ID",sub_id:"Subscription ID",is_active:"IsActive",_id:"UUID"};var g=JSON.parse(d.get("user"));o.logTransaction("View Articles","ARTICLES","ALL","User:="+g.username+" View all list of articles");f.getAllTags().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;_.each(t,function(e){c.tagsArr.push({id:e.tags_id,label:e.tags,_id:e._id})})}else console.log(e.response.msg)}),c.selectEvents={onItemSelect:function(e){c.articleTable.reload()},onItemDeselect:function(e){c.articleTable.reload()}},c.refresh=function(){c.articleisLoading=!0,c.articleTable.reload()},c.edit=function(e){s.go("main.articles-detail",{article_id:e})},c.updateStatus=function(e){c.applicationStatus=e,c.articleTable.reload()},c.updateFilterStatus=function(e){c.filterStatus=e,c.articleTable.reload()},c.searchData=function(){c.articleTable.reload()},c.changeSelectDeselectAll=function(){c.selectDeselectAll=!c.selectDeselectAll,_.each(c.articles,function(e){e.selected=c.selectDeselectAll,c.deleteSomeData=c.selectDeselectAll,c.checkDataChanges(e)})},c.checkDataChanges=function(t){t.selected?_.find(c.selectedDatas,function(e){return e.article_id===t.article_id})||(c.selectedDatas.push(t),1==t.is_active&&c.selectedPublishedDatas.push(t),0==t.is_active&&c.selectedDraftedDatas.push(t)):c.selectedDatas=_.filter(c.selectedDatas,function(e){return e.article_id!==t.article_id}),c.deleteSomeData=0<c.selectedDatas.length},c.toggleModal=function(e){i.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:c,className:"ngdialog-theme-default"}).then(function(){n.deleteArticle(e).then(function(e){200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),s.reload()):a.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},c.updateHistory=function(e){u.open({animation:!0,backdrop:"static",templateUrl:"./modules/articles/audit.log.modal.html",controller:"articleAuditLogModalCtrl",size:"md",resolve:{article_id:function(){return e}}})},c.deleteSelected=function(){i.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:c,className:"ngdialog-theme-default"}).then(function(){var l=0;async.each(c.selectedDatas,function(e,t){e.selected&&n.deleteArticle(e.article_id).then(function(e){200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),++l==c.selectedDatas.length&&s.reload(),t()):a.error(e.response.msg,"Error")})})})},c.draftSelected=function(){c.modal={title:"Draft Article?",message:"Are you sure to Draft this selected article?"},i.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:c,className:"ngdialog-theme-default"}).then(function(){var l=1;0<c.selectedPublishedDatas.length?async.eachSeries(c.selectedPublishedDatas,function(e,t){e.selected&&1==e.is_active&&n.draftArticle(e.article_id).then(function(e){200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),l++,t()):a.error(e.response.msg,"Error")}),console.log("dataCountToDelete: ",l),l==c.selectedPublishedDatas.length&&s.reload()}):a.warning("Unable to Draft selected Articles..Selected articles are either archived or already drafted","Warning")})},c.publishSelected=function(e){c.modal={title:"Publish Article?",message:"Are you sure to Publish this selected article?"},i.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:c,className:"ngdialog-theme-default"}).then(function(){var l=1;0<c.selectedDraftedDatas.length?async.eachSeries(c.selectedDraftedDatas,function(e,t){e.selected&&0==e.is_active&&n.publishArticle(e.article_id).then(function(e){200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),l++,t()):a.error(e.response.msg,"Error")}),console.log("dataCountToDelete: ",l),l==c.selectedDraftedDatas.length&&s.reload()}):a.warning("Unable to Publish selected Articles..Selected articles are either archived or already published","Warning")})},c.articleisLoading=!0,c.articles=[],c.articleTable=new l({page:1,count:10,filter:c.txtSearch},{counts:[10,25,50,100],getData:function(a,i){n.getArticle().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;if(i.filter().text&&"All"==c.applicationStatus?c.articles=r("filter")(t,i.filter().text):i.filter().text&&"Published"==c.applicationStatus?(c.articles=r("filter")(t,{is_active:1}),c.articles=r("filter")(c.articles,i.filter().text)):i.filter().text&&"Draft"==c.applicationStatus?(c.articles=r("filter")(t,{is_active:0}),c.articles=r("filter")(c.articles,i.filter().text)):_.isEmpty(i.filter().text)&&"All"==c.applicationStatus?c.articles=t:_.isEmpty(i.filter().text)&&"Published"==c.applicationStatus?c.articles=r("filter")(t,{is_active:1}):_.isEmpty(i.filter().text)&&"Draft"==c.applicationStatus?c.articles=r("filter")(t,{is_active:0}):c.articles=t,"Most Viewed"==c.filterStatus&&(c.articles=r("orderBy")(c.articles,"article_views",!0),c.articles=_.filter(c.articles,function(e){return 0<parseInt(e.article_views)})),c.tagsFilter&&0<c.tagsFilter.length){var l=[];_.each(c.tagsFilter,function(t){_.each(c.articles,function(e){_.find(e.tags,{tags_id:t.id})&&l.push(e)})}),c.articles=l}c.selectedDatas&&0<c.selectedDatas.length&&_.each(c.articles,function(t){_.find(c.selectedDatas,function(e){return e.article_id===t.article_id})&&(t.selected=!0)}),i.total(c.articles.length);var s=c.articles.slice((i.page()-1)*i.count(),i.page()*i.count());a.resolve(s),c.articleisLoading=!1}else console.log(e.response.msg),c.articleisLoading=!1})}})}angular.module("POS17").controller("articleController",e),e.$inject=["$scope","$state","$filter","toastr","$timeout","$stateParams","articleFctry","ngTableParams","ngDialog","transLogFctry","localStorageService","$uibModal","tagsFactory"]}();
!function(){"use strict";function e(a,i,e,r,s,l,d,t,n,o,c,u,p,m,f,g){a.details={},a.details.tags=[],a.details.article_feature=[],a.details.article_features_list=[],a.details.is_published=!1,a.details.is_archived=!1,a.mediaSource={},a.radioModel="product",a.products=[],a.productBundles=[],a.mediafile=[],a.types=[],a.tags=[],a.tagsArr=[],a.infiniteScroll={},a.infiniteScroll.numToAdd=10,a.infiniteScroll.currentItems=10,a.resetInfScroll=function(){a.infiniteScroll.currentItems=a.infiniteScroll.numToAdd},a.addMoreItems=function(){a.infiniteScroll.currentItems+=a.infiniteScroll.numToAdd};var h=JSON.parse(f.get("user"));function b(t){_.each($rootScope.cartItems,function(e){e.pb_id==t.pb_id&&(e.quantity=t.quantity)}),f.set("Cart",JSON.stringify($rootScope.cartItems))}l.article_id?g.logTransaction("View Article Details","ARTICLES",l.article_id,"User:="+h.username+" View article details:="+l.article_id):g.logTransaction("Add New Article","ARTICLES","N/A","User:="+h.username+" Add new article entry"),u.getAllTags().then(function(e){200==e.statusCode&&e.response.success?a.tagsArr=e.response.result:console.log(e.response.msg)}),l.article_id&&(a.details.article_feature=[],a.details.article_features_list=[],d.getDetailArticle(l.article_id).then(function(e){200==e.statusCode&&e.response.success&&(a.details=e.response.result,a.showPublish=1!=a.details.is_active,a.details.article_features_list=_.map(a.details.article_features,function(e){return null==e.bundle_id&&null!==e.product_id?{item_name:e.product_details.item_name,item_code:e.product_details.product_code,item_brand:e.product_details.brand,item_id:e.product_details.p_id}:null!==e.bundle_id&&null==e.product_id?{item_name:e.bundle_details.bundle_name,item_code:e.bundle_details.bundle_code,item_brand:e.bundle_details.bundle_brand,item_id:e.bundle_details.pb_id}:void 0}),a.details.article_feature=_.map(a.details.article_features,function(e){return null==e.bundle_id&&null!==e.product_id?{product_id:e.product_details.p_id,bundle_id:null,article_id:l.article_id}:null!==e.bundle_id&&null==e.product_id?{product_id:null,bundle_id:e.bundle_details.pb_id,article_id:l.article_id}:void 0}),a.details.media=a.details.article_thumbnail,a.showArticleMedia(),a.mediafile=e.response.result.mediafiles,u.getAllArticleTags(l.article_id).then(function(e){200==e.statusCode&&e.response.success&&(a.details.tags=e.response.result)}))}),c.getAllProduct().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;_.each(t,function(e){0==e.is_archived&&a.products.push(e)})}}),c.getAllProductBundle().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;_.each(t,function(e){1!==e.is_archived&&a.productBundles.push(e)})}})),a.changeData=function(e){a.radioModel=e},a.reloadMediaFiles=function(){l.article_id&&(a.mediafile=[],a.imagesFile=[],d.getDetailArticle(l.article_id).then(function(e){200==e.statusCode&&e.response.success&&s(function(){a.$apply(function(){a.mediafile=e.response.result.mediafiles})},100)}))},a.reloadArticle=function(){l.article_id&&(a.details.article_feature=[],a.details.article_features_list=[],d.getDetailArticle(l.article_id).then(function(e){200==e.statusCode&&e.response.success&&(a.details=e.response.result,a.details.article_features_list=_.map(a.details.article_features,function(e){return null==e.bundle_id&&null!==e.product_id?{item_name:e.product_details.item_name,item_code:e.product_details.product_code,item_brand:e.product_details.brand,item_id:e.product_details.p_id}:null!==e.bundle_id&&null==e.product_id?{item_name:e.bundle_details.bundle_name,item_code:e.bundle_details.bundle_code,item_brand:e.bundle_details.bundle_brand,item_id:e.bundle_details.pb_id}:void 0}),a.details.article_feature=_.map(a.details.article_features,function(e){return null==e.bundle_id&&null!==e.product_id?{product_id:e.product_details.p_id,bundle_id:null,article_id:l.article_id}:null!==e.bundle_id&&null==e.product_id?{product_id:null,bundle_id:e.bundle_details.pb_id,article_id:l.article_id}:void 0}))}))},a.addToList=function(){"product"==a.radioModel?_.isUndefined(a.details.product)||_.isEmpty(a.details.product)||(_.find(a.details.article_features_list,{item_id:a.details.product.p_id})?r.warning("Product Item already existed","Warning"):(a.details.article_features_list.push({item_name:a.details.product.item_name,item_quantity:1,item_code:a.details.product.product_code,item_brand:a.details.product.brand,item_id:a.details.product.p_id}),a.details.article_feature.push({product_id:a.details.product.p_id,bundle_id:null,quantity:1,article_id:l.article_id}))):"productgroup"==a.radioModel&&(_.isUndefined(a.details.productgroup)||_.isEmpty(a.details.productgroup)||(_.find(a.details.article_features_list,{item_id:a.details.productgroup.pb_id})?r.warning("Bundle Item already existed","Warning"):(a.details.article_features_list.push({item_name:a.details.productgroup.bundle_name,item_quantity:1,item_code:a.details.productgroup.bundle_code,item_brand:a.details.productgroup.bundle_brand,item_id:a.details.productgroup.pb_id}),a.details.article_feature.push({bundle_id:a.details.productgroup.pb_id,product_id:null,quantity:1,article_id:l.article_id})))),a.details.product={},a.details.productgroup={}},a.minusbutton=function(e){e.quantity<1?e.quantity=0:e.quantity--,b(e)},a.addbutton=function(e){e.quantity++,b(e)},a.removeOnList=function(e){a.details.article_features_list.splice(e,1),a.details.article_feature.splice(e,1)},a.deleteAllMedia=function(){n.openConfirm({templateUrl:"modules/dialog/deleteAllDialog.html",scope:a,className:"ngdialog-theme-default"}).then(function(){l.article_id&&d.deleteAllArticleMedia(l.article_id).then(function(e){200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),i.reload()):r.error(e.response.msg,"Error")})})},a.deleteSelected=function(e){n.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:a,className:"ngdialog-theme-default"}).then(function(){console.log("media: ",e),l.article_id&&d.deleteArticleMediaFile(l.article_id,e._id).then(function(e){console.log("data:",e),200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),i.reload()):r.error(e.response.msg,"Error")})})},a.saveArticle=function(){async.waterfall([function(t){l.article_id?d.updateArticle(l.article_id,a.details).then(function(e){if(200==e.statusCode&&e.response.success)r.success(e.response.msg,"Success"),t(null,l.article_id);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void r.error(e.response.msg,"Error");_.each(e.response.result,function(e){r.warning(e.msg,"Warning")})}}):d.saveArticle(a.details).then(function(e){if(200==e.statusCode&&e.response.success)r.success(e.response.msg,"Success"),t(null,e.response.result);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void r.error(e.response.msg,"Error");_.each(e.response.result,function(e){r.warning(e.msg,"Warning")})}})},function(i,s){var l=1;0<a.details.tags.length?async.eachSeries(a.details.tags,function(e,t){e.isTag?u.saveTags(e).then(function(e){200==e.statusCode&&e.response.success?u.saveArticleTags(i,{tag_id:e.response.result}).then(function(e){200==e.statusCode&&e.response.success?(l++,t()):r.error(e.response.msg,"Error")}):r.error(e.response.msg,"Error")}):u.saveArticleTags(i,{tag_id:e.tags_id}).then(function(e){200==e.statusCode&&e.response.success?(l++,t()):r.error(e.response.msg,"Error")}),l>=a.details.tags.length&&s(null,i)}):s(null,i)},function(e,t){s(function(){i.go(i.current,{article_id:e},{reload:!0})},300)}])},a.tagTransform=function(e){return console.log(e),{tags:e}},a.clearInput=function(e){e.search=""},a.deleteProductTags=function(e){l.article_id&&u.deleteArticleTag(l.article_id,e.tags_id).then(function(e){200==e.statusCode&&e.response.success?r.success(e.response.msg,"Success"):r.error(e.response.msg,"Error")})},a.publishArticle=function(e){n.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:a,className:"ngdialog-theme-default"}).then(function(){d.publishArticle(e).then(function(e){200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),s(function(){i.reload()},1e3)):r.error(e.response.msg,"Error")})})},a.openUploader=function(){o.open({animation:!0,backdrop:"static",templateUrl:"./modules/articles/article.upload.modal.html",controller:"articleUploadModalCtrl",size:"lg",resolve:{article_id:function(){return l.article_id}}}).result.then(function(e){i.reload()},function(){})},a.showArticleMedia=function(){var e=a.details.media;e&&("image/jpeg"==e.media_mimetype?e.media=!1:"image/jpg"==e.media_mimetype?e.media=!1:"image/gif"==e.media_mimetype?e.media=!1:"image/x-ms-bmp"==e.media_mimetype?e.media=!1:"image/png"==e.media_mimetype?e.media=!1:"video/mp4"==e.media_mimetype?(e.media=!0,e.url="http://www.videogular.com/styles/themes/default/latest/videogular.css"):"video/x-flv"==e.media_mimetype?(e.media=!0,e.url="http://www.videogular.com/styles/themes/default/latest/videogular.css"):"video/x-msvideo"==e.media_mimetype?(e.media=!0,e.url="http://www.videogular.com/styles/themes/default/latest/videogular.css"):"video/x-ms-wmv"==e.media_mimetype?(e.media=!0,e.url="http://www.videogular.com/styles/themes/default/latest/videogular.css"):"video/quicktime"==e.media_mimetype&&(e.media=!0,e.url="http://www.videogular.com/styles/themes/default/latest/videogular.css"),s(function(){a.$apply(function(){a.mediaSource=e,a.details.thumbnail_media=e._id})},10))},a.openLightboxModal=function(e){var t=[];t.push({url:e.media_path,caption:e.media_name,thumbUrl:e.media_path}),p.openModal(t,0)},a.openVideoModal=function(e){o.open({animation:!0,backdrop:"static",templateUrl:"./modules/articles/article.media.modal.html",controller:"articleMediaModalCtrl",size:"lg",resolve:{files:function(){return e},type:function(){return"video"}}})},a.openAudioModal=function(e){o.open({animation:!0,backdrop:"static",templateUrl:"./modules/articles/article.media.modal.html",controller:"articleMediaModalCtrl",size:"md",resolve:{files:function(){return e},type:function(){return"audio"}}})},a.openDocsModal=function(e){o.open({animation:!0,backdrop:"static",templateUrl:"./modules/articles/article.docs.modal.html",controller:"articleDocsModalCtrl",size:"lg",windowClass:"presentation-modal-popup",resolve:{files:function(){return e}}})},a.copyURLLink=function(e){m.supported?(console.log("files.media_path: ",e.media_path),m.copyText(e.media_path)):r.warning("Sorry, copy to clipboard is not supported","Warning")}}angular.module("POS17").controller("articleDetailController",e),e.$inject=["$scope","$state","$filter","toastr","$timeout","$stateParams","articleFctry","ngTableParams","ngDialog","$uibModal","productFactory","tagsFactory","Lightbox","clipboard","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,t,r,o,s,a,i,n,l,c,u,d){var f=!(e.item={}),m=JSON.parse(u.get("user")),p=e.uploader=new o({url:s+a+"articlemedia/"+i,method:"PUT",headers:{Authorization:"Bearer "+l.getUserToken(),accesskey:m.subscriptionKey}});p.filters.push({name:"customFilter",fn:function(e,t){return this.queue.length<10}}),p.filters.push({name:"_isValidFile",fn:function(e,t){return!!function(e){var t=e.split(" ");if(0<t.length)return"mb"==t[1].toLowerCase()?parseFloat(t[0])<=2:"gb"!=t[1].toLowerCase()&&"tb"!=t[1].toLowerCase()&&("kb"==t[1].toLowerCase()||"bytes"==t[1].toLowerCase())}(function(e,t){if(0==e)return"0 Bytes";var r=t||2,o=Math.floor(Math.log(e)/Math.log(1e3));return parseFloat((e/Math.pow(1e3,o)).toFixed(r))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][o]}(e.size))||(d.error("File Size Limit Exceeded","Error"),!1)}}),p.onBeforeUploadItem=function(e){e.alias="media"},p.onErrorItem=function(e,t){400!=t.statusCode||t.success||(d.error(t.response.msg,"Error"),f=!0)},p.onCompleteAll=function(e){f||d.success("Media / File upload complete","Success"),n(function(){r.close(i)},1300)},e.cancel=function(){r.dismiss("cancel")}}angular.module("POS17").controller("articleUploadModalCtrl",e),e.$inject=["$scope","$state","$uibModalInstance","FileUploader","API_URL","API_VERSION","article_id","$timeout","AuthFctry","$stateParams","localStorageService","toastr"]}();
!function(){"use strict";function e(e,t,i,s,a,c){e.audio="audio"==c,e.config={sources:[{src:a.trustAsResourceUrl(s.media_path),type:s.media_mimetype}],theme:{url:"http://www.videogular.com/styles/themes/default/latest/videogular.css"}},e.cancel=function(){i.dismiss("cancel")}}function t(e,t,i,s,a,c){if(console.log("files: ",a),e.pdfName=a.media_name,e.file_type=a.media_mimetype,"application/pdf"==a.media_mimetype)e.pdfUrl=s.trustAsResourceUrl(a.media_path);else if("text/plain"==a.media_mimetype)e.pdfUrl=s.trustAsResourceUrl("https://docs.google.com/gview?url="+a.media_path+"&embedded=true");else{var l=encodeURI(a.media_path);e.pdfUrl=s.trustAsResourceUrl("https://view.officeapps.live.com/op/view.aspx?src="+l)}e.cancel=function(){i.dismiss("cancel")}}angular.module("POS17").controller("articleMediaModalCtrl",e).controller("articleDocsModalCtrl",t),e.$inject=["$scope","$state","$uibModalInstance","files","$sce","type"],t.$inject=["$scope","$state","$uibModalInstance","$sce","files","localStorageService"]}();
!function(){"use strict";function t(e,t,i,a,n){e.paginateNumber=0,e.pagination={currentPage:1,limitWithPage:10,totalPages:0,sumOfPages:0},e.auditlogs=[],e.generateActivityLogs=function(t){a.getArticleAuditLog(t,{startWith:e.paginateNumber,limit:e.pagination.limitWithPage}).then(function(t){200==t.statusCode&&t.response.success&&(e.auditlogs=t.response.result,e.pagination.totalPages=t.response.pagination.results,e.pagination.sumOfPages=t.response.pagination.pages)})},n&&e.generateActivityLogs(n),e.addMoreItems=function(){e.paginateNumber=e.pagination.currentPage-1,n&&e.generateActivityLogs(n)},e.filterDate=function(){},e.cancel=function(){i.dismiss("cancel")}}angular.module("POS17").controller("articleAuditLogModalCtrl",t),t.$inject=["$scope","$state","$uibModalInstance","articleFctry","article_id"]}();
!function(){"use strict";function t(l,t,e){console.log("articleExportsController"),l.currentDate=Date.now(),l.articles=[],l.IsExport=!1,t.getArticle().then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;_.isEmpty(e)||(l.articles=e)}else console.log(t.response.msg)}),l.myFunction=function(){l.IsExport=!0,angular.element(document).ready(function(){e(function(){console.log("basic-table"),$("#basic-table").trigger("footable_redraw")},1e3)})},l.export=function(){var t=Date.now()+"articles.pdf",o="{total_pages_count_string}",n=new jsPDF({orientation:"landscape",format:"a4"}),e=document.getElementById("basic-table"),a=n.autoTableHtmlToJson(e);n.autoTable(a.columns,a.data,{addPageContent:function(t){n.setFontSize(20),n.setTextColor(40),n.setFontStyle("normal"),n.text("Articles --- Date: "+moment(l.currentDate).format("MM/DD/YYYY hh:mm a"),t.settings.margin.left,15);var e="Page "+t.pageCount;"function"==typeof n.putTotalPages&&(e=e+" of "+o),n.setFontSize(10),n.text(e,t.settings.margin.left,n.internal.pageSize.height-5)},startY:20,margin:{top:30},styles:{overflow:"linebreak",columnWidth:"wrap"},columnStyles:{0:{columnWidth:60},1:{columnWidth:80},2:{columnWidth:90},3:{columnWidth:40}}}),"function"==typeof n.putTotalPages&&n.putTotalPages(o),n.save(t)}}angular.module("POS17").controller("articleExportsController",t),t.$inject=["$scope","articleFctry","$timeout"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(o,e){e.state("main.pricebook",{url:"/pricebook/overview",templateUrl:"modules/pricebook/pricebook.html",controller:"pricebookController"}).state("main.export-pricebook",{url:"/pricebook/exports",templateUrl:"modules/pricebook/pricebooks.exports-pdf.html",controller:"pricebookExportsController"}).state("main.pricebook-detail",{url:"/pricebook/:pricebook_id",templateUrl:"modules/pricebook/pricebook.detail.html",controller:"pricebookDetailController"})}])}();
!function(){"use strict";function e(n,p,e,u,t,d,o,s,i,l,r,a,c){n.name="-Type-",n.status="All",n.type={},n.expirepricebook=[],n.currentDate=new Date,n.count=0,n.selectDeselectAll=!1,n.selectedDatas=[],n.selectedToPublish=[],n.pricebooktype=[],n.tagsArr=[],n.tagsFilter=[],n.example8settings={showCheckAll:!1,showUncheckAll:!1,enableSearch:!0,scrollableHeight:"300px",scrollable:!0},n.cursorDisable="cursor: not-allowed;",n.reportFields={pricebook_id:"ID",name:"Name",description:"Description",valid_from:"Valid From",valid_until:"Valid Until",date_approved:"Date Approved",approved_by:"Approved By",created_by:"Created By",date_created:"Date Created",notify_me:"Notify",pricebook_type_id:"Type ID","pricebook_type_info.name":"Type Name","pricebook_type_info.description":"Type Description","pricebook_type_info._id":"Type UUID",_id:"UUID"};var f=o.getCurrentUser(),g=JSON.parse(f);function b(e){var t=e.split("."),o=parseInt(t[0]),s=parseInt(t[1]),i=parseInt(t[2]);return new Date(o,s-1,i)}function m(e,t){var o=e.replace(/-/g,"."),s=t.replace(/-/g,"."),i=new Date(b(s)),l=new Date(b(o));return Math.ceil(l.getTime()/864e5)-Math.ceil(i.getTime()/864e5)}i.logTransaction("View Pricebooks","PRICEBOOKS","ALL","User:="+g.username+" View all list of pricebooks"),p.getPricebookType().then(function(e){n.pricebooktype=[],200==e.statusCode&&e.response.success&&(n.pricebooktype=e.response.result)}),l.getAllTags().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;_.each(t,function(e){n.tagsArr.push({id:e.tags_id,label:e.tags,_id:e._id})})}else console.log(e.response.msg)});var h=function(){n.count++,n.pricebookLoading=!0,n.pricebooks=[],n.pricebookscopy=[],n.name="All",n.status="All",n.type={},n.txtSearch={text:""},n.pricebooksTable=new e({page:1,count:10,filter:n.txtSearch},{counts:[10,20,50,100],getData:function(a,c){p.getAllPricebook().then(function(e){if(200==e.statusCode&&e.response.success){var o;if(1==n.count&&(_.each(e.response.result,function(e){_.isNull(e.valid_until)||parseInt(m(e.valid_until,moment(n.currentDate).format("YYYY-MM-DD")))<0&&n.expirepricebook.push(e)}),0<n.expirepricebook.length&&async.each(n.expirepricebook,function(e,t){p.unpublishPricebook(e.pricebook_id,{isActive:0,date_approved:e.date_approved}).then(function(e){200==e.statusCode&&e.response.success?t():d.error(e.response.msg,"Error")})},function(e,t){h()})),o=e.response.result,n.pricebookscopy=angular.copy(e.response.result),c.filter().text&&"All"==n.status&&_.isEmpty(n.type)&&_.isEmpty(n.tagsFilter))console.log("1"),n.pricebooks=u("filter")(o,c.filter().text);else if(c.filter().text&&"Published"==n.status&&_.isEmpty(n.type)&&_.isEmpty(n.tagsFilter)){console.log("2");var s=u("filter")(o,c.filter().text);n.pricebooks=_.reject(s,{date_approved:null})}else if(c.filter().text&&"Draft"==n.status&&_.isEmpty(n.type)&&_.isEmpty(n.tagsFilter)){console.log("3");s=u("filter")(o,c.filter().text);n.pricebooks=_.filter(s,{date_approved:null})}else if(c.filter().text&&"All"==n.status&&n.type&&_.isEmpty(n.tagsFilter)){console.log("4");s=u("filter")(o,c.filter().text);n.pricebooks=_.filter(s,{pricebook_type_id:n.type.pt_id})}else if(c.filter().text&&"Published"==n.status&&n.type&&_.isEmpty(n.tagsFilter)){console.log("5");s=u("filter")(o,c.filter().text);var t=_.reject(s,{date_approved:null});n.pricebooks=_.filter(t,{pricebook_type_id:n.type.pt_id})}else if(c.filter().text&&"Draft"==n.status&&n.type&&_.isEmpty(n.tagsFilter)){console.log("6");s=u("filter")(o,c.filter().text),t=_.filter(s,{date_approved:null});n.pricebooks=_.filter(t,{pricebook_type_id:n.type.pt_id})}else if(c.filter().text&&"All"==n.status&&n.type&&n.tagsFilter){console.log("7");s=u("filter")(o,c.filter().text);var i=_.filter(s,{pricebook_type_id:n.type.pt_id}),l=[];n.tagsFilter&&0<n.tagsFilter.length&&_.each(n.tagsFilter,function(t){_.each(i,function(e){_.find(e.tags,{tags_id:t.id})&&l.push(e)})}),n.pricebooks=l}else if(_.isEmpty(c.filter().text)&&"All"==n.status&&_.isEmpty(n.type)&&_.isEmpty(n.tagsFilter))console.log("8"),n.pricebooks=o;else if(_.isEmpty(c.filter().text)&&"Published"==n.status&&_.isEmpty(n.type)&&_.isEmpty(n.tagsFilter))console.log("9"),n.pricebooks=_.reject(o,{date_approved:null});else if(_.isEmpty(c.filter().text)&&"Draft"==n.status&&_.isEmpty(n.type)&&_.isEmpty(n.tagsFilter))console.log("10"),n.pricebooks=_.filter(o,{date_approved:null});else if(_.isEmpty(c.filter().text)&&"All"==n.status&&n.type&&_.isEmpty(n.tagsFilter))console.log("11"),n.pricebooks=_.filter(o,{pricebook_type_id:n.type.pt_id});else if(_.isEmpty(c.filter().text)&&"Published"==n.status&&n.type&&_.isEmpty(n.tagsFilter)){console.log("12");s=_.reject(o,{date_approved:null});n.pricebooks=_.filter(s,{pricebook_type_id:n.type.pt_id})}else if(_.isEmpty(c.filter().text)&&"Draft"==n.status&&n.type&&_.isEmpty(n.tagsFilter)){console.log("13");s=_.filter(o,{date_approved:null});n.pricebooks=_.filter(s,{pricebook_type_id:n.type.pt_id})}else if(_.isEmpty(c.filter().text)&&"All"==n.status&&_.isEmpty(n.type)&&n.tagsFilter){console.log("14");l=[];n.tagsFilter&&0<n.tagsFilter.length&&_.each(n.tagsFilter,function(t){_.each(o,function(e){_.find(e.tags,{tags_id:t.id})&&l.push(e)})}),n.pricebooks=l}else if(_.isEmpty(c.filter().text)&&"Published"==n.status&&_.isEmpty(n.type)&&n.tagsFilter){console.log("15");s=_.reject(o,{date_approved:null}),l=[];n.tagsFilter&&0<n.tagsFilter.length&&_.each(n.tagsFilter,function(t){_.each(s,function(e){_.find(e.tags,{tags_id:t.id})&&l.push(e)})}),n.pricebooks=l}else if(_.isEmpty(c.filter().text)&&"Draft"==n.status&&_.isEmpty(n.type)&&n.tagsFilter){console.log("16");s=_.filter(o,{date_approved:null}),l=[];n.tagsFilter&&0<n.tagsFilter.length&&_.each(n.tagsFilter,function(t){_.each(s,function(e){_.find(e.tags,{tags_id:t.id})&&l.push(e)})}),n.pricebooks=l}else if(_.isEmpty(c.filter().text)&&"All"==n.status&&n.type&&n.tagsFilter){console.log("17");s=_.filter(o,{pricebook_type_id:n.type.pt_id}),l=[];n.tagsFilter&&0<n.tagsFilter.length&&_.each(n.tagsFilter,function(t){_.each(s,function(e){_.find(e.tags,{tags_id:t.id})&&l.push(e)})}),n.pricebooks=l}else if(_.isEmpty(c.filter().text)&&"Published"==n.status&&n.type&&n.tagsFilter){console.log("18");s=_.reject(o,{date_approved:null}),i=_.filter(s,{pricebook_type_id:n.type.pt_id}),l=[];n.tagsFilter&&0<n.tagsFilter.length&&_.each(n.tagsFilter,function(t){_.each(i,function(e){_.find(e.tags,{tags_id:t.id})&&l.push(e)})}),n.pricebooks=l}else if(_.isEmpty(c.filter().text)&&"Draft"==n.status&&n.type&&n.tagsFilter){console.log("19");s=_.filter(o,{date_approved:null}),i=_.filter(s,{pricebook_type_id:n.type.pt_id}),l=[];n.tagsFilter&&0<n.tagsFilter.length&&_.each(n.tagsFilter,function(t){_.each(i,function(e){_.find(e.tags,{tags_id:t.id})&&l.push(e)})}),n.pricebooks=l}else console.log("else"),n.pricebooks=o;n.selectedDatas&&0<n.selectedDatas.length&&_.each(n.pricebooks,function(t){_.find(n.selectedDatas,function(e){return e.pricebook_id===t.pricebook_id})&&(t.selected=!0)}),_.each(o,function(e){if(!_.isNull(e.valid_until)){var t=parseInt(m(e.valid_until,moment(n.currentDate).format("YYYY-MM-DD")));0<=t&&t<=3&&(e.left=t+" day(s) left",e.tooltip=!0,e.expiry=1)}}),c.total(n.pricebooks.length);var r=n.pricebooks.slice((c.page()-1)*c.count(),c.page()*c.count());n.pricebookLoading=!1,a.resolve(r)}else n.pricebookLoading=!1})}})};h(),n.selectEvents={onItemSelect:function(e){n.pricebooksTable.reload()},onItemDeselect:function(e){n.pricebooksTable.reload()}},n.refresh=function(){h()},n.changeSelectDeselectAll=function(){n.selectDeselectAll=!n.selectDeselectAll,_.each(n.pricebooks,function(e){e.selected=n.selectDeselectAll,n.deleteSomeData=n.selectDeselectAll,n.checkDataChanges(e)})},n.checkIfPublished=function(){return _.find(n.selectedDatas,function(e){return null!=e.date_approved})},n.checkIfDateISInRange_2=function(e){var t=moment(new Date).format("YYYY-MM-DD");return moment(t).isSameOrBefore(moment(e.valid_until).format("YYYY-MM-DD"))},n.checkIfDateISInRange=function(e){var t=moment(new Date).format("YYYY-MM-DD");return moment(t).isSameOrBefore(moment(e.valid_until).format("YYYY-MM-DD"))},n.checkDataChanges=function(t){t.selected?(_.find(n.selectedDatas,function(e){return e.pricebook_id===t.pricebook_id})||n.selectedDatas.push(t),_.isNull(t.date_approved)&&(_.find(n.selectedToPublish,function(e){return e.pricebook_id===t.pricebook_id})||n.selectedToPublish.push(t))):(n.selectedDatas=_.filter(n.selectedDatas,function(e){return e.pricebook_id!==t.pricebook_id}),n.selectedToPublish=_.filter(n.selectedToPublish,function(e){return e.pricebook_id!==t.pricebook_id})),n.deleteSomeData=0<n.selectedDatas.length,n.pusblishSomeData=0<n.selectedToPublish.length},n.updateStatus=function(e){console.log("updateStatus"),n.status=e,n.pricebooksTable.reload()},n.updateType=function(e){"All"!==e?(n.type=e,n.name=e.name):(n.name="All",n.type={}),n.pricebooksTable.reload()},n.searchData=function(){n.pricebooksTable.reload()},n.copyDuplicatePricebook=function(e){n.modal={title:"Copy/Duplicate Pricebook?",message:"Are you sure to Copy/Duplicate Pricebook?"},t.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){e.pricebook_id&&p.duplicatePriceBook(e.pricebook_id).then(function(e){200==e.statusCode&&e.response.success?(d.success(e.response.msg,"Success"),a(function(){c.reload()},1e3)):d.error(e.response.msg,"Error")})})},n.publishSelectedItem=function(e){n.checkIfDateISInRange(e)?(n.modal={title:"Publish Pricebook?",message:"Are you sure to Publish this selected pricebook?"},t.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){p.approvedPriceBook(e.pricebook_id,{approved_by:g.person_id}).then(function(e){200==e.statusCode&&e.response.success?(d.success(e.response.msg,"Success"),a(function(){c.reload()},1e3)):d.error(e.response.msg,"Error")})})):d.warning("Unable to Update : Pricebook is outdated.. Please Update Pricebook Date","Warning")},n.publishSelected=function(){if(0<n.selectedDatas.length){var o=[];_.some(n.selectedDatas,function(e){var t=n.checkIfDateISInRange_2(e);o.push(t)}),0<_.filter(o,function(e){return 0==e}).length?d.warning("Unable to Update : Some Pricebook are outdated. Please Update Pricebook Date","Warning"):(n.modal={title:"Publish Pricebook?",message:"Are you sure to Publish this selected pricebooks?"},t.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){var o=1;async.eachSeries(n.selectedDatas,function(e,t){e.selected&&p.approvedPriceBook(e.pricebook_id,{approved_by:g.person_id}).then(function(e){200==e.statusCode&&e.response.success?(d.success(e.response.msg,"Success"),o++,t()):d.error(e.response.msg,"Error")}),o==n.selectedDatas.length&&a(function(){c.reload()},1e3)})}))}},n.deleteSelected=function(){n.modal={title:"Delete Pricebook?",message:"Are you sure to Delete this selected pricebooks?"},t.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){var o=1;async.eachSeries(n.selectedDatas,function(e,t){e.selected&&p.deletePriceBook(e.pricebook_id).then(function(e){200==e.statusCode&&e.response.success?(d.success(e.response.msg,"Success"),o++,t()):d.error(e.response.msg,"Error")}),o==n.selectedDatas.length&&a(function(){c.reload()},1e3)})})},n.updateHistory=function(e){r.open({animation:!0,backdrop:"static",templateUrl:"./modules/pricebook/pricebook.auditlog.modal.html",controller:"pricebookAuditLogModalCtrl",size:"md",resolve:{pricebook_id:function(){return e}}})},n.toastWarning=function(e){switch(e){case"1":d.warning("Cant publish twice !","Warning");break;default:d.warning("Unable to process","Warning")}}}angular.module("POS17").controller("pricebookController",e),e.$inject=["$scope","pricebookFactory","ngTableParams","$filter","ngDialog","toastr","AuthFctry","localStorageService","transLogFctry","tagsFactory","$uibModal","$timeout","$state"]}();
!function(){"use strict";function e(i,e,o,s,n,r,a,t,c,l,d,u,p,m,g,f,b){console.log("pricebookDetailController");var h=s.getCurrentUser(),k=JSON.parse(h);i.tagselected=[],i.tags=[],i.tagsArr=[],i.tagschecked=[],i.customergroups=[],i.storesArr=[],i.details={},i.details.isActive=1,i.details.published=!1,i.details.stores=[],i.details.customergroups=[],i.details.tags=[],i.details.created_by=k.person_id,i.details.start_date=new Date,i.details.end_date=new Date,i.displayTab=!1,i.uniquePricebookName=!1,i.uniquePricebookType=!1,i.item={},i.selectDeselectAll2=!1,i.selectedDatas2=[],i.infiniteScrollContacts={},i.infiniteScrollContacts.numToAdd=20,i.infiniteScrollContacts.currentItems=20;h=JSON.parse(u.get("user"));a.pricebook_id?(i.displaySchedule=!0,p.logTransaction("View Pricebook Details","PRICEBOOKS",a.pricebook_id,"User:="+h.username+" View pricebook details: ="+a.pricebook_id)):(i.displaySchedule=!1,p.logTransaction("Add New Pricebook","PRICEBOOKS","N/A","User:="+h.username+" Add new pricebook entry")),o.getPricebookType().then(function(e){i.pricebooktype=[],e&&200==e.statusCode&&e.response.success&&(i.pricebooktype=e.response.result)}),l.getAllTags().then(function(e){e&&200==e.statusCode&&e.response.success?i.tagsArr=e.response.result:console.log(e.response.msg)}),g.getCustomerGroup().then(function(e){e&&200==e.statusCode&&e.response.success?i.customergroups=_.uniqBy(e.response.result,"cg_id"):console.log(e.response.msg)}),b.getAllStore().then(function(e){e&&200==e.statusCode&&e.response.success?i.storesArr=e.response.result:console.log(e.response.msg)}),async.waterfall([function(o){g.getAllPerson().then(function(e){if(e&&200==e.statusCode&&e.response.success){var s=e.response.result,t=_.filter(s,function(e){if("Customer"==e.person_type&&0==e.isSubscriber)return e});o(null,t)}else console.log(e.response.msg)})},function(t,o){f.getAllCompany().then(function(e){if(e&&200==e.statusCode&&e.response.success){var s=e.response.result;o(null,t,s)}else console.log(e.response.msg)})},function(e,s,t){var o=[];e&&0<e.length&&_.each(e,function(e){o.push({_id:e._id,email:e.email,id:e.person_id,type:"customer",name:e.displayName,pricebook_id:a.pricebook_id})}),s&&0<s.length&&_.each(s,function(e){o.push({_id:e._id,email:e.email,id:e.company_id,type:"company",name:e.name,pricebook_id:a.pricebook_id})}),i.customersData=o}]),a.pricebook_id&&(i.displayTab=!0,o.getPricebookDetail(a.pricebook_id).then(function(e){if(e&&200==e.statusCode&&e.response.success){var s=moment(new Date).format("YYYY-MM-DD");i.details=e.response.result,_.isNull(e.response.result.valid_until)||(i.expiryresult=moment(s).isSameOrAfter(moment(e.response.result.valid_from).format("YYYY-MM-DD"))&&moment(s).isSameOrBefore(moment(e.response.result.valid_until).format("YYYY-MM-DD")),i.expiryresult?o.unpublishPricebook(i.details.pricebook_id,{isActive:1,date_approved:i.details.date_approved}).then(function(e){200==e.statusCode&&e.response.success||n.error(e.response.msg,"Error")}):i.expiryresult||o.unpublishPricebook(i.details.pricebook_id,{isActive:0,date_approved:i.details.date_approved}).then(function(e){200==e.statusCode&&e.response.success||n.error(e.response.msg,"Error")})),i.details.published=null!=i.details.date_approved,i.details.customergroups=_.uniqBy(i.details.customergroup,"cg_id"),i.details.stores=_.uniqBy(i.details.stores,"store_id"),i.details.approved_by=i.details.published?k.person_id:null,l.getAllPricebookTags(a.pricebook_id).then(function(e){e&&200==e.statusCode&&e.response.success&&(i.details.tags=e.response.result)})}})),i.resetInfScroll=function(){i.infiniteScrollContacts.currentItems=i.infiniteScrollContacts.numToAdd},i.addMoreItems=function(){i.infiniteScrollContacts.currentItems+=i.infiniteScrollContacts.numToAdd},i.validatePricebookName=function(e){e&&o.validatePricebookName({name:e,pricebook_id:a.pricebook_id}).then(function(e){if(e&&200==e.statusCode&&!e.response.success)return i.uniquePricebookName=!0,void n.warning(e.response.msg,"Warning");i.uniquePricebookName=!1})},i.tagTransform=function(e){return{tags:e}},i.clearInput=function(e){e.search=""},i.changeSelectDeselectAll2=function(){i.selectDeselectAll2=!i.selectDeselectAll2,_.each(i.tagsArr,function(e){e.checked=i.selectDeselectAll2,i.checkDataChanges2(e)})},i.checkDataChanges2=function(s){s.checked?_.find(i.tagselected,function(e){return e.tags_id===s.tags_id})||i.tagselected.push(s):i.tagselected=_.filter(i.selectedDatas,function(e){return e.tags_id!==s.tags_id})},i.deleteProductTags=function(e){a.pricebook_id&&l.deleteArticleTag(a.pricebook_id,e.tags_id).then(function(e){e&&200==e.statusCode&&e.response.success?n.success(e.response.msg,"Success"):n.error(e.response.msg,"Error")})},i.savePricebook=function(){i.details.isActive=1==i.details.published?1:0,i.details.date_approved=i.details.published?moment().format("YYYY-MM-DD HH:mm:ss"):null,i.details.approved_by=i.details.published?k.person_id:null,i.details.customergroup=[],_.each(i.details.customergroups,function(e){i.details.customergroup.push({customer_group_id:e.cg_id})});var s=[];_.each(i.details.customers,function(e){s.push({customer_id:e.id,type:e.type})}),i.details.customers=s;var t=[];_.each(i.details.stores,function(e){t.push({store_id:e.store_id})}),i.details.stores=_.uniqBy(t,"store_id"),_.isNull(i.details.valid_from)&&!_.isNull(i.details.valid_until)?(console.log("WALAAI SULOD"),n.warning("Date from required when Date to is not empty","Warning")):(console.log("NAA"),async.waterfall([function(s){a.pricebook_id?i.details.valid_from=o.updatePriceBook(a.pricebook_id,{name:i.details.name,description:i.details.description,valid_from:moment(i.details.valid_from).format("YYYY-MM-DD HH:mm:ss"),valid_until:moment(i.details.valid_until).format("YYYY-MM-DD HH:mm:ss"),isActive:i.details.isActive,pricebook_type_id:i.details.pricebook_type_id,created_by:i.details.created_by,customergroup:i.details.customergroup,customers:i.details.customers,stores:i.details.stores,approved_by:i.details.approved_by,date_approved:i.details.date_approved}).then(function(e){e&&200==e.statusCode&&e.response.success?(n.success(e.response.msg,"Success"),s(null,a.pricebook_id)):n.error(e.response.msg,"Error")}):(i.details.valid_from=moment(i.details.valid_from).format("YYYY-MM-DD HH:mm:ss"),i.details.valid_until=moment(i.details.valid_until).format("YYYY-MM-DD HH:mm:ss"),o.savePricebook(i.details).then(function(e){e&&200==e.statusCode&&e.response.success?(n.success(e.response.msg,"Success"),s(null,e.response.result)):n.error(e.response.msg,"Error")}))},function(t,o){var r=1;0<i.details.tags.length?async.eachSeries(i.details.tags,function(e,s){e.isTag?l.saveTags(e).then(function(e){e&&200==e.statusCode&&e.response.success?l.savePricebookTags(t,{tag_id:e.response.result}).then(function(e){e&&200==e.statusCode&&e.response.success?(r++,s()):n.error(e.response.msg,"Error")}):n.error(e.response.msg,"Error")}):l.savePricebookTags(t,{tag_id:e.tags_id}).then(function(e){e&&200==e.statusCode&&e.response.success?(r++,s()):n.error(e.response.msg,"Error")}),r>=i.details.tags.length&&o(null,t)}):o(null,t)},function(e,s){m(function(){r.go(r.current,{pricebook_id:e},{reload:!0})},300)}]))}}angular.module("POS17").controller("pricebookDetailController",e),e.$inject=["$scope","productFactory","pricebookFactory","AuthFctry","toastr","$state","$stateParams","$filter","ngDialog","tagsFactory","$uibModal","localStorageService","transLogFctry","$timeout","humanFactory","companyFactory","storeFactory"]}();
!function(){"use strict";function e(s,r,e,c,o,t,i,n,a){function m(e,o,t,i,s){console.log("rangeX->",e),console.log("rangeY->",o),console.log("toCompareX->",t),console.log("toCompareY->",i);var r=parseInt(moment(e,["HH:mm A"]).format("HH:mm")),c=parseInt(moment(o,["HH:mm A"]).format("HH:mm")),n=parseInt(moment(t,["HH:mm A"]).format("HH:mm")),a=parseInt(moment(i,["HH:mm A"]).format("HH:mm"));return console.log("a->",r),console.log("b->",c),console.log("c->",n),console.log("d->",a),console.log("c>=a -> ",r<=n),console.log("c<=b -> ",n<=c),console.log("d>=a -> ",r<=a),console.log("d<=b -> ",a<=c),r<=n&&n<=c||r<=a&&a<=c?(console.log("yes true--\x3e"),!0):(console.log("false man gard--\x3e"),!1)}s.settings={default:function(){var e=new Date;return e.getHours(1),e.getMinutes(2),e}},s.settings1={default:function(){var e=new Date;return e.getHours(1),e.getHours(2),e}},s.example8model=[],s.example8data=[{id:1,label:"Accessories"},{id:2,label:"Headset"},{id:3,label:"Mobile Headset"},{id:4,label:"Wearables"}],s.days=[],s.isnotifyme=!1,s.startWith=0,s.limit=10,s.queryparams={startWith:s.startWith,limit:s.limit},s.pricebook_publish={},s.details=[],s.isToUpdate=!1,s.selectedSchedule={},s.pricebook={},s.selectedTime={},s.models={time1:new Date,time2:new Date,time3:new Date,format:"h:mm a",minTime:"9:00 am",maxTime:"9:00 pm",step:"15"},s.pricebook.days=[{id:1,label:"Monday"},{id:2,label:"Tuesday"},{id:3,label:"Wednesday"},{id:4,label:"Thursday"},{id:5,label:"Friday"},{id:6,label:"Saturday"},{id:7,label:"Sunday"},{id:8,label:"Everyday"}],s.pricebook.time_start=new Date,s.pricebook.time_end=new Date,s.hstep1=1,s.hstep2=1,s.mstep1=15,s.mstep2=15,s.options={hstep1:[1,2,3],mstep1:[1,5,10,15,25,30],hstep2:[1,2,3],mstep2:[1,5,10,15,25,30]},s.ismeridian=!0,s.toggleMode1=function(){s.ismeridian1=!s.ismeridian1},s.toggleMode2=function(){s.ismeridian2=!s.ismeridian2},s.update1=function(){var e=new Date;e.setHours(14),e.setMinutes(0),s.pricebook.time_start=e},s.update2=function(){var e=new Date;e.setHours(14),e.setMinutes(0),s.pricebook.time_end=e},s.changed1=function(e){s.pricebook.time_start=null,s.pricebook.time_start=e,a.log("Time changed to: "+s.pricebook.time_start)},s.changed2=function(e){s.pricebook.time_end=null,s.pricebook.time_end=e,a.log("Time changed to: "+s.pricebook.time_end)},s.clear1=function(){s.pricebook.time_start=null},s.clear2=function(){s.pricebook.time_end=null},s.filterDaysSelected=function(o){var e=_.filter(s.pricebook.days,function(e){return o===e.label});s.pricebook.days.selected=e[0]},s.getPricebookSched=function(){c.pricebook_id&&n.getPricebookSchedule(c.pricebook_id," ").then(function(e){_.each(e.response.result,function(e){e.time_end=moment(e.time_end,["hh:mm:ss"]).format("h:mm A"),e.time_start=moment(e.time_start,["hh:mm:ss"]).format("h:mm A")}),s.listOfSchedules=e.response.result})},s.getPriceBookDetails=function(){n.getPricebookDetail(c.pricebook_id).then(function(e){s.pricebook_details=e.response.result})},s.openScheduleModal=function(e){console.log("saodsad"),s.pricebook={},s.pricebook.time_start=new Date,s.pricebook.time_end=new Date,s.pricebook.days=[{id:1,label:"Monday"},{id:2,label:"Tuesday"},{id:3,label:"Wednesday"},{id:4,label:"Thursday"},{id:5,label:"Friday"},{id:6,label:"Saturday"},{id:7,label:"Sunday"},{id:8,label:"Everyday"}],s.pricebook.selectedTime={},s.pricebook.days.selected=s.pricebook.days[0],s.details.valid_from=new Date,s.details.valid_until=new Date,s.pricebook.time_start.setHours(8),s.pricebook.time_start.setMinutes(0),s.pricebook.time_end.setHours(17),s.pricebook.time_end.setMinutes(0),console.log("$scope.pricebook-=>",s.pricebook),t.openConfirm({templateUrl:"./modules/pricebook/pricebook.schedule.modal.html",scope:s,className:"ngdialog-theme-default",appendClassName:"ngdialog-custom",width:"40%"}).then(function(){console.log("$scope.listOfSchedules => ",s.listOfSchedules),s.pricebook.selectedDay=s.pricebook.days.selected,s.pricebook._id=c.pricebook_id;var e,o,t=(e=s.pricebook,(o={}).price_sched_day_id=e.selectedDay.id,o.time_start=moment(e.time_start,["HH:mm A"]).format("HH:mm:ss"),o.time_end=moment(e.time_end,["HH:mm A"]).format("HH:mm:ss"),o.notify_me=e.isnotifyme,o.is_active=e.isactive,o);console.log("pb ",t);var i={price_sched_day_id:s.pricebook.days.selected.id,time_end:moment(s.pricebook.time_end,["HH:mm A"]).format("H:mm A"),time_start:moment(s.pricebook.time_start,["HH:mm A"]).format("H:mm A")};console.log("objtocompare ",i),_.find(s.listOfSchedules,function(e){if(e.price_sched_day_id==s.pricebook.days.selected.id&&m(e.time_start.toString(),e.time_end.toString(),i.time_start,i.time_end))return e})?r.warning("Cant add same schedule","Warning"):(console.log(s.pricebook),n.createPricebookSchedule(s.pricebook._id,t).then(function(e){e&&e.response&&e.response.success?r.success(e.response.msg,"Success"):r.error(e.response.msg,"Error"),s.getPricebookSched()}))},function(e){console.log("Modal promise close: ")})},s.openScheduleModalForEdit=function(e){console.log("pricebookObj -> ",e),s.pricebook={},s.pricebook.days=[{id:1,label:"Monday"},{id:2,label:"Tuesday"},{id:3,label:"Wednesday"},{id:4,label:"Thursday"},{id:5,label:"Friday"},{id:6,label:"Saturday"},{id:7,label:"Sunday"},{id:8,label:"Everyday"}],s.pricebook.days.selected={id:e.price_sched_day_id,label:e.day_name},s.pricebook.is_active=e.is_active,s.pricebook.notify_me=e.notify_me,s.pricebook.price_sched_id=e.price_sched_id,s.pricebook.time_start=new Date,s.pricebook.time_end=new Date,s.pricebook.time_start.setHours(moment(e.time_start,["HH:mm A"]).format("HH")),s.pricebook.time_start.setMinutes(moment(e.time_start,["HH:mm A"]).format("mm")),s.pricebook.time_end.setHours(moment(e.time_end,["HH:mm A"]).format("HH")),s.pricebook.time_end.setMinutes(moment(e.time_end,["HH:mm A"]).format("mm")),t.openConfirm({templateUrl:"./modules/pricebook/pricebook.schedule.modalEdit.html",scope:s,className:"ngdialog-theme-default",appendClassName:"ngdialog-custom",width:"40%"}).then(function(){s.pricebook.time_start=moment(s.pricebook.time_start,["HH:mm A"]).format("HH:mm:ss"),s.pricebook.time_end=moment(s.pricebook.time_end,["HH:mm A"]).format("HH:mm:ss"),s.pricebook.selectedDay=s.pricebook.days.selected,s.pricebook.price_sched_day_id=s.pricebook.days.selected.id;var e=s.pricebook,o={price_sched_day_id:s.pricebook.days.selected.id,time_end:moment(s.pricebook.time_end,["HH:mm A"]).format("H:mm A"),time_start:moment(s.pricebook.time_start,["HH:mm A"]).format("H:mm A")},t=_.filter(s.listOfSchedules,function(e){return e.price_sched_id!=s.pricebook.price_sched_id});console.log("excludeSelectedSchedule ",t),console.log("$scope.listOfSchedules ",s.listOfSchedules),_.find(t,function(e){if(e.price_sched_day_id==s.pricebook.days.selected.id&&m(e.time_start.toString(),e.time_end.toString(),o.time_end,o.time_start))return e})?r.warning("Cant add same schedule","Warning"):n.updatepricebookSchedule(c.pricebook_id,e.price_sched_id,e).then(function(e){e&&e.response&&e.response.success?r.success(e.response.msg,"Success"):r.error(e.response.msg,"Error"),s.getPricebookSched()})},function(e){console.log("Modal promise close: ")})},s.deletePriceBookSched=function(e){t.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:s,className:"ngdialog-theme-default"}).then(function(){n.deletepricebookSchedule(c.pricebook_id,e).then(function(e){e&&e.response&&e.response.success?r.success(e.response.msg,"Success"):r.error(e.response.msg,"Error"),s.getPricebookSched()})},function(e){console.log("Modal promise close: ")})},s.toogle_notifyme=function(){s.isnotifyme},s.toggle_active=function(e){s.filterDaysSelected(e.day_name),e.selectedDay=s.pricebook.days.selected,console.log("-obj->",e);var o,t,i=((t={}).price_sched_day_id=(o=e).selectedDay.id,t.time_start=moment(o.time_start,["HH:mm A"]).format("HH:mm:ss"),t.time_end=moment(o.time_end,["HH:mm A"]).format("HH:mm:ss"),t.notify_me=o.notify_me,t.is_active=o.is_active,t.price_sched_id=o.price_sched_id,t);console.log("-pb->",i),n.updatepricebookSchedule(c.pricebook_id,i.price_sched_id,i).then(function(e){e&&e.response&&e.response.success?r.success(e.response.msg,"Success"):r.error(e.response.msg,"Error"),s.getPricebookSched()})},s.parseDateFormat=function(e){return moment(e).format("YYYY MMM DD")},s.init=function(){s.getPricebookSched(),s.getPriceBookDetails()},s.init()}angular.module("POS17").controller("pricebookAssignCtrl",e),e.$inject=["$scope","toastr","$state","$stateParams","$filter","ngDialog","$uibModal","pricebookFactory","$log"]}();
!function(){"use strict";function e(r,t,i,c,e,n,s,o,a,l,u,p,d){function m(e,t,o,s){var r,i=0;return"Amount"==s?i=(parseFloat(e)+parseFloat(t)-parseFloat(o)).toFixed(2):(r=parseFloat(e)+parseFloat(t),i=0==o?r.toFixed(2):(r-r*(parseFloat(o)/100)).toFixed(2)),i}console.log("pricebookProductCtrl"),r.products=[],r.productscopy=[],r.bundles=[],r.bundlescopy=[],r.pricebookItems=[],r.pricebookItemsCopy=[],r.selectedDatas=[],r.selectDeselectAllProduct=!1,r.txtProductSearch="",r.tagsArr=[],r.tagsFilter=[],r.example8settings={showCheckAll:!1,showUncheckAll:!1,enableSearch:!0,scrollableHeight:"300px",scrollable:!0},r.item={},l.getAllTags().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;_.each(t,function(e){r.tagsArr.push({id:e.tags_id,label:e.tags,_id:e._id})})}else console.log(e.response.msg)}),async.waterfall([function(t){r.productmodal=!0,n.pricebook_id?(r.pricebookItems=[],r.pricebookItemsCopy=[],i.getAllPriceBookItem(n.pricebook_id).then(function(e){200==e.statusCode&&e.response.success&&(r.pricebookItems=e.response.result,_.each(r.pricebookItems,function(e){e.popoverIsOpen=!1,e.selling_price=m(e.original_sell_price||0,e.markup||0,e.discount||0,e.discount_type)}),r.pricebookItemsCopy=angular.copy(r.pricebookItems),t(null))})):t(null)},function(e){e(null)},function(e){t.getAllProductBundle().then(function(e){200==e.statusCode&&e.response.success&&(r.bundles=e.response.result,r.productmodal=!1)})}]),r.selectEvents={onItemSelect:function(e){console.log("property: ",e),r.searchProductData()},onItemDeselect:function(e){console.log("property: ",e),r.searchProductData()}},r.tagTransform=function(e){return{tags:e}},r.showTooltip1=function(t){_.each(r.pricebookItems,function(e){t.pi_id!==e.pi_id?e.popoverIsOpen=!1:e.sell_price=m(e.original_sell_price||0,e.markup||0,e.discount||0,e.discount_type)});var e=_.find(r.pricebookItems,{pi_id:t.pi_id});e&&(e.popoverIsOpen?e.popoverIsOpen=!1:e.popoverIsOpen=!0)},r.onCalculateRowPrice=function(t){_.each(r.pricebookItems,function(e){t.pi_id==e.pi_id&&(e.selling_price=m(e.original_sell_price||0,e.markup||0,e.discount||0,e.discount_type),e.sell_price=e.selling_price)})},r.onCalculatePrice=function(){r.product.selling_price=m(r.product.sell_price||0,r.product.markup||0,r.product.discount||0,r.product.discount_type)},r.applyItemPrice=function(t){console.log("data:",t),_.isEmpty(t)||n.pricebook_id&&i.updatePriceBookItemPrice(n.pricebook_id,t.pi_id,{sell_price:t.selling_price,markup:t.markup,discount:t.discount,discount_type:t.discount_type,min_quantity:t.min_quantity,max_quantity:t.max_quantity,product_variant_id:t.product_variant_id}).then(function(e){200==e.statusCode&&e.response.success?(c.success(e.response.msg,"Success"),t.popoverIsOpen=!1):c.error(e.response.msg,"Error")})},r.searchProductData=function(){if(r.txtProductSearch&&_.isEmpty(r.tagsFilter))r.pricebookItems=s("filter")(r.pricebookItems,r.txtProductSearch),r.searchcopy=angular.copy(r.pricebookItems);else if(_.isEmpty(r.txtProductSearch)&&0<r.tagsFilter.length){var o=[];r.tagsFilter&&0<r.tagsFilter.length&&_.each(r.tagsFilter,function(t){_.each(r.pricebookItemsCopy,function(e){_.find(e.product_tags,{tags_id:t})&&o.push(e)})}),r.pricebookItems=o}else if(_.isEmpty(r.txtProductSearch)||_.isEmpty(r.tagsFilter))r.refreshData();else{o=[];r.tagsFilter&&0<r.tagsFilter.length&&_.each(r.tagsFilter,function(t){_.each(r.searchcopy,function(e){_.find(e.product_tags,{tags_id:t})&&o.push(e)})}),r.pricebookItems=o}},r.changeSelectDeselectAllProduct=function(){_.each(r.pricebookItems,function(e){e.selected=r.selectDeselectAllProduct,r.checkDataChanges(e)})},r.clickselect=function(){console.log("sadasdsadsa")},r.checkDataChanges=function(t){t.selected?_.find(r.selectedDatas,function(e){return e.pi_id===t.pi_id})||r.selectedDatas.push(t):r.selectedDatas=_.filter(r.selectedDatas,function(e){return e.pi_id!==t.pi_id})},r.refreshData=function(){r.pricebookItems=[],r.pricebookItemsCopy=[],i.getAllPriceBookItem(n.pricebook_id).then(function(e){200==e.statusCode&&e.response.success&&(r.pricebookItems=e.response.result,_.each(r.pricebookItems,function(e){e.popoverIsOpen=!1,e.selling_price=m(e.original_sell_price,e.markup||0,e.discount||0,e.discount_type)}),r.pricebookItemsCopy=angular.copy(r.pricebookItems))})},r.addNewEntry=function(){a.open({animation:!0,templateUrl:"./modules/pricebook/pricebook.product.modal.html",controller:"pricebookProductModalCtrl",size:"md",resolve:{products:function(){return r.products},bundles:function(){return r.bundles}}}).result.then(function(e){r.refreshData()})},r.deleteSelected=function(){r.modal={title:"Remove Items on Pricebook?",message:"Are you sure to remove pricebook for this selected product?"},o.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){if(0<r.selectedDatas.length){if(n.pricebook_id){async.each(r.selectedDatas,function(e,t){e.pi_id&&i.deletePriceBookItem(n.pricebook_id,e.pi_id).then(function(e){200==e.statusCode&&e.response.success?t(null):c.error(e.response.msg,"Error")})},function(e,t){c.success("Records Successfully Deleted","Success"),r.selectDeselectAllProduct=!1,r.refreshData()})}}else c.error("Please select products to map","Error")})},r.deleteSelectedItem=function(e){r.modal={title:"Remove Pricebook Item?",message:"Are you sure to remove this item?"},o.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){n.pricebook_id&&i.deletePriceBookItem(n.pricebook_id,e.pi_id).then(function(e){200==e.statusCode&&e.response.success?(c.success(e.response.msg,"Success"),r.refreshData()):c.error(e.response.msg,"Error")})})},r.savePricebookItems=function(e){_.isEmpty(e)?c.error("Please set values for Selling Price, Margin and Discount","Error"):parseInt(e.min_quantity)>parseInt(e.max_quantity)?c.warning("The Minimum quality must not greater than maximum quality","Warning!"):0<r.selectedDatas.length?(r.modal={title:"Apply batch update",message:"Are you sure to apply this change on the selected product?"},o.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){var s;s=e,n.pricebook_id&&async.each(r.selectedDatas,function(e,t){var o={};o.bundle_id=e.bundle_id,o.product_id=e.product_id,o.min_quantity=_.isUndefined(s.min_quantity)?e.min_quantity:s.min_quantity,o.max_quantity=_.isUndefined(s.max_quantity)?e.max_quantity:s.max_quantity,o.markup=_.isUndefined(s.margin)?e.markup:s.margin,o.discount=_.isUndefined(s.discount)?e.discount:s.discount,o.discount_type=e.discount_type,o.product_variant_id=e.product_variant_id,o.sell_price=m(e.original_sell_price,o.markup,o.discount,o.discount_type),e.pi_id?i.updatePriceBookItem(n.pricebook_id,e.pi_id,o).then(function(e){200==e.statusCode&&e.response.success?t(null,e.response.msg):c.error(e.response.msg,"Error")}):i.savePriceBookItem(n.pricebook_id,o).then(function(e){200==e.statusCode&&e.response.success?t(null,e.response.msg):c.error(e.response.msg,"Error")})},function(e,t){c.success("Record Successfully Update","Success"),r.item.discount=void 0,r.item.margin=void 0,r.item.max_quantity=void 0,r.item.min_quantity=void 0,r.selectedDatas=[],r.refreshData()})})):c.error("Please select items to map","Error")},r.importPricebookProduct=function(e){if("csv"==e){var o=a.open({animation:!0,backdrop:"static",size:"sm",templateUrl:"modules/dialog/importProductInPricebook.modal.html",scope:r});o.result.then(function(){},function(){}),r.uploadPricebookProducts=function(){angular.forEach(r.files,function(t){t.upload=p.upload({url:d.configuration.baseUrl+"/pricebook/"+n.pricebook_id+"/importcsv",data:{file:t}}),t.upload.then(function(e){u(function(){t.result=e.data,200==e.status?(c.success(e.data.response.msg,"Success"),r.files=[],r.progressState=0,o.dismiss("close")):500==e.status?(r.files=[],r.progressState=0,c.error(e.data.response.msg,"Error")):(r.files=[],r.progressState=0,c.warning(e.data.response.msg,"Error")),r.refreshData()})},function(e){0<e.status&&(r.errorMsg=e.status+": "+e.data)},function(e){t.progress=Math.min(100,parseInt(100*e.loaded/e.total)),r.progressState=Math.min(100,parseInt(100*e.loaded/e.total))})})},r.cancel=function(){o.dismiss("close"),r.files=[],r.progressState=0}}},r.importPricebookProductByCategoryId=function(e){if("csv"==e){var o=a.open({animation:!0,backdrop:"static",size:"sm",templateUrl:"modules/dialog/importProductInPricebookByCategory.modal.html",scope:r});o.result.then(function(){},function(){}),r.uploadPricebookProductByCategoryId=function(){angular.forEach(r.files,function(t){t.upload=p.upload({url:d.configuration.baseUrl+"/pricebook/"+n.pricebook_id+"/importitemsbycategorycsv",data:{file:t}}),t.upload.then(function(e){u(function(){t.result=e.data,200==e.status?(c.success(e.data.response.msg,"Success"),r.files=[],r.progressState=0,o.dismiss("close")):500==e.status?(r.files=[],r.progressState=0,c.error(e.data.response.msg,"Error")):(r.files=[],r.progressState=0,c.warning(e.data.response.msg,"Error")),r.refreshData()})},function(e){0<e.status&&(r.errorMsg=e.status+": "+e.data)},function(e){t.progress=Math.min(100,parseInt(100*e.loaded/e.total)),r.progressState=Math.min(100,parseInt(100*e.loaded/e.total))})})},r.cancel=function(){o.dismiss("close"),r.files=[],r.progressState=0}}},r.setUploadFile=function(e,t,o,s){"csv"==e[0].name.split(".")[e[0].name.split(".").length-1]?(r.files=e,r.errFiles=t,r.param=o,r.classification=s):(c.warning("Format of the choosen File is invalid, please choose CSV file","Warning"),r.files=[])}}angular.module("POS17").controller("pricebookProductCtrl",e),e.$inject=["$scope","productFactory","pricebookFactory","toastr","$state","$stateParams","$filter","ngDialog","$uibModal","tagsFactory","$timeout","Upload","Restangular"]}();
!function(){"use strict";function t(e,o,t,r,c,u,n,p,i,d){console.log("products;",t),console.log("bundles;",r),e.showMore=function(){console.log("SHOW")},e.pb_product={},e.pb_product.markup=0,e.pb_product.discount=0,e.pb_product.min_quantity=0,e.pb_product.max_quantity=0,e.pb_product.product_variant_id=null,e.discountchoose=!0,e.pricebookProducts=[],e.pricebookProductBundles=[],e.allCategory=[],e.productcatBelong=[],e.radioModel="product",e.pb_product.DiscountModel="Amount",e.infiniteScrollContacts={},e.infiniteScrollContacts.numToAdd=10,e.infiniteScrollContacts.currentItems=10,d.getAllCategory().then(function(t){200==t.statusCode&&t.response.success&&(e.allCategory=t.response.result)}),e.$watch("pb_product.product",function(t){t&&(e.pb_product.product_variant_id=t.variant_id?t.variant_id:null,e.pb_product.sell_price=t.variant_id?t.variant_sell_price:t.product_sell_price,e.pb_product.selling_price=e.calculateSellingPrice(t.variant_id?t.variant_sell_price:t.product_sell_price,e.pb_product.markup||0,e.pb_product.discount||0))}),e.$watch("pb_product.productgroup",function(t){t&&(e.pb_product.sell_price=t.sell_price,e.pb_product.selling_price=e.calculateSellingPrice(t.sell_price,e.pb_product.markup||0,e.pb_product.discount||0))}),e.$watch("pb_product.productcategory",function(o){o&&o.label&&(e.productcatBelong=_.filter(e.products,function(t){if(0<t.product_category.length)return _.some(t.product_category,function(t){return t.category_label==o.label})}))}),0<t.length&&(_.each(t,function(t){t.selected=!1,1==t.product_is_published&&e.pricebookProducts.push(t)}),_.uniqBy(e.pricebookProducts,function(t){return t.p_id})),0<r.length&&(_.each(r,function(t){t.selected=!1,1==t.is_published&&e.pricebookProductBundles.push(t)}),_.uniqBy(e.pricebookProductBundles,function(t){return t.pb_id})),e.calculateSellingPrice=function(t,o,r){var c=0,u=parseFloat(t)+parseFloat(o);if("Amount"==e.pb_product.DiscountModel)e.discountchoose=!0,c=(u-parseFloat(r)).toFixed(2);else{if(0==r)c=u.toFixed(2);else c=(u-u*(parseFloat(r)/100)).toFixed(2);e.discountchoose=!1}return c},e.discountOpt=function(){e.onCalculatePrice()},e.onCalculatePrice=function(){e.pb_product.selling_price=e.calculateSellingPrice(e.pb_product.sell_price||0,e.pb_product.markup||0,e.pb_product.discount||0)},e.resetInfScroll=function(){e.infiniteScrollContacts.currentItems=e.infiniteScrollContacts.numToAdd};var s={offset:0,limit:0};e.uniq_products1=[],e.uniq_products2=[],e.merge_products=[],e.addMoreItems=function(){s.limit+=10,e.uniq_products1=[],e.uniq_products2=[],e.merge_products=[],u.getProductAndVariants(s).then(function(t){e.tmpA=_.filter(t.response.result.result,function(t){return null!=t.inventory_id}),e.tmpB=_.each(e.tmpA,function(t,o){t.magicId=o}),e.uniq_products1=_.uniqBy(_.filter(e.tmpB,function(t){return null!=t.variant_id}),"variant_id"),e.uniq_products2=_.filter(e.tmpB,function(t){return null==t.variant_id}),e.tmpC=_.uniqBy(_.concat(e.uniq_products1,e.uniq_products2),"magicId"),e.products=_.uniqBy(e.tmpC,"product_name_variant")})},e.addMoreItems(),e.addMoreItems2=function(){e.infiniteScrollContacts.currentItems+=e.infiniteScrollContacts.numToAdd},e.changeData=function(t){e.radioModel=t,e.infiniteScrollContacts.numToAdd=10,e.infiniteScrollContacts.currentItems=10,"product"==t?(e.pb_product.product=void 0,e.pb_product.productgroup=void 0,e.pb_product.productcategory=void 0):"productgroup"==t?(e.pb_product.product=void 0,e.pb_product.productgroup=void 0,e.pb_product.productcategory=void 0):"productcategory"==t&&(e.pb_product.product=void 0,e.pb_product.productgroup=void 0,e.pb_product.productcategory=void 0),e.pb_product.sell_price=0,e.pb_product.markup=0,e.pb_product.discount=0,e.pb_product.min_quantity=0,e.pb_product.max_quantity=0,e.pb_product.selling_price=""},e.saveEntry=function(){if(_.isUndefined(e.pb_product.product)&&_.isUndefined(e.pb_product.productgroup))if(_.isUndefined(e.pb_product.productcategory))"product"==e.radioModel?c.error("Please Provide Products","Error"):c.error("Please Provide Products Group","Error");else{t={action:1,category_id:e.pb_product.productcategory.c_id,markup:e.pb_product.markup,discount:e.pb_product.discount,discount_type:e.pb_product.DiscountModel,min_quantity:e.pb_product.min_quantity,max_quantity:e.pb_product.max_quantity};i.savePriceBookItem(p.pricebook_id,t).then(function(t){if(200==t.statusCode&&t.response.success)c.success(t.response.msg,"Success"),n(function(){o.close()},100);else{if(400!==t.statusCode||t.response.success||!_.isArray(t.response.result))return 200===t.statusCode&&!t.response.success&&t.response.result?void c.warning(t.response.msg,"Warning"):void c.error(t.response.msg,"Error");_.each(t.response.result,function(t){c.warning(t.msg,"Warning")})}})}else{"product"==e.radioModel?(e.pb_product.product_id=e.pb_product.product.product_id,e.pb_product.bundle_id=null):(e.pb_product.bundle_id=e.pb_product.productgroup.pb_id,e.pb_product.product_id=null);var t={markup:e.pb_product.markup,discount:e.pb_product.discount,discount_type:e.pb_product.DiscountModel,sell_price:parseFloat(e.pb_product.selling_price),min_quantity:e.pb_product.min_quantity,max_quantity:e.pb_product.max_quantity,bundle_id:e.pb_product.bundle_id,product_id:e.pb_product.product_id,product_variant_id:e.pb_product.product_variant_id,action:0};i.savePriceBookItem(p.pricebook_id,t).then(function(t){if(200==t.statusCode&&t.response.success)c.success(t.response.msg,"Success"),n(function(){o.close()},100);else{if(400!==t.statusCode||t.response.success||!_.isArray(t.response.result))return void c.error(t.response.msg,"Error");_.each(t.response.result,function(t){c.warning(t.msg,"Warning")})}})}},e.cancel=function(){o.dismiss("cancel")},e.dhan=function(t,o){console.log("item ",t),console.log("model ",o)}}angular.module("POS17").controller("pricebookProductModalCtrl",t),t.$inject=["$scope","$uibModalInstance","products","bundles","toastr","productFactory","$timeout","$stateParams","pricebookFactory","categoryFactory"]}();
!function(){"use strict";function t(e,t,i,a,n){e.paginateNumber=0,e.pagination={currentPage:1,limitWithPage:10,totalPages:0,sumOfPages:0},e.auditlogs=[],e.generateActivityLogs=function(t){a.getPricebookAuditLog(t,{startWith:e.paginateNumber,limit:e.pagination.limitWithPage}).then(function(t){200==t.statusCode&&t.response.success&&(e.auditlogs=t.response.result,e.totalPages=t.response.pagination.pages)})},n&&e.generateActivityLogs(n),e.addMoreItems=function(){e.paginateNumber=e.pagination.currentPage-1,n&&e.generateActivityLogs(n)},e.filterDate=function(){},e.cancel=function(){i.dismiss("cancel")}}angular.module("POS17").controller("pricebookAuditLogModalCtrl",t),t.$inject=["$scope","$state","$uibModalInstance","pricebookFactory","pricebook_id"]}();
!function(){"use strict";function t(l,t,o){console.log("pricebookExportsController"),l.currentDate=Date.now(),l.pricebooks=[],l.IsExport=!1,t.getAllPricebook().then(function(t){if(200==t.statusCode&&t.response.success){var o=t.response.result;_.isEmpty(o)||(l.pricebooks=o)}else console.log(t.response.msg)}),l.myFunction=function(){l.IsExport=!0,angular.element(document).ready(function(){o(function(){console.log("basic-table"),$("#basic-table").trigger("footable_redraw")},1e3)})},l.export=function(){var t=Date.now()+"pricebooks.pdf",e="{total_pages_count_string}",n=new jsPDF({orientation:"landscape",format:"a4"}),o=document.getElementById("basic-table"),a=n.autoTableHtmlToJson(o);n.autoTable(a.columns,a.data,{addPageContent:function(t){n.setFontSize(20),n.setTextColor(40),n.setFontStyle("normal"),n.text("Pricebooks --- Date: "+moment(l.currentDate).format("MM/DD/YYYY hh:mm a"),t.settings.margin.left,15);var o="Page "+t.pageCount;"function"==typeof n.putTotalPages&&(o=o+" of "+e),n.setFontSize(10),n.text(o,t.settings.margin.left,n.internal.pageSize.height-5)},startY:20,margin:{top:30},styles:{overflow:"linebreak",columnWidth:"wrap"},columnStyles:{0:{columnWidth:50},1:{columnWidth:20},2:{columnWidth:50},3:{columnWidth:30},4:{columnWidth:30},5:{columnWidth:30},6:{columnWidth:30},7:{columnWidth:30}}}),"function"==typeof n.putTotalPages&&n.putTotalPages(e),n.save(t)}}angular.module("POS17").controller("pricebookExportsController",t),t.$inject=["$scope","pricebookFactory","$timeout"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(o,e){e.state("main.pricebooktype",{url:"/pricebooktype",templateUrl:"modules/pricebook_type/pricebook_type.html",controller:"priceBookTypeController"}).state("main.pricebookassoctype",{url:"/pricebook_type_assoc",templateUrl:"modules/pricebook_type/pricebook_type_assoc.html",controller:"priceBookAssocTypeController"})}])}();
!function(){"use strict";function e(a,t,e,s,l,o,c,n,r,i,p){console.log("priceBookTypeController"),a.selectDeselectAll=!1,a.selectedDatas=[];var u=JSON.parse(i.get("user"));p.logTransaction("View Pricebook Types","PRICEBOOK TYPES","ALL","User:="+u.username+" View all list of pricebook types"),a.populateData=function(){a.attribisLoading=!0,a.pricebooktypes=[],a.attributecopy=[],a.searchText={value:""},a.priceBookTypeTable=new n({page:1,count:10,filter:a.searchText},{counts:[10,25,50,100],getData:function(s,l){r.getAllPriceBookType().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;_.each(t,function(e){e.date_created=moment(e.date_created).format("YYYY-MM-DD")}),a.attributecopy=angular.copy(t),l.filter().value?(a.pricebooktypes=c("filter")(t,l.filter().value),console.log("diri",a.pricebooktypes)):a.pricebooktypes=t,a.selectedDatas&&0<a.selectedDatas.length&&_.each(a.pricebooktypes,function(t){_.find(a.selectedDatas,function(e){return e.pt_id===t.pt_id})&&(t.selected=!0)}),l.total(a.pricebooktypes.length);var o=a.pricebooktypes.slice((l.page()-1)*l.count(),l.page()*l.count());s.resolve(o),a.attribisLoading=!1}else a.attribisLoading=!1,console.log(e.response.msg)})}})},a.refresh=function(){a.attribisLoading=!0,a.priceBookTypeTable.reload()},a.searchData=function(){a.priceBookTypeTable.reload()},a.changeSelectDeselectAll=function(){a.selectDeselectAll=!a.selectDeselectAll,_.each(a.pricebooktypes,function(e){e.selected=a.selectDeselectAll,a.deleteSomeData=a.selectDeselectAll,a.checkDataChanges(e)})},a.checkDataChanges=function(t){t.selected?_.find(a.selectedDatas,function(e){return e.pt_id===t.pt_id})||a.selectedDatas.push(t):a.selectedDatas=_.filter(a.selectedDatas,function(e){return e.pt_id!==t.pt_id}),a.deleteSomeData=0<a.selectedDatas.length},a.deleteSelected=function(){e.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:a,className:"ngdialog-theme-default"}).then(function(){var o=0;async.eachSeries(a.selectedDatas,function(e,t){e.selected&&r.deletePriceBookType(e.pt_id).then(function(e){if(console.log("data ",e),e&&e.response&&e.response.result&&e.response.result.warning_msg)s.warning(e.response.result.warning_msg,"Warning");else{if(200!=e.statusCode||!e.response.success)return void s.error(e.response.msg,"Error");s.success(e.response.msg,"Success"),++o==a.selectedDatas.length&&l.reload(),t()}})})})},a.addNewEntry=function(e){t.open({animation:!0,templateUrl:"./modules/pricebook_type/pricebook_type.modal.html",controller:"priceBookTypeModal",size:"md",resolve:{group:function(){return e}}}).result.then(function(e){console.log("selectedItem: ",e),"save"==e&&l.reload()})}}angular.module("POS17").controller("priceBookTypeController",e),e.$inject=["$scope","$uibModal","ngDialog","toastr","$state","$timeout","$filter","ngTableParams","pricebookFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(s,e,o,c,n,t,i,r,u){s.group={};var a=JSON.parse(r.get("user"));e.article_id?u.logTransaction("View Pricebook Type Details","PRICEBOOK TYPES",e.article_id,"User:="+a.username+" View Pricebook Type details:="+e.article_id):u.logTransaction("Add New Pricebook Type","PRICEBOOK TYPES","N/A","User:="+a.username+" Add new Pricebook Type entry"),_.isUndefined(t)||i.getPriceBookType(t).then(function(e){200==e.statusCode&&e.response.success&&(s.group=e.response.result)}),s.savePriceBook=function(){_.isUndefined(t)?i.savePriceBookType(s.group).then(function(e){200==e.statusCode&&e.response.success&&(n.success("Successfully Added","Success"),c(function(){s.$apply(function(){o.close("save")})},100))}):i.updatePriceBookType(t,s.group).then(function(e){200==e.statusCode&&e.response.success&&(n.success("Successfully Update","Success"),c(function(){s.$apply(function(){o.close("save")})},100))})},s.cancel=function(){o.dismiss("cancel")}}angular.module("POS17").controller("priceBookTypeModal",e),e.$inject=["$scope","$stateParams","$uibModalInstance","$timeout","toastr","group","pricebookFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(c,t,e,s,a,o,l,n,i,r,p){c.selectDeselectAll=!1,c.selectedDatas=[];var d=JSON.parse(r.get("user"));p.logTransaction("View Pricebook Association Type","PRICEBOOK ASSOCIATION","ALL","User:="+d.username+" View all list of pricebook association types"),c.populateData=function(){c.attribisLoading=!0,c.pricebooktypes=[],c.attributecopy=[],c.txtSearch={text:""},c.priceBookTypeTable=new n({page:1,count:10,filter:c.txtSearch},{counts:[10,25,50,100],getData:function(s,a){i.getAllPriceBookAssociation().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;_.each(t,function(e){e.date_created=moment(e.date_created).format("YYYY-MM-DD")}),c.attributecopy=angular.copy(t),a.filter().text?c.pricebooktypes=l("filter")(t,a.filter().text):c.pricebooktypes=t,c.selectedDatas&&0<c.selectedDatas.length&&_.each(c.pricebooktypes,function(t){_.find(c.selectedDatas,function(e){return e.pat_id===t.pat_id})&&(t.selected=!0)}),a.total(c.pricebooktypes.length);var o=c.pricebooktypes.slice((a.page()-1)*a.count(),a.page()*a.count());s.resolve(o),c.attribisLoading=!1}else c.attribisLoading=!1,console.log(e.response.msg)})}})},c.refresh=function(){c.attribisLoading=!0,c.priceBookTypeTable.reload()},c.searchData=function(){c.attribisLoading=!0,c.priceBookTypeTable.reload()},c.changeSelectDeselectAll=function(){c.selectDeselectAll=!c.selectDeselectAll,_.each(c.pricebooktypes,function(e){e.selected=c.selectDeselectAll,c.deleteSomeData=c.selectDeselectAll,c.checkDataChanges(e)})},c.checkDataChanges=function(t){t.selected?_.find(c.selectedDatas,function(e){return e.pat_id===t.pat_id})||c.selectedDatas.push(t):c.selectedDatas=_.filter(c.selectedDatas,function(e){return e.pat_id!==t.pat_id}),c.deleteSomeData=0<c.selectedDatas.length},c.deleteSelected=function(){console.log("$scope.selectedDatas: ",c.selectedDatas),e.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:c,className:"ngdialog-theme-default"}).then(function(){var o=0;async.eachSeries(c.selectedDatas,function(e,t){e.selected&&i.deletePriceBookAssociation(e.pat_id).then(function(e){console.log("data: ",e.response),200==e.statusCode&&e.response.success?(s.success(e.response.msg,"Success"),++o==c.selectedDatas.length&&a.reload(),t()):s.error(e.response.msg,"Error")})})})},c.addNewEntry=function(e){t.open({animation:!0,templateUrl:"./modules/pricebook_type/pricebook_type_assoc.modal.html",controller:"priceBookAssocTypeModal",size:"md",resolve:{group:function(){return e}}}).result.then(function(e){console.log("selectedItem: ",e),"save"==e&&a.reload()})}}angular.module("POS17").controller("priceBookAssocTypeController",e),e.$inject=["$scope","$uibModal","ngDialog","toastr","$state","$timeout","$filter","ngTableParams","pricebookFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";function s(e,o,c,n,s,i,t,u){e.group={};var a=JSON.parse(t.get("user"));_.isNull(s)?u.logTransaction("Add New Pricebook Association Type","PRICEBOOK ASSOCIATION","N/A","User:="+a.username+" Add new Pricebook Association Type entry"):u.logTransaction("View Pricebook Association Type Details","PRICEBOOK ASSOCIATION",s,"User:="+a.username+" View Pricebook Association Type details:="+s),_.isNull(s)||i.getPriceBookAssociation(s).then(function(s){200==s.statusCode&&s.response.success&&(e.group=s.response.result)}),e.savePriceBookAssocType=function(){_.isNull(s)?i.savePriceBookAssociation(e.group).then(function(s){200==s.statusCode&&s.response.success&&(n.success("Successfully Added","Success"),c(function(){e.$apply(function(){o.close("save")})},100))}):i.updatePriceBookAssociation(s,e.group).then(function(s){200==s.statusCode&&s.response.success&&(n.success("Successfully Update","Success"),c(function(){e.$apply(function(){o.close("save")})},100))})},e.cancel=function(){o.dismiss("cancel")}}angular.module("POS17").controller("priceBookAssocTypeModal",s),s.$inject=["$scope","$uibModalInstance","$timeout","toastr","group","pricebookFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,o){o.state("main.settings-company",{url:"/settings/company",templateUrl:"modules/company/companies.html"}).state("main.export-company",{url:"/settings/company/exports",templateUrl:"modules/company/companies.export-pdf.html",controller:"companyExportsController"}).state("main.export-customers",{url:"/settings/company/exports/customer",templateUrl:"modules/company/customers.export-pdf.html",controller:"customerExportsController"}).state("main.settings-company-detail",{url:"/settings/company/:company_id",templateUrl:"modules/company/company.detail.html",controller:"companyDetailController"})}])}();
!function(){"use strict";function e(n,e,s,t,a,o,c,l,i,r,p,d){console.log("companyController"),n.details=[],n.selectDeselectAll=!1,n.selectedDatas=[],n.txtSearch={text:""},n.reportFields={company_id:"ID",name:"Name",email_address:"Email Address",contact_number:"Contact Number",ABN:"ABN",address:"Address",city:"City",state:"State",zipcode:"Zip Code",country:"Country",bill_name:"Bill To",bill_address:"Billing Address",bill_city:"Billing City",bill_state:"Billing State",bill_zipcode:"Billing Zip Code",bill_country:"Billing Country",ship_name:"Ship To",ship_address:"Shipping Address",ship_city:"Shippping City",ship_state:"Shipping State",ship_zipcode:"Shipping Zip Code",ship_country:"Shipping Country",parent_id:"Parent ID",_id:"UUID"};var m=JSON.parse(p.get("user"));d.logTransaction("View Companies","COMPANIES","ALL","User:="+m.username+" View all list of companies");n.searchData=function(){n.companyTable.reload()},n.refresh=function(){n.companyTable.reload(),n.txtSearch={text:""}},n.changeSelectDeselectAll=function(){n.selectDeselectAll=!n.selectDeselectAll,_.each(n.company,function(e){e.selected=n.selectDeselectAll,n.deleteSomeData=n.selectDeselectAll,n.checkDataChanges(e)})},n.checkDataChanges=function(t){t.selected?_.find(n.selectedDatas,function(e){return e.company_id===t.company_id})||n.selectedDatas.push(t):n.selectedDatas=_.filter(n.selectedDatas,function(e){return e.company_id!==t.company_id}),n.deleteSomeData=0<n.selectedDatas.length},n.deleteSelected=function(){i.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){async.each(n.selectedDatas,function(e,t){e.selected&&(console.log("company: ",e),c.deleteCompany(e.company_id).then(function(e){console.log("data: ",e.response),200==e.statusCode&&e.response.success?(o.success(e.response.msg,"Success"),t()):o.error(e.response.msg,"Error")}))},function(){t.reload()})})},n.importCompanies=function(e){"excel"==e?r.open({animation:!0,backdrop:"static",size:"lg",templateUrl:"modules/dialog/import.modal.html",controller:"ImportInstanceCtrl"}):"csv"==e&&r.open({animation:!0,backdrop:"static",size:"lg",templateUrl:"modules/dialog/importcsv.modal.html",controller:"ImportCSVInstanceCtrl",windowClass:"my-modal-popup"})},n.company={},n.companycopy=[],n.companyTable=new l({page:1,count:20,filter:n.txtSearch},{counts:[20,35,50,100],getData:function(o,l){c.getAllCompany().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;n.companycopy=angular.copy(n.company),l.filter().text?n.company=s("filter")(t,l.filter().text):n.company=t,n.selectedDatas&&0<n.selectedDatas.length&&_.each(n.company,function(t){_.find(n.selectedDatas,function(e){return e.company_id===t.company_id})&&(t.selected=!0)}),l.total(n.company.length);var a=n.company.slice((l.page()-1)*l.count(),l.page()*l.count());o.resolve(a)}else console.log(e.response.msg)})}})}angular.module("POS17").controller("companyController",e),e.$inject=["$scope","$http","$filter","$state","$timeout","toastr","companyFactory","ngTableParams","ngDialog","$uibModal","localStorageService","transLogFctry"]}();
!function(){"use strict";function t(s,t,e){console.log("companyExportsController"),s.currentDate=Date.now(),s.companies=[],s.IsExport=!1,t.getAllCompany().then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;_.isEmpty(e)||(s.companies=e)}else console.log(t.response.msg)}),s.myFunction=function(){s.IsExport=!0,angular.element(document).ready(function(){e(function(){console.log("basic-table"),$("#basic-table").trigger("footable_redraw")},1e3)})},s.export=function(){var t=Date.now()+"companies.pdf",o="{total_pages_count_string}",n=new jsPDF({orientation:"landscape",format:"a4"}),e=document.getElementById("basic-table"),a=n.autoTableHtmlToJson(e);n.autoTable(a.columns,a.data,{addPageContent:function(t){n.setFontSize(20),n.setTextColor(40),n.setFontStyle("normal"),n.text("Company --- Date: "+moment(s.currentDate).format("MM/DD/YYYY hh:mm a"),t.settings.margin.left,15);var e="Page "+t.pageCount;"function"==typeof n.putTotalPages&&(e=e+" of "+o),n.setFontSize(10),n.text(e,t.settings.margin.left,n.internal.pageSize.height-5)},startY:20,margin:{top:30},styles:{overflow:"linebreak",columnWidth:"wrap"},columnStyles:{0:{columnWidth:60},1:{columnWidth:50},2:{columnWidth:40},3:{columnWidth:100},4:{columnWidth:30}}}),"function"==typeof n.putTotalPages&&n.putTotalPages(o),n.save(t)}}angular.module("POS17").controller("companyExportsController",t),t.$inject=["$scope","companyFactory","$timeout"]}();
!function(){"use strict";function e(o,e,s,n,t,r,a,c,i,l,u,p,d){o.details={},o.main=[],o.enable=!1,o.countries=[];var m=JSON.parse(p.get("user"));l.article_id?d.logTransaction("View Company Details","COMPANIES",l.company_id,"User:="+m.username+" View company details:="+l.company_id):d.logTransaction("Add New Company","COMPANIES","N/A","User:="+m.username+" Add new company entry"),async.waterfall([function(s){a.getAllCompany().then(function(e){200==e.statusCode&&e.response.success&&(o.main=e.response.result,o.main=_.filter(e.response.result,function(e){return e.company_id!=l.company_id}),s(null,e.response.result))})},function(s,n){u.getAllCountries().then(function(e){200==e.statusCode&&e.response.success&&(o.countries=e.response.result,n(null,s,e.response.result))})},function(e,s,n){l.company_id&&a.getCompanyInfo(l.company_id).then(function(e){200==e.statusCode&&e.response.success&&(o.details=e.response.result,n(null,e.response.result))})}]),o.enabledMainEvent=function(e){0==e&&(o.office=void 0,o.details.parent_id=0)},o.select=function(e){console.log("value:",e),o.details.parent_id=e.company_id},o.saveCompany=function(){console.log("$scope.details:",o.details),l.company_id?a.updateCompany(l.company_id,o.details).then(function(e){if(200==e.statusCode&&e.response.result)r.success(e.response.msg,"Success"),console.log("data:",e.response),n.go(n.current,{company_id:l.company_id},{reload:!0});else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void r.error(e.response.msg,"Error");_.each(e.response.result,function(e){r.warning(e.msg,"Warning")})}}):(console.log("$scope.details:",o.details),a.saveCompany(o.details).then(function(e){if(200==e.statusCode&&e.response.result)console.log("data:",e),r.success(e.response.msg,"Success"),n.go(n.current,{company_id:e.response.result},{reload:!0});else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void r.error(e.response.msg,"Error");_.each(e.response.result,function(e){r.warning(e.msg,"Warning")})}}))}}angular.module("POS17").controller("companyDetailController",e),e.$inject=["$scope","$http","$filter","$state","$timeout","toastr","companyFactory","ngTableParams","ngDialog","$stateParams","countryFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(o,e,t,r,s,n,c,a,u,l,p,i){console.log("companyGroupingsController"),o.groups=[],o.groupsCopy=[],o.selectDeselectAll=!1,o.selectedDatas=[],o.refreshData=function(){console.log("refreshData"),async.waterfall([function(s){o.groups=[],o.groupsCopy=[],a.getCustomerGroup().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;o.groups=t,o.groupsCopy=angular.copy(t),s(null,t)}})},function(e,t){l.company_id&&c.getCustomerGroup(l.company_id).then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;_.each(o.groups,function(e){_.find(t,{customer_group_id:e.cg_id})?(e.selected=!0,o.checkDataChanges(e)):e.selected=!1}),o.groupsCopy=[],o.groupsCopy=angular.copy(o.groups)}})}])},o.refreshData(),o.addGroups=function(e){i.open({animation:!0,templateUrl:"./modules/humanresource/groups/customer.groups.modal.html",controller:"customerGroupModalController",size:"md",resolve:{selected:function(){return e}}}).result.then(function(e){o.refreshData()})},o.searchData=function(){o.txtSearch?o.groups=t("filter")(o.groupsCopy,o.txtSearch):o.groups=o.groupsCopy},o.changeSelectDeselectAll=function(){_.each(o.groups,function(e){e.selected=o.selectDeselectAll,o.deleteSomeData=o.selectDeselectAll,o.checkDataChanges(e)})},o.checkDataChanges=function(t){t.selected?_.find(o.selectedDatas,function(e){return e.cg_id===t.cg_id})||o.selectedDatas.push(t):o.selectedDatas=_.filter(o.selectedDatas,function(e){return e.cg_id!==t.cg_id}),o.deleteSomeData=0<o.selectedDatas.length},o.saveCustomerGrouping=function(){if(l.company_id){if(!(0<o.selectedDatas.length))return void n.warning("Please select groups for customer grouping","WARNING");async.waterfall([function(t){c.deleteCustomerGroup(l.company_id).then(function(e){200==e.statusCode&&e.response.success&&t(null,l.company_id)})},function(e,t){var s=0;async.each(o.selectedDatas,function(e,t){e.selected&&c.saveCustomerGroup(l.company_id,{customer_group_id:e.cg_id}).then(function(e){200==e.statusCode&&e.response.success?(n.success(e.response.msg,"Success"),++s==o.selectedDatas.length&&r.reload(),t()):n.error(e.response.msg,"Error")})})}])}}}angular.module("POS17").controller("companyGroupingsController",e),e.$inject=["$scope","$http","$filter","$state","$timeout","toastr","companyFactory","humanFactory","ngDialog","$stateParams","countryFactory","$uibModal"]}();
!function(){"use strict";function e(n,e,t,l,a,s,i,o,r,c){n.selectDeselectAll=!1,n.applicationStatus="All",n.displayModel="List",n.selectedDatas=[],n.txtSearch={text:""},n.reportFields={person_id:"ID",firstname:"First Name",middlename:"Middle Name",lastname:"Last Name",email:"Email Address",displayName:"Display Name",mobile:"Mobile No.",timeZone:"Time Zone",image:"Image URL",image_etag:"Image Etag",image_key:"Image Key",image_mimetype:"Image MimeType",image_originalname:"Image Name",image_size:"Image Size",company_id:"Company ID",company_name:"Company Name",company_username:"Company Username",per_type_id:"Type ID",person_type:"Type",address:"Address",address2:"Address 2",city:"City",state:"State / Province",zipcode:"Zip Code",country:"Country",locale:"Locale",date_start:"Date Start",date_end:"Date End",store_id:"Store ID",isActive:"isActive",isActiveAcnt:"isActiveAcnt",isSubscriber:"isSubscriber",_id:"UUID"};n.personisLoading=!0,n.persons=[],n.personscopy=[],n.personsTable=new c({page:1,count:20,filter:n.txtSearch},{counts:[20,35,50,100],getData:function(a,o){i.getAllPerson().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;_.each(t,function(e){if(_.isNull(e.date_end))e.isActiveAcnt=!0;else{var t=new Date(e.date_start),s=new Date(e.date_end);e.isActiveAcnt=t<=s}}),t=_.filter(t,function(e){if("Customer"==e.person_type&&0==e.isSubscriber)return e}),n.personscopy=angular.copy(t),o.filter().text&&"All"==n.applicationStatus?n.persons=l("filter")(t,o.filter().text):o.filter().text&&"Employee"==n.applicationStatus?(n.persons=l("filter")(t,{per_type_id:1}),n.persons=l("filter")(n.persons,o.filter().text)):o.filter().text&&"Customer"==n.applicationStatus?(n.persons=l("filter")(t,{per_type_id:2}),n.persons=l("filter")(n.persons,o.filter().text)):_.isUndefined(o.filter().text)&&"All"==n.applicationStatus?n.persons=t:_.isUndefined(o.filter().text)&&"Employee"==n.applicationStatus?n.persons=l("filter")(t,{per_type_id:1}):_.isUndefined(o.filter().text)&&"Customer"==n.applicationStatus?n.persons=l("filter")(t,{per_type_id:2}):n.persons=t,o.total(n.persons.length);var s=n.persons.slice((o.page()-1)*o.count(),o.page()*o.count());a.resolve(s),n.personisLoading=!1}else n.personisLoading=!1,console.log(e.response.msg)})}}),n.refresh=function(){n.personsTable.reload()},n.updateStatus=function(e){n.applicationStatus=e,n.personsTable.reload()},n.searchData=function(){n.personsTable.reload()},n.changeSelectDeselectAll=function(){n.selectDeselectAll=!n.selectDeselectAll,_.each(n.persons,function(e){e.selected=n.selectDeselectAll,n.deleteSomeData=n.selectDeselectAll,n.checkDataChanges(e)})},n.checkDataChanges=function(t){t.selected?_.find(n.selectedDatas,function(e){return e.person_id===t.person_id})||n.selectedDatas.push(t):n.selectedDatas=_.filter(n.selectedDatas,function(e){return e.person_id!==t.person_id}),n.deleteSomeData=0<n.selectedDatas.length},n.toggleModal=function(e){s.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){i.deletePersonel(e).then(function(e){200==e.statusCode&&e.response.success?(o.success(e.response.msg,"Success"),a.reload()):o.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},n.deleteSelected=function(){s.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){var s=0;async.each(n.selectedDatas,function(e,t){e.selected&&(console.log("person: ",e),i.deletePersonel(e.person_id).then(function(e){console.log("data: ",e.response),200==e.statusCode&&e.response.success?(o.success(e.response.msg,"Success"),++s==n.selectedDatas.length&&a.reload(),t()):o.error(e.response.msg,"Error")}))})})},n.exportCustomerData=function(e){}}angular.module("POS17").controller("customerController",e),e.$inject=["$scope","$rootScope","$http","$filter","$state","ngDialog","humanFactory","toastr","$timeout","ngTableParams"]}();
!function(){"use strict";function t(r,t,e){console.log("customerExportsController"),r.currentDate=Date.now(),r.persons=[],r.IsExport=!1,t.getAllPerson().then(function(t){if(200==t.statusCode&&t.response.success){var e=t.response.result;e=_.filter(e,function(t){if("Customer"==t.person_type&&0==t.isSubscriber)return t}),console.log("persons: ",e),_.isEmpty(e)||(r.persons=e)}else console.log(t.response.msg)}),r.myFunction=function(){r.IsExport=!0,angular.element(document).ready(function(){e(function(){console.log("basic-table"),$("#basic-table").trigger("footable_redraw")},1e3)})},r.export=function(){var t=Date.now()+"customers.pdf",o="{total_pages_count_string}",n=new jsPDF({orientation:"landscape",format:"a4"}),e=document.getElementById("basic-table"),s=n.autoTableHtmlToJson(e);n.autoTable(s.columns,s.data,{addPageContent:function(t){n.setFontSize(20),n.setTextColor(40),n.setFontStyle("normal"),n.text("Customers --- Date: "+moment(r.currentDate).format("MM/DD/YYYY hh:mm a"),t.settings.margin.left,15);var e="Page "+t.pageCount;"function"==typeof n.putTotalPages&&(e=e+" of "+o),n.setFontSize(10),n.text(e,t.settings.margin.left,n.internal.pageSize.height-5)},startY:20,margin:{top:30},styles:{overflow:"linebreak",columnWidth:"wrap"},columnStyles:{0:{columnWidth:60},1:{columnWidth:50},2:{columnWidth:40},3:{columnWidth:100},4:{columnWidth:30}}}),"function"==typeof n.putTotalPages&&n.putTotalPages(o),n.save(t)}}angular.module("POS17").controller("customerExportsController",t),t.$inject=["$scope","humanFactory","$timeout"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,e){e.state("main.settings-app",{url:"/settings/app",templateUrl:"modules/appsettings/appsettings.html",controller:"appSettingsController"}).state("main.settings-app-log",{url:"/settings/app/log/:userId",templateUrl:"modules/appsettings/logs.html",controller:"appSettingsController"})}])}();
!function(){"use strict";function e(p,e,s,a,i,t){p.app={device:!0,apikeys:!1,user:!1,payment:!1,logs:!1},p.showTab=function(e){"device"==e?p.app={device:!0,apikeys:!1,user:!1,payment:!1,logs:!1}:"apikeys"==e?p.app={device:!1,apikeys:!0,user:!1,payment:!1,logs:!1}:"user"==e?p.app={device:!1,apikeys:!1,user:!0,payment:!1,logs:!1}:"logs"==e?p.app={device:!1,apikeys:!1,user:!1,payment:!1,logs:!0}:"payment"==e?p.app={device:!1,apikeys:!1,user:!1,payment:!0,logs:!1}:"apps"==e&&(p.app={device:!1,apikeys:!1,apps:!0,user:!1,payment:!1,logs:!1})}}angular.module("POS17").controller("appSettingsController",e),e.$inject=["$scope","$filter","$state","ngDialog","toastr","$timeout"]}();
!function(){"use strict";function e(i,e,c,n,s,t,o,a,u,l){i.applicationStatus="All",i.devices=[];var r=JSON.parse(u.get("user"));function p(c){_.each(i.devices,function(e){(e.device_id=c.device_id)&&(e.isSyncing=c.isSyncing),e.isBackup=c.isBackup})}l.logTransaction("View Device Settings","APPLICATION SETTINGS","DEVICE","User:="+r.username+" View all list of subscribe devices"),i.init=function(){a.getAllDevices().then(function(e){200==e.statusCode&&e.response.success&&(i.devices=e.response.result,_.each(i.devices,function(e){e.isOnline=!1,e.isSyncing=!1,e.isBackup=!1}))})},i.refresh=function(){i.devices=[],i.init()},i.updateStatus=function(e){i.applicationStatus=e},i.syncData=function(e){s.info("Sync started..."),e.isSyncing=!0,p(e),t(function(){e.isSyncing=!1,p(e),s.success("Data successfully sync","Success")},2e3)},i.backupData=function(e){s.info("Backup started..."),e.isBackup=!0,p(e),t(function(){e.isBackup=!1,p(e),s.success("Data successfully backup","Success")},2e3)},i.openDeviceNotification=function(e){o.open({animation:!0,templateUrl:"./modules/appsettings/device.notification.modal.html",controller:"appSettingsDeviceModalController",size:"md"})},i.deleteDevice=function(e){t(function(){e.isSyncing=!1,p(e),s.success("Device successfully deleted","Success")},2e3)}}function c(e,c){e.cancel=function(){c.dismiss("cancel")}}angular.module("POS17").controller("appSettingsDeviceController",e).controller("appSettingsDeviceModalController",c),e.$inject=["$scope","$filter","$state","ngDialog","toastr","$timeout","$uibModal","appSettingsFctry","localStorageService","transLogFctry"],c.$inject=["$scope","$uibModalInstance"]}();
!function(){"use strict";function e(s,e,t,n,i,o,r,a,c){s.apikeys=[];var u=JSON.parse(a.get("user"));c.logTransaction("View API Keys Settings","APPLICATION SETTINGS","API KEYS","User:="+u.username+" View all list of API Keys"),s.init=function(){r.getAllAPIKeys().then(function(e){200==e.statusCode&&e.response.success&&(s.apikeys=e.response.result,_.each(s.apikeys,function(e){e.showKeys=!1}))})},s.init(),s.refresh=function(){s.apikeys=[],s.init()},s.newAPIKeys=function(e){},s.showKey=function(e){return e.showKeys?e.showKeys=!1:e.showKeys=!0,e}}angular.module("POS17").controller("appSettingsKeysController",e),e.$inject=["$scope","$filter","$state","ngDialog","toastr","$timeout","appSettingsFctry","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(t,e,i,a,s,c,o,r,l){t.socialauths=[],t.active=!0,t.facebook={apiKey:"",apiSecret:"",redirectUri:"",isEnable:!1,activated:!1,request:!1},t.twitter={apiKey:"",apiSecret:"",redirectUri:"",isEnable:!1,activated:!1,request:!1},t.google={apiKey:"",apiSecret:"",redirectUri:"",isEnable:!1,activated:!1,request:!1},t.linkedin={apiKey:"",apiSecret:"",redirectUri:"",isEnable:!1,activated:!1,request:!1};var n=JSON.parse(r.get("user"));function u(e){200==e.statusCode&&e.response.success&&(t.socialauths=e.response.result,t.facebook={apiKey:t.socialauths.facebook_clientID,apiSecret:t.socialauths.facebook_clientSecret,redirectUri:t.socialauths.facebook_redirectUri,isEnable:t.socialauths.facebook_isEnable,activated:!_.isEmpty(t.socialauths.facebook_activated),request:!_.isEmpty(t.socialauths.facebook_request),social_auth_id:t.socialauths.social_auth_id},t.twitter={apiKey:t.socialauths.twitter_clientID,apiSecret:t.socialauths.twitter_clientSecret,redirectUri:t.socialauths.twitter_redirectUri,isEnable:t.socialauths.twitter_isEnable,activated:!_.isEmpty(t.socialauths.twitter_activated),request:!_.isEmpty(t.socialauths.twitter_request),social_auth_id:t.socialauths.social_auth_id},t.google={apiKey:t.socialauths.google_clientID,apiSecret:t.socialauths.google_clientSecret,redirectUri:t.socialauths.google_redirectUri,isEnable:t.socialauths.google_isEnable,activated:!_.isEmpty(t.socialauths.google_activated),request:!_.isEmpty(t.socialauths.google_request),social_auth_id:t.socialauths.social_auth_id},t.linkedin={apiKey:t.socialauths.linkedIn_clientID,apiSecret:t.socialauths.linkedIn_clientSecret,redirectUri:t.socialauths.linkedIn_redirectUri,isEnable:t.socialauths.linkedIn_isEnable,activated:!_.isEmpty(t.socialauths.linkedIn_activated),social_auth_id:t.socialauths.social_auth_id})}l.logTransaction("View User Auth Settings","APPLICATION SETTINGS","USER AUTH","User:="+n.username+" View all list of User Authentication options"),o.getSocialAuth().then(u),t.refresh=function(){o.getSocialAuth().then(u)},t.activateSocialAuth=function(e){t.modal={title:"Social Media Auth Activation",message:"Are you sure to activate "+e.toUpperCase()+" authentication for your 3rd party apps?"},a.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:t,className:"ngdialog-theme-default"}).then(function(){o.activateSocialAuth({provider:e}).then(function(e){if(200==e.statusCode&&e.response.success)s.success(e.response.msg,"Success"),c(function(){i.reload()},1e3);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void s.error(e.response.msg,"Error");_.each(e.response.result,function(e){s.warning(e.msg,"Warning")})}})})}}angular.module("POS17").controller("appSettingsUserAuthController",e),e.$inject=["$scope","$filter","$state","ngDialog","toastr","$timeout","appSettingsFctry","localStorageService","transLogFctry"]}();
!function(){"use strict";function t(t,e,a,n,o,r,i,l,s){console.log("appSettingsPaymentController");var c=JSON.parse(l.get("user"));s.logTransaction("View Payment Gateway Settings","APPLICATION SETTINGS","PAYMENT GATEWAYS","User:="+c.username+" View all list of Payment Gateway configuration")}angular.module("POS17").controller("appSettingsPaymentController",t),t.$inject=["$scope","$filter","$state","ngDialog","toastr","$timeout","appSettingsFctry","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(o,t,e,s,r,a){var n=JSON.parse(r.get("user"));a.logTransaction("View User Log Settings","APPLICATION SETTINGS","USER LOGS","User:="+n.username+" View all list of User have logs"),o.txtSearchUser={text:""},o.usersTable=new s({page:1,count:20,filter:o.txtSearchUser},{counts:[20,35,50,100],getData:function(r,a){e.getAllUserAccounts().then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;a.filter().text?o.users=$filter("filter")(t,a.filter().text):o.users=t,a.total(o.users.length);var s=o.users.slice((a.page()-1)*a.count(),a.page()*a.count());r.resolve(s)}else console.log(e.response.msg),$activityIndicator.stopAnimating(),callback(null,"error")})}}),o.searchData=function(){o.usersTable.reload()},o.viewUserLogs=function(e){t.go("main.settings-app-log",{userId:e})}}function t(e,o,n,t,s,r,a,l,c,i,u){o.details={},o.details.dateFrom=moment(),o.details.dateEnd=moment(),o.txtSearchUser={text:""};var g=JSON.parse(u.get("user"));c.logTransaction("View User Logs","APPLICATION SETTINGS",s.userId,"User:="+g.username+" View all list of User Logs"),o.usersTable=new i({page:1,count:50,filter:o.txtSearchUser},{counts:[50,65,80,100],getData:function(r,a){c.getAllLogs({userId:s.userId,dateFrom:moment(o.details.dateFrom).format("YYYY-MM-DD"),dateEnd:moment(o.details.dateEnd).format("YYYY-MM-DD")}).then(function(e){if(200==e.statusCode&&e.response.success){var t=e.response.result;_.each(t,function(e){var t,s,r,a,o,n,l,c;e.created_at=(t=e.created_at,s=new Date(t),r=6e4*(new Date).getTimezoneOffset(),a=new Date(s.getTime()+r),o=a.getHours(),n=a.getMinutes(),l=12<=o?"pm":"am",c=(o=(o%=12)||12)+":"+(n=n<10?"0"+n:n)+" "+l,a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear()+"  "+c)}),a.filter().text?o.users=n("filter")(t,a.filter().text):o.users=t,a.total(o.users.length);var s=o.users.slice((a.page()-1)*a.count(),a.page()*a.count());r.resolve(s)}else console.log(e.response.msg),callback(null,"error")})}}),o.searchData=function(){o.usersTable.reload()}}angular.module("POS17").controller("appSettingsLogController",e).controller("appSettingsUserLogController",t),e.$inject=["$scope","$state","useraccountsFctry","ngTableParams","localStorageService","transLogFctry"],t.$inject=["$window","$scope","$filter","$state","$stateParams","ngDialog","toastr","$timeout","transLogFctry","ngTableParams","localStorageService"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(s,t){t.state("main.assets",{url:"/assets",templateUrl:"modules/assets/assets.html",controller:"assetsController"}).state("main.starred",{url:"/assets/starred",templateUrl:"modules/assets/assets.html",controller:"assetsController"}).state("main.shared-with-me",{url:"/assets/shared-with-me/:_id?share",templateUrl:"modules/assets/assets.html",controller:"assetsController"}).state("main.shared-with-me_sub",{url:"/assets/shared-with-me/:_id/s/:sub_id",templateUrl:"modules/assets/assets.html",controller:"assetsController"}).state("main.trash",{url:"/assets/trash",templateUrl:"modules/assets/assets.html",controller:"assetsController"}).state("main.assets_folder",{url:"/assets/folders/:_id",templateUrl:"modules/assets/assets.html",controller:"assetsController"}).state("main.assets_sub_folder",{url:"/assets/folders/:_id/s/:sub_id",templateUrl:"modules/assets/assets.html",controller:"assetsController"})}])}();
!function(){"use strict";angular.module("POS17").controller("assetsController",["$scope","assetsFctry","$stateParams","$state","$uibModal","localStorageService","AuthFctry","ngDialog","toastr","$timeout","Lightbox","transLogFctry",function(r,o,t,i,s,l,e,a,n,d,c,u){r.items={},r.assets={},r.trash={},r.starred={},r.selectedFile={},r.selectedFiles=[],r.filesThumbs=[],r.filesize=0,r.fileSize_t=0,r.fileRemain=0,r.isList="null"!=l.get("isList")&&0!=l.get("isList"),r.isLoading=!0,r.showBread=!1,r.showFiles=!1,r.disableToolNewFolder=!0,r.showToolNewFolder=!0,r.showToolMakeCopy=!1,r.showToolPreview=!1,r.showBarDelete=!1,r.showBarRestore=!1,r.showBarShare=!1,r.showBarEmail=!1,r.showBarMore=!1,r.showBarMove=!1,r.showBarAddStar=!1,r.showBarRemoveStar=!1,r.showBarRename=!1,r.activeAllFiles=!1,r.activeSharedFiles=!1,r.activeStarredFiles=!1;r.activeTrashFiles=!1;function m(e,s){if(0==e)return"0 Byte";var t=s+1||3,o=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,o)).toFixed(t))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][o]}function h(e){if(200==e.statusCode&&e.response.success){if(r.items=e.response.result,r.assets=angular.copy(e.response.result),r.isLoading=!1,r.showBread=!0,r.disableToolNewFolder=!1,"main.assets"==i.current.name){var s=JSON.parse(l.get("user"));u.logTransaction("Assets and Presentation","ASSETS","ALL","User:="+s.username+" View ALL Asset and Presentation"),r.activeAllFiles=!0,r.assets.folders=_.filter(r.assets.folders,function(e){return 0==e.isDeleted}),r.assets.assets=_.filter(r.assets.assets,function(e){return 0==e.isDeleted&&null==e.folder_id})}else if("main.starred"==i.current.name){s=JSON.parse(l.get("user"));u.logTransaction("Assets and Presentation","ASSETS","Starred","User:="+s.username+" View Starred Asset and Presentation"),r.activeStarredFiles=!0,r.assets.folders=_.filter(r.assets.folders,function(e){return 0==e.isDeleted&&1==e.isStarred}),r.assets.assets=_.filter(r.assets.assets,function(e){return 0==e.isDeleted&&1==e.isStarred})}else if("main.shared-with-me"==i.current.name){s=JSON.parse(l.get("user"));u.logTransaction("Assets and Presentation","ASSETS","Shared","User:="+s.username+" View Shared Asset and Presentation"),r.activeSharedFiles=!0,r.assets.folders=_.filter(r.assets.folders,function(e){return 0==e.isDeleted}),t._id&&_.isUndefined(t.sub_id)?r.assets.assets=_.filter(r.assets.assets,function(e){return 0==e.isDeleted}):t._id&&t.sub_id?r.assets.assets=_.filter(r.assets.assets,function(e){return 0==e.isDeleted}):r.assets.assets=_.filter(r.assets.assets,function(e){return 0==e.isDeleted&&null==e.folder_id})}else if("main.trash"==i.current.name){s=JSON.parse(l.get("user"));u.logTransaction("Assets and Presentation","ASSETS","Starred","User:="+s.username+" View Trash Asset and Presentation"),r.activeTrashFiles=!0,r.showBarDelete=!0,r.showBarRestore=!0,r.showBarShare=!1,r.showBarEmail=!1,r.showToolPreview=!1,r.showBarMore=!1,r.assets.folders=_.filter(r.assets.folders,function(e){return 1==e.isDeleted}),r.assets.assets=_.filter(r.assets.assets,function(e){return 1==e.isDeleted})}else"main.assets_folder"==i.current.name&&(r.activeAllFiles=!0);if(r.assets.folders&&0<r.assets.folders.length&&_.each(r.assets.folders,function(e){var s=_.sumBy(e.files,function(e){return e.asset_filesize});e.folder_filesize=m(s),e.isActive=!1,e.isFolder=!0,null==e.isPublic&&(e.isPublic=0)}),r.assets.assets&&0<r.assets.assets.length){var n=_.filter(r.assets.assets,function(e){return"application/pdf"==e.asset_mimetype}).length;async.each(r.assets.assets,function(l,a){l.asset_filesize=m(l.asset_filesize),l.isActive=!1,l.isFolder=!1,null==l.isPublic&&(l.isPublic=0),"application/pdf"==l.asset_mimetype&&PDFJS.getDocument(l.asset_url).then(function(e){e.getPage(1).then(function(e){var s=e.getViewport(.5),t=document.createElement("canvas"),o=t.getContext("2d");t.height=s.height,t.width=s.width;var i={canvasContext:o,viewport:s};e.render(i).then(function(){o.globalCompositeOperation="destination-over",o.fillStyle="#fff",o.fillRect(0,0,t.width,t.height);var e=t.toDataURL();d(function(){r.$apply(function(){r.filesThumbs.push({_id:l._id,asset_mimetype:l.asset_mimetype,thumbnail:e}),n-1==r.filesThumbs.length&&(r.filesThumbs,_.each(r.assets.assets,function(e){"application/pdf"==e.asset_mimetype&&(e.thumbnail=_.find(r.filesThumbs,{_id:e._id}))}))})},10),t.remove(),a()})})})})}r.assets.folders&&r.assets.assets&&(0<r.assets.folders.length&&0<r.assets.assets.length?r.showFiles=!0:0<r.assets.folders.length&&r.assets.assets.length<1?r.showFiles=!0:r.assets.folders.length<1&&0<r.assets.assets.length?r.showFiles=!0:r.assets.folders.length<1&&r.assets.assets.length<1&&(r.showFiles=!1))}}function f(s){_.each(r.assets.folders,function(e){e._id!==s._id&&(e.isActive=!1)}),_.each(r.assets.assets,function(e){e._id!==s._id&&(e.isActive=!1)})}r.upload=!1,r.refreshAssets=function(){r.assets={},r.items={},t._id&&_.isUndefined(t.sub_id)?(r.isLoading=!0,"main.shared-with-me"==i.current.name?o.getFolderAssets(t._id,"public").then(h):o.getFolderAssets(t._id,"").then(h)):t._id&&t.sub_id?(r.showToolNewFolder=!1,r.isLoading=!0,"main.shared-with-me_sub"==i.current.name?o.getFolderAssets(t.sub_id,"public").then(h):o.getFolderAssets(t.sub_id,"").then(h)):"main.shared-with-me"==i.current.name?o.getAllAssets({action:"shared"}).then(h):o.getAllAssets({}).then(h),o.getAllAssets().then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result,t=_.sumBy(s.assets,function(e){return e.asset_filesize});r.filesize=t;r.fileRemain=2147483648-r.filesize}})},r.changeDisplay=function(){r.isList=!r.isList,l.set("isList",r.isList)},r.showAllFiles=function(){"main.assets"==i.current.name?r.refreshAssets():i.go("main.assets")},r.showAllTrash=function(){"main.trash"==i.current.name?r.refreshAssets():i.go("main.trash")},r.showAllStarred=function(){"main.starred"==i.current.name?r.refreshAssets():i.go("main.starred")},r.showAllShared=function(){"main.shared-with-me"==i.current.name?r.refreshAssets():i.go("main.shared-with-me")},r.doGreeting=function(){r.upload=!0},r.newUploader=function(){0<r.fileRemain?s.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/assets.uploader.html",size:"lg",controller:"assetsUploadModalCtrl"}).result.then(function(e){e&&r.refreshAssets()}):n.error("WARNING: Storage full, unable to create file uploads.","Error")},r.createNewFolder=function(){s.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/newfolder.modal.html",size:"sm",controller:"assetsFolderModalCtrl"}).result.then(function(e){e&&i.reload()})},r.shareToOthers=function(){r.selectedFile&&s.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/sharer.modal.html",size:"md",controller:"assetsShareModalCtrl",resolve:{asset_file:function(){return r.selectedFile}}}).result.then(function(e){e&&i.reload()})},r.emailToOthers=function(){r.selectedFile&&s.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/sharer-email.modal.html",size:"md",controller:"assetsShareEmailModalCtrl"}).result.then(function(e){e&&i.reload()})},r.renameSelected=function(){r.selectedFile&&s.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/assets.rename.html",size:"md",controller:"assetsRenameModalCtrl",resolve:{asset_file:function(){return r.selectedFile}}}).result.then(function(e){e&&i.reload()})},r.showInfoSelected=function(){r.selectedFile&&s.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/assets.info.html",size:"md",controller:"assetsInfoModalCtrl",resolve:{asset_file:function(){return r.selectedFile}}}).result.then(function(e){e&&i.reload()})},r.deleteSelected=function(){function e(e){console.log("handleResponse"),200==e.statusCode&&e.response.success&&(n.success(e.response.msg,"Success"),d(function(){r.refreshAssets()},1e3))}0<r.selectedFiles.length?r.modal={title:"Remove selected?",message:"Are you sure to remove the selected files?"}:r.modal={title:"Remove?",message:"Are you sure to remove this?"},a.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){var t=1;0<r.selectedFiles.length?async.eachSeries(r.selectedFiles,function(e,s){e.isFolder?e.isDeleted?o.deleteFolder(e._id).then(function(e){200==e.statusCode&&e.response.success&&(n.success(e.response.msg,"Success"),t++,s())}):o.trashFolder(e._id).then(function(e){200==e.statusCode&&e.response.success&&(n.success(e.response.msg,"Success"),t++,s())}):e.isDeleted?o.deleteAssetFile(e._id).then(function(e){200==e.statusCode&&e.response.success&&(n.success(e.response.msg,"Success"),t++,s())}):o.trashAssetFile(e._id).then(function(e){200==e.statusCode&&e.response.success&&(n.success(e.response.msg,"Success"),t++,s())}),r.selectedFiles.length>=t&&d(function(){i.reload()},1e3)}):_.isEmpty(r.selectedFile)||(r.selectedFile.isFolder?r.selectedFile.isDeleted?o.deleteFolder(r.selectedFile._id).then(e):o.trashFolder(r.selectedFile._id).then(e):r.selectedFile.isDeleted?o.deleteAssetFile(r.selectedFile._id).then(e):o.trashAssetFile(r.selectedFile._id).then(e))})},r.moveSelected=function(){r.selectedFile&&s.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/assets.move.html",size:"",controller:"assetsMoveModalCtrl",resolve:{asset_file:function(){return r.selectedFile}}}).result.then(function(e){e&&i.reload()})},r.previewSelected=function(){r.selectedFile&&r.openFile(r.selectedFile)},r.starredSelected=function(){function e(e){200==e.statusCode&&e.response.success&&(n.success(e.response.msg,"Success"),d(function(){i.reload()},200))}if(0<r.selectedFiles.length){var t=0;async.eachSeries(r.selectedFiles,function(e,s){e.isFolder?o.starredFolder(e._id).then(function(e){200==e.statusCode&&e.response.success&&(n.success(e.response.msg,"Success"),t++,console.log("count1: ",t),s())}):o.starredFolder(e._id).then(function(e){200==e.statusCode&&e.response.success&&(n.success(e.response.msg,"Success"),t++,console.log("count2: ",t),s())}),r.selectedFiles.length>=t&&i.reload()})}else r.selectedFile&&(r.selectedFile.isFolder?o.starredFolder(r.selectedFile._id).then(e):o.starredAssetFile(r.selectedFile._id).then(e))},r.restoreSelected=function(){function e(e){200==e.statusCode&&e.response.success&&(n.success(e.response.msg,"Success"),d(function(){i.reload()},200))}if(0<r.selectedFiles.length){var t=0;async.each(r.selectedFiles,function(e,s){e.isFolder?o.restoreFolder(e._id).then(function(e){200==e.statusCode&&e.response.success&&(n.success(e.response.msg,"Success"),t++,console.log("count1: ",t),s())}):o.restoreAssetFile(e._id).then(function(e){200==e.statusCode&&e.response.success&&(n.success(e.response.msg,"Success"),t++,console.log("count2: ",t),s())}),r.selectedFiles.length>=t&&i.reload()})}else r.selectedFile&&(r.selectedFile.isFolder?o.restoreFolder(r.selectedFile._id).then(e):o.restoreAssetFile(r.selectedFile._id).then(e))},r.openLightboxModal=function(e){console.log("openLightboxModal: ",e);var s=[];s.push({url:e.asset_url,caption:e.asset_name,thumbUrl:e.asset_url}),console.log("arry: ",s),c.openModal(s,0)},r.openVideoModal=function(e){s.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/assets.media.html",controller:"assetsMediaModalCtrl",size:"lg",resolve:{files:function(){return e},type:function(){return"video"}}})},r.openAudioModal=function(e){s.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/assets.media.html",controller:"assetsMediaModalCtrl",size:"md",resolve:{files:function(){return e},type:function(){return"audio"}}})},r.openDocsModal=function(e){s.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/assets.docs.html",controller:"assetsDocsModalCtrl",size:"lg",windowClass:"modal-fullscreen",resolve:{files:function(){return e}}})},r.openFolder=function(e){console.log("$stateParams: ",t),console.log("folder._id: ",e._id),e.isFolder&&("main.trash"!==i.current.name?"main.shared-with-me"==i.current.name?t._id?i.go("main.shared-with-me_sub",{_id:t._id,sub_id:e._id}):i.go("main.shared-with-me",{_id:e._id}):t._id?i.go("main.assets_sub_folder",{_id:t._id,sub_id:e._id}):i.go("main.assets_folder",{_id:e._id}):(r.modal={title:"This folder is in your trash",message:"To view this folder, youll need to restore it from your trash. Restore folder?"},a.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){o.restoreFolder(e._id).then(function(e){200==e.statusCode&&e.response.success&&(n.success(e.response.msg,"Success"),d(function(){i.reload()},200))})})))},r.openFile=function(e){if("image/jpeg"==e.asset_mimetype||"image/jpg"==e.asset_mimetype||"image/gif"==e.asset_mimetype||"image/x-ms-bmp"==e.asset_mimetype||"image/png"==e.asset_mimetype)r.openLightboxModal(e);else if("audio/mp3"==e.asset_mimetype||"audio/mp4"==e.asset_mimetype)r.openAudioModal(e);else if("video/mp4"==e.asset_mimetype||"video/x-flv"==e.asset_mimetype||"video/x-msvideo"==e.asset_mimetype||"video/x-ms-wmv"==e.asset_mimetype||"video/quicktime"==e.asset_mimetype||"video/3gpp"==e.asset_mimetype)r.openVideoModal(e);else if("application/pdf"==e.asset_mimetype)r.openDocsModal(e);else if("text/plain"==e.asset_mimetype)r.openDocsModal(e);else if("application/msword"==e.asset_mimetype||"application/vnd.openxmlformats-officedocument.wordprocessingml.document"==e.asset_mimetype)r.openDocsModal(e);else if("text/csv"==e.asset_mimetype||"application/vnd.ms-excel"==e.asset_mimetype||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==e.asset_mimetype)r.openDocsModal(e);else{if("application/vnd.openxmlformats-officedocument.presentationml.presentation"!=e.asset_mimetype&&"application/vnd.ms-powerpoint"!=e.asset_mimetype)return void n.warning("No available tools to open","Failed");r.openDocsModal(e)}},r.deleteFile=function(e){console.log("media: ",e),r.modal={title:"Remove File",message:"Are you sure to remove the file?"},a.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:r,className:"ngdialog-theme-default"}).then(function(){o.deleteAssetFile(e._id).then(function(e){200==e.statusCode&&e.response.success&&(n.success(e.response.msg,"Success"),d(function(){i.reload()},200))})})},r.clearSelection=function(){console.log("clearSelection"),r.showBarDelete=!1,r.showBarRestore=!1,r.showBarShare=!1,r.showBarEmail=!1,r.showBarMove=!1,r.showBarMore=!1,r.showToolPreview=!1,r.selectedFiles=[],_.each(r.assets.folders,function(e){e.isActive=!1}),_.each(r.assets.assets,function(e){e.isActive=!1})},r.activeSelected=function(e,s){if(r.showBarDelete=!0,r.showBarMore=!0,"main.shared-with-me"==i.current.name?(r.showBarEmail=!0,r.showBarShare=!1,r.showBarDelete=!1,r.showBarRestore=!1,r.showBarMove=!1,r.showBarAddStar=!1,r.showBarRemoveStar=!1,r.showBarRename=!1,r.showToolMakeCopy=!1,e.isFolder?r.showToolPreview=!1:r.showToolPreview=!0):("main.trash"==i.current.name?r.showBarRestore=!0:(r.showBarRestore=!1,r.showBarShare=!0,r.showBarEmail=!0,r.showBarMove=!0),e.isFolder?(r.showToolPreview=!1,r.showToolMakeCopy=!1):(r.showToolPreview=!0,r.showToolMakeCopy=!0)),r.selectedFile=e,s)if(_.isUndefined(s.ctrlKey))if(_.isUndefined(s.metaKey))e.isActive=!0,r.selectedFiles=[],f(e);else{r.selectedFiles.length<1&&f(e),_.find(r.selectedFiles,{_id:r.selectedFile._id})?(e.isActive=!1,_.remove(r.selectedFiles,function(e){return e._id==r.selectedFile._id})):(e.isActive=!0,r.selectedFiles.push(r.selectedFile))}else r.selectedFiles.length<1&&f(e),_.find(r.selectedFiles,{_id:r.selectedFile._id})?(e.isActive=!1,_.remove(r.selectedFiles,function(e){return e._id==r.selectedFile._id})):(e.isActive=!0,r.selectedFiles.push(r.selectedFile))}}])}();
!function(){"use strict";function e(e,s,o,t,n,i,l,a,c,r,u){e.item={},e.isUploadAll=!0;var d=e.isClose=!1,p=JSON.parse(r.get("user")),f=e.uploader=new t({url:n+i+"assets",method:"POST",headers:{Authorization:"Bearer "+a.getUserToken(),accesskey:p.subscriptionKey}});f.filters.push({name:"customFilter",fn:function(e,s){return this.queue.length<10}}),f.onBeforeUploadItem=function(e){e.alias="files",c._id&&_.isUndefined(c.sub_id)?e.formData=[{parent_id:c._id}]:c._id&&c.sub_id&&(e.formData=[{parent_id:c.sub_id}])},f.onSuccessItem=function(e,s,o,t){u.success(s.response.msg,"Success")},f.onErrorItem=function(e,s){400!=s.statusCode||s.success||(u.error(s.response.msg,"Error"),d=!0)},f.onCompleteAll=function(e){d||u.success("Media / File upload complete","Success"),l(function(){o.close("success")},1300)},e.uploadAll=function(){f.uploadAll(),e.isUploadAll=!1,e.isClose=!0},e.cancel=function(){o.dismiss("cancel")}}angular.module("POS17").controller("assetsUploadModalCtrl",e),e.$inject=["$scope","$state","$uibModalInstance","FileUploader","API_URL","API_VERSION","$timeout","AuthFctry","$stateParams","localStorageService","toastr"]}();
!function(){"use strict";function s(s,e,r,n,t,o){s.folder={},s.create=function(){n._id&&(s.folder.parent_id=n._id),o.createFolder(s.folder).then(function(s){200==s.statusCode&&s.response.success?(t.success(s.response.msg,"Success"),r(function(){e.close(s.response.result)},300)):400===s.statusCode&&!s.response.success&&_.isArray(s.response.result)?_.each(s.response.result,function(s){t.warning(s.msg,"Warning")}):t.error(s.response.msg,"Error")})},s.cancel=function(){e.dismiss("cancel")}}angular.module("POS17").controller("assetsFolderModalCtrl",s),s.$inject=["$scope","$uibModalInstance","$timeout","$stateParams","toastr","assetsFctry"]}();
!function(){"use strict";function s(n,r,i,s,e,c,a,t,o){n.sharer={},n.users=[],n.items=[],n.asset={},n.asset=o,n.owner={},0==n.asset.isPublic?n.sharer.isPublic=!1:null==n.asset.isPublic?n.sharer.isPublic=!1:1==n.asset.isPublic&&(n.sharer.isPublic=!0),async.waterfall([function(r){t.getAllUserAccounts().then(function(s){if(200==s.statusCode&&s.response.success){var e=s.response.result;r(null,e)}else r(null,[])})},function(s,e){n.users=angular.copy(s),_.remove(n.users,function(s){return s.uc_id==r.profile.uc_id}),_.each(n.users,function(s){var e=s.profile;n.items.push({displayName:e.displayName,email:e.email||"",_id:e._id,id:s.uc_id,type:"user"})})}]),a.getSharedAssetFile(n.asset.asset_id).then(function(s){if(200==s.statusCode&&s.response.success){var e=s.response.result;n.sharer.email=_.map(e,function(s){if(s.info){var e=s.info;return{displayName:e.displayName,email:e.email||"",_id:e._id,id:e.uc_id,type:"user"}}})}else c.error(s.response.msg,"Error")}),n.tagTransform=function(s){return{displayName:s}},n.clearInput=function(s){s.search=""},n.deleteEmail=function(s){console.log("deleteEmail: ",s)},n.sendMail=function(){var t=_.map(n.sharer.email,function(s){return{id:s.id,type:s.type}});n.asset.isFolder?n.sharer.isPublic?a.publicSharedFolder(n.asset._id,"public").then(function(s){200==s.statusCode&&s.response.success?(c.success(s.response.msg,"Success"),i.close("save")):c.error(s.response.msg,"Error")}):t&&0<t.length||a.publicSharedFolder(n.asset._id,"private").then(function(s){200==s.statusCode&&s.response.success?(c.success(s.response.msg,"Success"),i.close("save")):c.error(s.response.msg,"Error")}):n.sharer.isPublic?a.publicSharedAssetFile(n.asset._id,"public").then(function(s){200==s.statusCode&&s.response.success?(c.success(s.response.msg,"Success"),i.close("save")):c.error(s.response.msg,"Error")}):t&&0<t.length?a.removeSharedAssetFile(n.asset.asset_id).then(function(s){if(200==s.statusCode&&s.response.success){var r=1;async.eachSeries(t,function(s,e){a.shareAssetFile(n.asset._id,{shared_to:s.id,share_type:s.type}).then(function(s){if(200!=s.statusCode||!s.response.success)return 400===s.statusCode&&!s.response.success&&_.isArray(s.response.result)?void _.each(s.response.result,function(s){c.warning(s.msg,"Warning")}):void c.error(s.response.msg,"Error");c.success(s.response.msg,"Success"),r++,e()}),r==t.length&&i.close("save")})}else c.error(s.response.msg,"Error")}):a.publicSharedAssetFile(n.asset._id,"private").then(function(s){200==s.statusCode&&s.response.success?(c.success(s.response.msg,"Success"),i.close("save")):c.error(s.response.msg,"Error")})},n.cancel=function(){i.dismiss("cancel")}}angular.module("POS17").controller("assetsShareModalCtrl",s),s.$inject=["$scope","$rootScope","$uibModalInstance","$timeout","$stateParams","toastr","assetsFctry","useraccountsFctry","asset_file"]}();
!function(){"use strict";function e(a,e,s,n,t,r,o,l,i){a.sharer={},a.persons=[],a.company=[],a.items=[],async.waterfall([function(n){l.getAllCompany().then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;n(null,s)}else n(null,[])})},function(n,a){o.getAllPerson().then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;a(null,n,s)}else a(null,[])})},function(e,s,n){a.persons=angular.copy(s),a.company=angular.copy(e),a.persons=_.filter(a.persons,function(e){if("Customer"==e.person_type&&0==e.isSubscriber)return e}),_.each(a.persons,function(e){a.items.push({displayName:e.displayName,email:e.email||"",_id:e._id})}),_.each(a.company,function(e){a.items.push({displayName:e.name,email:e.email_address||"",_id:e._id})})}]),a.tagTransform=function(e){return{email:e}},a.clearInput=function(e){e.search=""},a.deleteEmail=function(e){console.log("deleteEmail: ",e)},a.sendMail=function(){a.sharer.from="support@symphony.com.ph",a.sharer.subject="Symphony Presentation",a.sharer.message=$("#printasset").html(),a.sharer.attachment=asset_file.asset_url||"",a.sharer.email=_.map(a.sharer.email,function(e){return e.email}),console.log("$scope.sharer: ",a.sharer)},a.cancel=function(){e.dismiss("cancel")}}angular.module("POS17").controller("assetsShareEmailModalCtrl",e),e.$inject=["$scope","$uibModalInstance","$timeout","$stateParams","toastr","assetsFctry","humanFactory","companyFactory","emailFactory"]}();
!function(){"use strict";function e(e,s,t,l,c,a){e.audio="audio"==a,e.config={sources:[{src:c.trustAsResourceUrl(l.asset_url),type:l.asset_mimetype}],theme:{url:"http://www.videogular.com/styles/themes/default/latest/videogular.css"}},e.cancel=function(){t.dismiss("cancel")}}function s(e,s,t,l,c,a){e.pdfName=c.media_name,e.file_type=c.asset_mimetype,"application/pdf"==c.asset_mimetype?e.pdfUrl=l.trustAsResourceUrl(c.asset_url):"text/plain"==c.asset_mimetype?e.pdfUrl=l.trustAsResourceUrl("https://docs.google.com/gview?url="+c.asset_url+"&embedded=true"):e.pdfUrl=l.trustAsResourceUrl("https://view.officeapps.live.com/op/view.aspx?src="+c.asset_url),e.cancel=function(){t.dismiss("cancel")}}angular.module("POS17").controller("assetsMediaModalCtrl",e).controller("assetsDocsModalCtrl",s),e.$inject=["$scope","$state","$uibModalInstance","files","$sce","type"],s.$inject=["$scope","$state","$uibModalInstance","$sce","files","localStorageService"]}();
!function(){"use strict";function e(s,n,l,e,i,o,t){s.file={},s.file=t,console.log("$scope.file: ",s.file),s.file.isFolder?s.file.foldername=s.file.folder_name:s.file.filename=s.file.asset_name,s.Rename=function(){function e(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),l(function(){n.close("save")},100)):400===e.statusCode&&!e.response.success&&_.isArray(e.response.result)?_.each(e.response.result,function(e){i.warning(e.msg,"Warning")}):i.error(e.response.msg,"Error")}s.file.isFolder?o.updateFolder(s.file._id,{folder_name:s.file.foldername}).then(e):o.updateAssetFile(s.file._id,{file_name:s.file.filename}).then(e)},s.cancel=function(){n.dismiss("cancel")}}angular.module("POS17").controller("assetsRenameModalCtrl",e),e.$inject=["$scope","$uibModalInstance","$timeout","$stateParams","toastr","assetsFctry","asset_file"]}();
!function(){"use strict";function t(a,t,e){a.items={},a.chart={},a.chart.labels=["Used","Free"],a.chart.data=[0,0],a.chart.colors=["#1a5350","#e2e2e2"],a.chart.options={},Chart.defaults.global.legend.display=!0,Chart.defaults.global.scaleLabel=function(t){return t.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},Chart.defaults.global.multiTooltipTemplate=function(t){return t.datasetLabel+":== "+t.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")};var s=a.filesize=0;function l(t,e){if(0==t)return"0 Byte";var a=e+1||3,s=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,s)).toFixed(a))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][s]}a.initStorage=function(){e.getAllAssets().then(function(t){if(200==t.statusCode&&t.response.success){a.items=t.response.result;var e=_.sumBy(a.items.assets,function(t){return t.asset_filesize});a.filesize=l(e);s=2147483648-e,a.chart.data=[e,s],a.chart.options={legend:{display:!0},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(t,e){return e.labels[t.index]+": "+l(e.datasets[t.datasetIndex].data[t.index])}}}}}})}}angular.module("POS17").controller("assetsStorageCtrl",t),t.$inject=["$scope","$timeout","assetsFctry"]}();
!function(){"use strict";function s(s,t,e,n,a,c){s.files={},s.files=c,s.cancel=function(){t.dismiss("cancel")}}angular.module("POS17").controller("assetsInfoModalCtrl",s),s.$inject=["$scope","$uibModalInstance","$timeout","$stateParams","toastr","asset_file"]}();
!function(){"use strict";function e(o,i,l,e,t,n,s){o.files={},o.treedata=[],o.asset_file=s,o.isLoading=!0,o.treedata.push({label:"Main Files",_id:null,folder_id:null}),n.getAllAssets().then(function(e){200==e.statusCode&&e.response.success&&(o.files=e.response.result,_.each(o.files.folders,function(s){var i={label:s.folder_name,_id:s._id,folder_id:s.folder_id,children:[]};_.each(s.sub_folders,function(e){i.children.push({label:e.folder_name,_id:s._id,folder_id:s.folder_id})}),o.treedata.push(i)}),o.isLoading=!1)}),o.Move=function(){function e(e){200==e.statusCode&&e.response.success&&(t.success(e.response.msg,"Success"),l(function(){i.close("save")},100))}if(o.abc&&angular.isObject(o.abc.currentNode)){var s=o.abc.currentNode;if(o.asset_file.isFolder){if(o.asset_file._id==s._id)return void t.warning("Unable to move folder on same folder source","WARNING");if(o.asset_file.parent_id==s._id)return void t.warning("Unable to move folder on root folder source","WARNING");n.moveFolder(o.asset_file._id,s._id).then(e)}else n.moveAssetFile(o.asset_file._id,s._id).then(e)}else t.warning("Please select directory where the files/folder to move","WARNING")},o.cancel=function(){i.dismiss("cancel")}}angular.module("POS17").controller("assetsMoveModalCtrl",e),e.$inject=["$scope","$uibModalInstance","$timeout","$stateParams","toastr","assetsFctry","asset_file"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(a,t){t.state("main.aim-tab",{url:"/aim/aimTab",templateUrl:"modules/aim/aim-tab.html",controller:"aimTabCtrl"})}])}();
!function(){"use strict";function e(r,e,o,n){r.viewMore=!1,r.View=!0,r.startWith=0,r.limit=50,r.dhan="",r.test={},r.today=function(){r.today=e("date")(new Date,"dd MMM yyyy")},r.today(),r.is_disable=!1,r.startRequest=function(e){o.getReceiveCode(e).then(function(e){r.receives=e.response.result.result})},r.startSync=function(){o.SyncOpetaion().then(function(e){console.log("Sync operation completed.")})},r.back=function(){r.startRequest(),r.viewMore=!1,r.View=!0},r.showMoreinfo=function(e,t,n){o.getProductBaseonRececingOrder(e).then(function(e){r.products=e.response.result}),r.receivenumber=t,r.receivedate=n,r.View=!1,r.viewMore=!0},r.parseDate=function(e){if(e)return moment(new Date(e)).format("MMMM Do YYYY")},r.check=function(e){r.received=e},r.checkValue=function(t,n,o){angular.forEach(r.products,function(e){e.row_id==o&&(e.val3=n<t)})},r.save=function(){var t=!0;angular.forEach(r.products,function(e){return null==e.codes_on_hand?(t=!1,void n.error("Please check code qty fields","An error occured.")):e.codes_on_hand<0?(t=!1,void n.error("Please check code qty fields","An error occured.")):e.codes_on_hand>e.newquantity?(t=!1,void n.error("Please check code qty fields","An error occured.")):void 0}),t&&o.setCodeInventory(r.products).then(function(e){if(e.response.success)n.success("","Successfully Saved"),r.back();else if(!e.response.success)return void n.error(e.response.msg,"Error")})},r.printDoc=function(){var e=document.getElementById("receivings").innerHTML,t=window.open("","_blank","width=300,height=300");t.document.open(),t.document.write('<html><head><link rel="stylesheet" type="text/css" href="style.css" /></head><body onload="window.print()">'+e+"</body></html>"),t.document.close()},r.getCodeInventory=function(){o.getCodeInventory().then(function(e){r.codeinventory=e.response.result})},r.searchData=function(e){r.startRequest({startWith:r.startWith,limit:r.limit,searchKey:e})},r.init=function(){r.startRequest({startWith:r.startWith,limit:r.limit,searchKey:""}),r.startSync(),r.getCodeInventory()},r.init()}angular.module("POS17").controller("aimTabCtrl",e),e.$inject=["$scope","$filter","aimFctry","toastr"]}();
!function(){"use strict";angular.module("POS17").directive("errSrc",function(){return{link:function(e,t,n){e.$watch(function(){return n.ngSrc},function(e){e||t.attr("src",n.errSrc)}),t.bind("error",function(){t.attr("src",n.errSrc)})}}}).directive("sidebar",function(){return{restrict:"C",compile:function(e,t,n){$.AdminLTE.tree(e)}}}).directive("header",function(){return{restrict:"E",templateUrl:"./modules/templates/header.html",compile:function(e,t,n){$.AdminLTE.pushMenu($(e).find(".sidebar-toggle"))}}}).directive("knob",function(){return{restrict:"C",compile:function(e,t,n){e.knob({draw:function(){if("tron"==this.$.data("skin")){var e,t=this.angle(this.cv),n=this.startAngle,i=this.startAngle,r=i+t;return this.g.lineWidth=this.lineWidth,this.o.cursor&&(i=r-.3)&&(r+=.3),this.o.displayPrevious&&(e=this.startAngle+this.angle(this.value),this.o.cursor&&(n=e-.3)&&(e+=.3),this.g.beginPath(),this.g.strokeStyle=this.previousColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,n,e,!1),this.g.stroke()),this.g.beginPath(),this.g.strokeStyle=this.o.fgColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,i,r,!1),this.g.stroke(),this.g.lineWidth=2,this.g.beginPath(),this.g.strokeStyle=this.o.fgColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth+1+2*this.lineWidth/3,0,2*Math.PI,!1),this.g.stroke(),!1}}})}}}).directive("sparkline",function(){return{restrict:"C",compile:function(e,t,n){e.each(function(){var e=$(this);e.sparkline("html",e.data())})}}}).directive("box",function(){return{restrict:"C",compile:function(e,t,n){var i=this;$(e).find(this.boxWidgetOptions.boxWidgetSelectors.collapse).click(function(e){e.preventDefault(),i.collapse($(this))}),$(e).find(this.boxWidgetOptions.boxWidgetSelectors.remove).click(function(e){e.preventDefault(),i.remove($(this))})},collapse:function(e){var t=e.parents(".box").first(),n=t.find(".box-body, .box-footer");t.hasClass("collapsed-box")?(e.children(".fa-plus").removeClass("fa-plus").addClass("fa-minus"),n.slideDown(300,function(){t.removeClass("collapsed-box")})):(e.children(".fa-minus").removeClass("fa-minus").addClass("fa-plus"),n.slideUp(300,function(){t.addClass("collapsed-box")}))},remove:function(e){e.parents(".box").first().slideUp()},boxWidgetOptions:{boxWidgetIcons:{collapse:"fa fa-minus",open:"fa fa-plus",remove:"fa fa-times"},boxWidgetSelectors:{remove:'[data-widget="remove"]',collapse:'[data-widget="collapse"]'}}}}).directive("chat",function(){return{restrict:"E",templateUrl:"./modules/templates/direct-chat.html",scope:{type:"@",title:"@",count:"@count",messages:"=messages"},replace:!0,compile:function(e,t){return e.find("[data-widget='chat-pane-toggle']").click(function(){$(this).parents(".direct-chat").first().toggleClass("direct-chat-contacts-open")}),{pre:function(e,t,n){},post:function(e,t,n){}}}}}).directive("repeatEnd",function(){return{restrict:"A",link:function(e,t,n){e.$last&&e.$eval(n.repeatEnd)}}}).directive("ngRepeatEndWatch",function(){return{restrict:"A",scope:{},link:function(e,t,n){if(!n.ngRepeat)throw"ngRepeatEndWatch: `ngRepeat` Directive required to use this Directive";e.$parent.$last&&(""!==n.ngRepeatEndWatch?"function"==typeof e.$parent.$parent[n.ngRepeatEndWatch]?e.$parent.$parent[n.ngRepeatEndWatch]():e.$parent.$parent[n.ngRepeatEndWatch]=!0:e.$parent.$parent.ngRepeatEnd=!0)}}}).directive("dateNow",["$filter",function(i){return{link:function(e,t,n){t.text(i("date")(new Date,n.dateNow))}}}]).directive("infiniteScroll",["$rootScope","$window","$timeout",function(c,e,n){return{link:function(i,r,a){var o,t,s,l;return e=angular.element(e),r.css("overflow-y","auto"),r.css("overflow-x","hidden"),r.css("height","inherit"),s=0,null!=a.infiniteScrollDistance&&i.$watch(a.infiniteScrollDistance,function(e){return s=parseInt(e,10)}),o=!(l=!0),null!=a.infiniteScrollDisabled&&i.$watch(a.infiniteScrollDisabled,function(e){if((l=!e)&&o)return o=!1,t()}),c.$on("refreshStart",function(){r.animate({scrollTop:"0"})}),t=function(){var e,t,n;return e=$(r.children()[0]),t=r.offset().top+r.height(),(n=e.offset().top+e.height()-t<=r.height()*s)&&l?c.$$phase?i.$eval(a.infiniteScroll):i.$apply(a.infiniteScroll):n?o=!0:void 0},r.on("scroll",t),i.$on("$destroy",function(){return e.off("scroll",t)}),n(function(){return a.infiniteScrollImmediateCheck?i.$eval(a.infiniteScrollImmediateCheck)?t():void 0:t()},0)}}}]).directive("starRating",function(){return{restrict:"EA",template:'<ul class="star-rating" ng-class="{readonly: readonly}">  <li ng-repeat="star in stars" class="star" ng-class="{filled: star.filled}" ng-click="toggle($index)">    <i class="fa fa-star"></i>  </li></ul>',scope:{ratingValue:"=ngModel",max:"=?",onRatingSelect:"&?",readonly:"=?"},link:function(n,e,t){null==n.max&&(n.max=5),n.toggle=function(e){null!=n.readonly&&!1!==n.readonly||(n.ratingValue=e+1,n.onRatingSelect({rating:e+1}))},n.$watch("ratingValue",function(e,t){t&&function(){n.stars=[];for(var e=0;e<n.max;e++)n.stars.push({filled:e<n.ratingValue})}()})}}}).directive("ngThumb",["$window",function(t){var s=!(!t.FileReader||!t.CanvasRenderingContext2D),l=function(e){return angular.isObject(e)&&e instanceof t.File},c=function(e){var t="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(t)};return{restrict:"A",template:"<canvas/>",link:function(e,t,n){if(s){var i=e.$eval(n.ngThumb);if(l(i.file)&&c(i.file)){var r=t.find("canvas"),a=new FileReader;a.onload=function(e){var t=new Image;t.onload=o,t.src=e.target.result},a.readAsDataURL(i.file)}}function o(){var e=i.width||this.width/this.height*i.height,t=i.height||this.height/this.width*i.width;r.attr({width:e,height:t}),r[0].getContext("2d").drawImage(this,0,0,e,t)}}}}]).directive("numbersOnly",function(){return{require:"ngModel",link:function(e,t,n,i){i.$parsers.push(function(e){if(e){var t=e.replace(/[^0-9-]/g,"");return t!==e&&(i.$setViewValue(t),i.$render()),t}})}}}).directive("compareTo",function(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(t,e,n,i){i.$validators.compareTo=function(e){return e==t.otherModelValue},t.$watch("otherModelValue",function(){i.$validate()})}}}).directive("validPasswordC",function(){return{require:"ngModel",link:function(e,t,n,i){i.$setValidity("noMatch",!0),n.$observe("validPasswordC",function(e){console.log("newVal: ",e),"true"==e?i.$setValidity("noMatch",!0):1==e?i.$setValidity("noMatch",!0):i.$setValidity("noMatch",!1)})}}}).directive("validNumber",function(){return{require:"?ngModel",link:function(e,t,n,r){r&&(r.$parsers.push(function(e){if(angular.isUndefined(e))e="";var t=e.replace(/[^-0-9\.]/g,""),n=t.split("-"),i=t.split(".");return angular.isUndefined(n[1])||(n[1]=n[1].slice(0,n[1].length),t=n[0]+"-"+n[1],0<n[0].length&&(t=n[0])),angular.isUndefined(i[1])||(i[1]=i[1].slice(0,2),t=i[0]+"."+i[1]),e!==t&&(r.$setViewValue(t),r.$render()),t}),t.bind("keypress",function(e){32===e.keyCode&&e.preventDefault()}))}}}).directive("ngBooleanRadio",function(){return{require:"ngModel",link:function(e,t,n,i){i.$formatters.push(function(e){return!0===e?"true":!1===e?"false":void 0}),i.$parsers.push(function(e){return"true"===e||"false"!==e&&void 0})}}}).directive("barsChart",function(e){return{restrict:"E",replace:!1,scope:{data:"=chartData"},link:function(e,t,n){d3.select(t[0]).append("div").attr("class","chart").selectAll("div").data(e.data).enter().append("div").transition().ease("elastic").style("width",function(e){return e+"%"}).text(function(e){return e+"%"})}}}).directive("ngEnter",function(){return function(t,e,n){e.bind("keydown",function(e){13===(e.keyCode||e.which)&&(e.shiftKey||(e.preventDefault(),t.$apply(function(){t.$eval(n.ngEnter)})))})}}).directive("validFloat",function(){return{require:"?ngModel",link:function(e,t,n,i){i&&(i.$parsers.push(function(e){var t=e?e.toString():"";return t=angular.isUndefined(e)?"":e.match(/^[0-9.\b]*$/)?e&&e.match(/[.]/g)&&1<e.match(/[.]/g).length?e.slice(0,e.length-1):e:e.slice(0,e.length-1),e!==t&&(i.$setViewValue(t),i.$render()),Number(t)}),t.bind("keypress",function(e){32===e.keyCode&&e.preventDefault()}))}}}).directive("validWholenumber",function(){return{require:"?ngModel",link:function(e,t,n,i){i&&(i.$parsers.push(function(e){var t=e?e.toString():"";return t=angular.isUndefined(e)?"":e.match(/^[0-9]*$/)?e:e.slice(0,e.length-1),e!==t&&(i.$setViewValue(t),i.$render()),Number(t)}),t.bind("keypress",function(e){32===e.keyCode&&e.preventDefault()}))}}}).directive("discountNumber",function(){return{require:"?ngModel",link:function(e,t,n,i){i&&(i.$parsers.push(function(e){var t=e?e.toString():"";return t=angular.isUndefined(e)?"":e.match(/[^0-9.%]*$/)?e:e.slice(0,e.length-1),e!==t&&(i.$setViewValue(t),i.$render()),Number(t)}),t.bind("keypress",function(e){32===e.keyCode&&e.preventDefault()}))}}}).directive("nonNum",function(){return{require:"ngModel",link:function(e,t,n,i){i.$parsers.push(function(e){var t=e.replace(/[^0-9]/g,"");return console.log(t),t!==e&&(i.$setViewValue(t),i.$render()),t})}}}).directive("scrolly",function(){return{restrict:"A",link:function(e,t,n){var i=t[0];t.bind("scroll",function(){i.scrollTop+i.offsetHeight>i.scrollHeight&&e.$apply(n.scrolly)})}}}).directive("stringToNumber",function(){return{require:"ngModel",link:function(e,t,n,i){i.$parsers.push(function(e){return""+e}),i.$formatters.push(function(e){return parseFloat(e)})}}})}();

!function(){function t(u,e,t){return{getAllDevices:function(){return u.all("devices").customGET().then(function(t){return t},function(t){return t.data})},getAllAPIKeys:function(){return u.all("apikeys").customGET().then(function(t){return t},function(t){return t.data})},activateSocialAuth:function(t){return u.oneUrl("socialauth",e+"/socialauth").customPOST(t).then(function(t){return t},function(t){return t.data})},getSocialAuth:function(){return u.oneUrl("socialauth",e+"/socialauth").customGET().then(function(t){return t},function(t){return t.data})},deleteSocialAuth:function(t,n){return u.oneUrl("socialauth"+t,e+"/socialauth/"+t).customPUT(n).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("appSettingsFctry",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function e(r,e,t,n,o,s){return{request:function(e){if(e.headers=e.headers||{},s.get("token")){var r=s.get("token"),t=JSON.parse(s.get("user"));e.headers.Authorization="Bearer "+r,e.headers.timezone=moment.tz.guess(),e.headers.timezone2=moment().format("Z"),t&&(e.headers.accesskey=t.subscriptionKey)}return e},response:function(e){if(s.get("token")){var r=s.get("token");o.isTokenExpired(r)&&(s.remove("token"),s.remove("user"),t.path("/login"))}return e},responseError:function(e){return 401===e.status&&(r.$broadcast("unauthorized"),t.path("/login")),e}}}angular.module("POS17").factory("authInterceptor",e).factory("httpInterceptor",["$q","$rootScope",function(r,t){var n=0;return{request:function(e){return 1==++n&&t.$broadcast("loading:progress"),e||r.when(e)},response:function(e){return 0==--n&&t.$broadcast("loading:finish"),e||r.when(e)},responseError:function(e){return 0==--n&&t.$broadcast("loading:finish"),r.reject(e)}}}]),e.$inject=["$rootScope","$q","$location","$injector","jwtHelper","localStorageService"]}();
!function(){"use strict";function t(u,t,n){return{getAllProduct:function(t){return u.all("product").customGET("",t).then(function(t){return t},function(t){return t.data})},getProductDetails:function(t){return u.all("product").customGET(t).then(function(t){return t},function(t){return t.data})},deleteProduct:function(t){return u.all("products").customDELETE(t).then(function(t){return t},function(t){return t.data})},saveProduct:function(t){return u.all("product").customPOST(t).then(function(t){return t},function(t){return t.data})},updateProduct:function(t,n){return u.all("product").customPUT(n,t).then(function(t){return t},function(t){return t.data})},archiveProduct:function(t){return u.all("product/"+t+"/archive").customPUT().then(function(t){return t},function(t){return t.data})},publishProduct:function(t){return u.all("product/"+t+"/publish").customPUT().then(function(t){return t},function(t){return t.data})},draftProduct:function(t){return u.all("product/"+t+"/draft").customPUT().then(function(t){return t},function(t){return t.data})},deleteProductCategory:function(t){return u.all("product/"+t+"/category").customDELETE().then(function(t){return t},function(t){return t.data})},getProductsCategory:function(t){return u.all("product/"+t+"/category").customGET().then(function(t){return t},function(t){return t.data})},saveProductsCategory:function(t,n){return u.all("product/"+t+"/category").customPUT(n).then(function(t){return t},function(t){return t.data})},getProductAttributes:function(t){return u.all("product/"+t+"/attributes").customGET().then(function(t){return t},function(t){return t.data})},saveProductBundle:function(t){return u.all("product-bundle").customPOST(t).then(function(t){return t},function(t){return t})},updateProductBundle:function(t,n){return u.all("product-bundle/"+t).customPUT(n).then(function(t){return t},function(t){return t})},getAllProductBundle:function(){return u.all("product-bundle").customGET().then(function(t){return t},function(t){return t})},getProductBundleDetails:function(t){return u.all("product-bundle").customGET(t).then(function(t){return t},function(t){return t})},publishBundle:function(t){return u.all("product-bundle/"+t+"/publish").customPUT().then(function(t){return t},function(t){return t})},draftBundle:function(t){return u.all("product-bundle/"+t+"/draft").customPUT().then(function(t){return t},function(t){return t.data})},archiveBundle:function(t){return u.all("product-bundle/"+t+"/archive").customPUT().then(function(t){return t},function(t){return t})},getProductBundleAuditLog:function(t,n){return u.all("product-bundle/"+t+"/logs").customGET("",n).then(function(t){return t},function(t){return t.data})},getProductBundleAttributes:function(t){return u.all("product-bundle/"+t+"/attributes").customGET().then(function(t){return t},function(t){return t.data})},deleteProductBundleCategory:function(t){return u.all("product-bundle/"+t+"/category").customDELETE().then(function(t){return t},function(t){return t})},saveProductBundleCategory:function(t,n){return u.all("product-bundle/"+t+"/category").customPUT(n).then(function(t){return t},function(t){return t})},getProductBundleCategory:function(t){return u.all("product-bundle/"+t+"/category").customGET().then(function(t){return t},function(t){return t})},deleteProductBundleImageFile:function(t,n){return u.all("product-bundle/"+t+"/image/"+n).customDELETE().then(function(t){return t},function(t){return t})},deleteAllProductBundleImage:function(t){return u.all("product-bundle/"+t+"/image").customDELETE().then(function(t){return t},function(t){return t})},deleteProductImageFile:function(t,n){return u.all("product/"+t+"/image/"+n).customDELETE().then(function(t){return t},function(t){return t})},deleteAllProductImage:function(t){return u.all("product/"+t+"/image").customDELETE().then(function(t){return t},function(t){return t})},setProductImage:function(t,n){return u.all("product/"+t+"/image/"+n).customPUT().then(function(t){return t},function(t){return t})},getProductAuditLog:function(t,n){return u.all("product/"+t+"/logs").customGET("",n).then(function(t){return t},function(t){return t.data})},getProductAndStores:function(t,n){return u.all("product/"+t+"/stores").customGET("").then(function(t){return t},function(t){return t.data})},getAllProductUnits:function(t,n){return u.all("product/units").customGET("").then(function(t){return t},function(t){return t.data})},getAllProductUnitsByPID:function(t){return u.all("product/"+t+"/units").customGET("").then(function(t){return t},function(t){return t.data})},assignStore:function(t,n){return u.all("product/"+t+"/assignstore").customPUT(n).then(function(t){return t},function(t){return t})},removeStore:function(t,n){return u.all("product/"+t+"/unmapstore").customPUT(n).then(function(t){return t},function(t){return t})},updateProductVariantStatus:function(t,n){return u.all("product/"+t+"/variantstatus").customPUT(n).then(function(t){return t},function(t){return t})},getProductAndVariants:function(t){return u.all("product-variants").customGET("",t).then(function(t){return t},function(t){return t})},getProductAssets:function(t){return u.all("product/"+t+"/assets").customGET("").then(function(t){return t},function(t){return t})},getMappedProductAttributeList:function(t,n){return u.all("product/"+t+"/attributelist/"+n).customGET().then(function(t){return t},function(t){return t})},saveProductAssets:function(t,n){return u.all("product/"+t+"/assets").customPOST(n).then(function(t){return t},function(t){return t.data})},mapProductAttributeList:function(t,n){return u.all("product/"+t+"/attributelist/"+n).customPOST().then(function(t){return t},function(t){return t})},removeProductAssetsById:function(t,n){return u.all("product/"+t+"/assets/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},deleteProductAttributeListMapping:function(t,n){return u.all("product/"+t+"/attributelist/"+n).customDELETE().then(function(t){return t},function(t){return t})},removeAllProductAssets:function(t){return u.all("product/"+t+"/assets").customDELETE().then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("productFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(r,t,n){return{getAllStore:function(){return r.all("store").customGET().then(function(t){return t},function(t){return t.data})},getStoreDetails:function(t){return r.all("store/"+t).customGET().then(function(t){return t},function(t){return t.data})},updateStore:function(t,n){return r.all("store/"+t).customPUT(n).then(function(t){return t},function(t){return t.data})},saveStore:function(t){return r.all("store").customPOST(t).then(function(t){return t},function(t){return t.data})},deleteStore:function(t){return r.all("store").customDELETE(t).then(function(t){return t},function(t){return t.data})},getStoreTypes:function(t){return r.all("storetypes").customGET().then(function(t){return t},function(t){return t.data})},getStoreImages:function(t){return r.all("store/"+t+"/media").customGET().then(function(t){return t},function(t){return t.data})},setStoreImage:function(t,n){return r.all("store/"+t+"/media/"+n).customPUT().then(function(t){return t},function(t){return t})},deleteStoreImage:function(t,n){return r.all("store/"+t+"/media/"+n).customDELETE().then(function(t){return t},function(t){return t})},deleteAllStoreImage:function(t,n){return r.all("store/"+t+"/media").customDELETE().then(function(t){return t},function(t){return t})},savestoreSchedule:function(t,n){return r.all("store/"+t+"/schedule").customPOST(n).then(function(t){return t},function(t){return t})},getStoreSchedule:function(t,n){return r.all("store/"+t+"/schedule").customGET("",n).then(function(t){return t},function(t){return t})},updateStoreSchedule:function(t,n,e){return r.all("store/"+t+"/schedule/"+n).customPUT(e).then(function(t){return t},function(t){return t})}}}angular.module("POS17").factory("storeFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function n(u,n,t,r){return{getAllBanks:function(){return u.all("banks").customGET().then(function(n){return n},function(n){return n.data})},getBankDetails:function(n){return u.all("banks").customGET(n).then(function(n){return n},function(n){return n.data})},updateBank:function(n,t){return u.all("banks/"+n).customPUT(t).then(function(n){return n},function(n){return n.data})},saveBank:function(n){return u.all("banks").customPOST(n).then(function(n){return n},function(n){return n.data})},deleteBank:function(n){return u.all("banks").customDELETE(n).then(function(n){return n},function(n){return n.data})}}}angular.module("POS17").factory("bankFctry",n),n.$inject=["Restangular","API_URL","API_VERSION","toastr"]}();
!function(){"use strict";function t(r,t,u){return{getAllAttribute:function(){return r.all("attributes").customGET().then(function(t){return t},function(t){return t.data})},getAllAttributeDetails:function(t){return r.all("attributes").customGET(t).then(function(t){return t},function(t){return t.data})},getAttributeGroupDetails:function(t){return r.all("attributegroup").customGET(t).then(function(t){return t},function(t){return t.data})},getAllAttributeGroupItems:function(t){return r.all("attributegroup/"+t+"/items").customGET().then(function(t){return t},function(t){return t.data})},saveAttributeGroupItems:function(t,u){return r.all("attributegroup/"+t+"/items").customPOST(u).then(function(t){return t},function(t){return t.data})},deleteAttributeGroupItems:function(t,u){return r.all("attributegroup/"+t+"/items/"+u).customDELETE().then(function(t){return t},function(t){return t.data})},saveAttributeGroup:function(t){return r.all("attributegroup").customPOST(t).then(function(t){return t},function(t){return t.data})},deleteAttribute:function(t){return r.all("attributes").customDELETE(t).then(function(t){return t},function(t){return t.data})},updateAttributeGroup:function(t,u){return r.all("attributegroup/"+t).customPUT(u).then(function(t){return t},function(t){return t.data})},getAllAttributeGroup:function(){return r.all("attributegroup").customGET().then(function(t){return t},function(t){return t.data})},deleteAttributeGroup:function(t){return r.all("attributegroup").customDELETE(t).then(function(t){return t},function(t){return t.data})},getAllAttributeTypes:function(){return r.all("attributeTypes").customGET().then(function(t){return t},function(t){return t.data})},saveAttribute:function(t){return r.all("attributes").customPOST(t).then(function(t){return t},function(t){return t.data})},updateAttribute:function(t,u){return r.all("attributes/"+t).customPUT(u).then(function(t){return t},function(t){return t.data})},getAttributeValues:function(t){return r.all("attributes/"+t+"/values").customGET().then(function(t){return t},function(t){return t.data})},saveAttributeValues:function(t,u){return r.all("attributes/"+t+"/values").customPOST(u).then(function(t){return t},function(t){return t.data})},updateAttributeValues:function(t,u,n){return console.log("_id:",u),console.log("data:",n),r.all("attributes/"+t+"/values/"+u).customPUT(n).then(function(t){return t},function(t){return t.data})},deleteAttributeValues:function(t,u,n){return r.all("attributes/"+t+"/values/"+u).customDELETE().then(function(t){return t},function(t){return t.data})},saveAttributeValueList:function(t,u){return r.all("attributes/"+t+"/valuelist").customPOST(u).then(function(t){return t},function(t){return t.data})},deleteAttributeValueList:function(t,u){return r.all("attributes/"+t+"/valuelist/"+u).customDELETE().then(function(t){return t},function(t){return t.data})},getAttributeValueList:function(t,u){return r.all("attributes/"+t+"/valuelist").customGET().then(function(t){return t},function(t){return t.data})},getAttibuteMapping:function(t){return r.all("attributes/"+t+"/mapping").customGET().then(function(t){return t},function(t){return t.data})},saveAttributeMapping:function(t,u){return r.all("attributes/"+t+"/mapping").customPOST(u).then(function(t){return t},function(t){return t.data})},deleteAttributeMapping:function(t){return r.all("attributes/"+t+"/mapping").customDELETE().then(function(t){return t},function(t){return t.data})},updateAttributeVisibility:function(t){return console.log(t),r.all("attributes/attributevisibility").customPOST(t).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("attributeFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(r,t,n){return{getAllCategory:function(){return r.all("categories").customGET().then(function(t){return t},function(t){return t.data})},getCategoryDetails:function(t){return r.all("categories").customGET(t).then(function(t){return t},function(t){return t.data})},saveCategory:function(t){return r.all("categories").customPOST(t).then(function(t){return t},function(t){return t.data})},updateCategory:function(t,n){return r.all("categories/"+t).customPUT(n).then(function(t){return t},function(t){return t.data})},deleteCategory:function(t){return r.all("categories").customDELETE(t).then(function(t){return t},function(t){return t.data})},publishCategory:function(t){return r.all("categories/"+t+"/publish").customPUT().then(function(t){return t},function(t){return t.data})},unpublishCategory:function(t){return r.all("categories/"+t+"/unpublish").customPUT().then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("categoryFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(u,t,n,r){return{getAllProdType:function(){return u.all("producttype").customGET().then(function(t){return t},function(t){return t.data})},getAllProdTypeDetails:function(t){return u.all("producttype/"+t).customGET().then(function(t){return t},function(t){return t.data})},saveProductType:function(t){return u.all("producttype").customPOST(t).then(function(t){return t},function(t){return t.data})},updateProductType:function(t,n){return u.all("producttype/"+t).customPUT(n).then(function(t){return t},function(t){return t.data})},deleteProductType:function(t){return u.all("producttype").customDELETE(t).then(function(t){return t},function(t){return t.data})},getAttributeMapping:function(t){return u.all("producttype/"+t+"/attributemaps").customGET().then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("ptypeFactory",t),t.$inject=["Restangular","API_URL","Upload","toastr"]}();
!function(){"use strict";function t(u,t,n){return{getAllSuppliers:function(){return u.all("supplier").customGET().then(function(t){return t},function(t){return t.data})},getAllSuppliersDetails:function(t){return u.all("supplier").customGET(t).then(function(t){return t},function(t){return t.data})},saveSupplier:function(t){return u.all("supplier").customPOST(t).then(function(t){return t},function(t){return t.data})},updateSupplier:function(t,n){return u.all("supplier/"+t).customPUT(n).then(function(t){return t},function(t){return t.data})},deleteSupplier:function(t){return u.all("supplier").customDELETE(t).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("supplierFctry",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(a,t,n){return{getAllVariation:function(){return a.all("variation").customGET().then(function(t){return t},function(t){return t.data})},manipulateVariants:function(t,n,r){return a.all("product/"+t+"/productvariant/"+n).customPOST(r).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("variationFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function n(u,n,t){return{getAllPerson:function(){return u.all("persons").customGET().then(function(n){return n},function(n){return n})},getAllPersonDetail:function(n){return u.all("persons").customGET(n).then(function(n){return n},function(n){return n})},savePersonel:function(n){return u.all("persons").customPOST(n).then(function(n){return n},function(n){return n})},updatePersonel:function(n,t){return u.all("persons/"+n).customPUT(t).then(function(n){return n},function(n){return n})},getPersonType:function(){return u.all("persontype").customGET().then(function(n){return n},function(n){return n})},getImage:function(n,t){return u.all("persontype/"+n).customPUT(t).then(function(n){return n},function(n){return n})},getTimeZone:function(){return u.all("timezones").customGET().then(function(n){return n},function(n){return n})},deletePersonel:function(n){return u.all("persons").customDELETE(n).then(function(n){return n},function(n){return n})},updateUsername:function(n){return u.all("user/username").customPUT(n).then(function(n){return n},function(n){return n})},updatePassword:function(n){return u.all("user/password").customPUT(n).then(function(n){return n},function(n){return n})},getUserSocial:function(){return u.all("user/social").customGET().then(function(n){return n},function(n){return n})},addRecoveryPassword:function(n){return u.all("user/recovery").customPUT(n).then(function(n){return n},function(n){return n})},addUserPIN:function(n){return u.all("user/pin").customPUT(n).then(function(n){return n},function(n){return n})},getUserPIN:function(){return u.all("user/pin").customGET().then(function(n){return n},function(n){return n})},getCustomerGroup:function(){return u.all("customergroup").customGET().then(function(n){return n},function(n){return n})},getCustomerGroupDetail:function(n){return u.all("customergroup").customGET(n).then(function(n){return n},function(n){return n})},saveCustomerGroup:function(n){return u.all("customergroup").customPOST(n).then(function(n){return n},function(n){return n})},updateCustomerGroup:function(n,t){return u.all("customergroup/"+n).customPUT(t).then(function(n){return n},function(n){return n})},deleteCustomerGroup:function(n){return u.all("customergroup/"+n).customDELETE().then(function(n){return n},function(n){return n})},getCustomerGroupMapping:function(n){return u.all("customergroup/"+n+"/mapping").customGET().then(function(n){return n},function(n){return n})}}}angular.module("POS17").factory("humanFactory",n),n.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function n(r,n,t){return{generatePasswordString:function(n){for(var t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",u=0;u<n;u++)t+=r.charAt(Math.floor(Math.random()*r.length));return t},getAllUserAccounts:function(){return r.all("useraccounts").customGET().then(function(n){return n},function(n){return n.data})},saveUserAccount:function(n){return r.all("useraccounts").customPOST(n).then(function(n){return n},function(n){return n.data})},getUserAccount:function(n,t){return r.all("useraccounts/"+n+"/info/"+t).customGET().then(function(n){return n},function(n){return n.data})},updateUserAccount:function(n,t){return r.all("useraccounts/"+n).customPUT(t).then(function(n){return n},function(n){return n.data})},deleteUserAccount:function(n){return r.all("useraccounts").customDELETE(n).then(function(n){return n},function(n){return n.data})},updateUserUsername:function(n,t){return r.all("useraccounts/"+n+"/username").customPUT(t).then(function(n){return n},function(n){return n.data})},updateUserPassword:function(n,t){return r.all("useraccounts/"+n+"/password").customPUT(t).then(function(n){return n},function(n){return n.data})},updateUserEmailRecovery:function(n,t){return r.all("useraccounts/"+n+"/recovery").customPUT(t).then(function(n){return n},function(n){return n.data})},getUserEmailRecovery:function(n){return r.all("useraccounts/"+n+"/recovery").customGET().then(function(n){return n},function(n){return n.data})},getUserPIN:function(n){return r.all("useraccounts/"+n+"/pin").customGET().then(function(n){return n},function(n){return n.data})},updateUserPIN:function(n,t){return r.all("useraccounts/"+n+"/pin").customPUT(t).then(function(n){return n},function(n){return n.data})},mapUserToStore:function(n,t){return r.all("store/"+t+"/users/"+n).customPOST().then(function(n){return n},function(n){return n.data})},getUserStores:function(n){return r.all("useraccounts/"+n+"/stores").customGET().then(function(n){return n},function(n){return n.data})},removeUserToStore:function(n){return r.all("useraccounts/"+n+"/stores").customDELETE().then(function(n){return n},function(n){return n.data})}}}function t(r,n,t){return{createUserGroup:function(n){return r.all("usergroups").customPOST(n).then(function(n){return n},function(n){return n.data})},getAllUserGroups:function(){return r.all("usergroups").customGET().then(function(n){return n},function(n){return n.data})},getUserGroupById:function(n){return r.all("usergroups").customGET(n).then(function(n){return n},function(n){return n.data})},deleteUserGroup:function(n){return r.all("usergroups").customDELETE(n).then(function(n){return n},function(n){return n.data})},updateUserGroup:function(n,t){return r.all("usergroups/"+n).customPUT(t).then(function(n){return n},function(n){return n.data})}}}function r(r,n,t){return{getAllModulesPermissions:function(){return r.all("/modules/permissions").customGET().then(function(n){return n},function(n){return n.data})},generateAccessPermission:function(n){return r.all("useraccounts/"+n+"/permissions").customGET().then(function(n){return n},function(n){return n.data})},setGroupPrivilege:function(n,t){return r.all("useraccounts/"+n+"/permissions").customPUT(t).then(function(n){return n},function(n){return n.data})},resetGroupPrivilege:function(n,t){return r.all("useraccounts/"+n+"/permissions").customDELETE().then(function(n){return n},function(n){return n.data})}}}angular.module("POS17").factory("useraccountsFctry",n).factory("usergroupsFctry",t).factory("permissionFctry",r),n.$inject=["Restangular","API_URL","toastr"],t.$inject=["Restangular","API_URL","toastr"],r.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function n(e,n,t){return{getAllEmployees:function(){return e.all("persons").customGET().then(function(n){return n},function(n){return n.data})},saveEmployee:function(n){return e.all("persons").customPOST(n).then(function(n){return n.data},function(n){return n.data})},updateEmployee:function(n,t){return e.all("persons/"+n).customPUT(t).then(function(n){return n.data},function(n){return n.data})},deleteEmployee:function(n){return e.all("persons").customDELETE(n).then(function(n){return n.data},function(n){return n.data})},getEmployee:function(n){return e.all("persons").customGET(n).then(function(n){return n.data},function(n){return n.data})},getAssignedStorePerson:function(n){return e.all("getassignedstoreP/"+n).customGET().then(function(n){return n},function(n){return n})},assignedStorePerson:function(n,t){return e.all("assignedstoreToP/"+n).customPOST(t).then(function(n){return n},function(n){return n})}}}angular.module("POS17").factory("personFctry",n),n.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(t,n,r){return{getAllCurrencies:function(){return t.all("currencies").customGET().then(function(t){return t},function(t){return t.data})}}}function n(t){return{getAllCountries:function(){return t.all("countries").customGET().then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("currencyFactory",t).factory("countryFactory",n),t.$inject=["Restangular","API_URL","toastr"],n.$inject=["Restangular"]}();
!function(){"use strict";function n(e,n,t,r,u,o){return{authenticate:function(n){var t=u.encode(n.username+":"+n.password);return o.defaults.headers.common.Authorization="Basic "+t,o.defaults.headers.common.Authorization="Basic "+t,e.all("identity").customPOST().then(function(n){return n},function(n){return n.data})},logout:function(){return e.all("identity").customDELETE().then(function(n){return n},function(n){return n.data})},userprofile:function(){return e.all("identity").customGET().then(function(n){return n},function(n){return n.data})},setUserToken:function(n){r.set("token",n)},getUserToken:function(){return r.get("token")},setCurrentUser:function(n){r.set("user",n)},getCurrentUser:function(){return r.get("user")},forgotPassword:function(n){return e.all("forgot_password").customPOST(n).then(function(n){return n},function(n){return n})},resendVerification:function(n){return e.all("resend_verification").customPOST(n).then(function(n){return n},function(n){return n})},isVerifiedContact:function(n){return e.all("users/"+n+"/verify").customGET().then(function(n){return n},function(n){return n})},verifyContact:function(n){return e.all("users/"+n+"/verify").customPOST().then(function(n){return n},function(n){return n})},isVerifiedEmailRecovery:function(n){return e.all("users/"+n+"/recovery").customGET().then(function(n){return n},function(n){return n})},verifyEmailRecovery:function(n){return e.all("users/"+n+"/recovery").customPOST().then(function(n){return n},function(n){return n})}}}angular.module("POS17").factory("AuthFctry",n),n.$inject=["Restangular","API_URL","API_VERSION","localStorageService","Base64","$http"]}();
!function(){"use strict";function t(r,t,n){return{getPriceHistory:function(t){return r.all("pricehistory").customGET(t).then(function(t){return t},function(t){return t.data})},getStoreP:function(t){return r.all("storeowner").customGET(t).then(function(t){return t},function(t){return t.data})},deleteSP:function(t){return r.all("pricehistory").customGET(t).then(function(t){return t},function(t){return t.data})},saveSP:function(t,n){return r.all("pricehistory/"+t).customPUT(n).then(function(t){return t},function(t){return t.data})},updateSP:function(t,n){return r.all("detail/"+t).customPUT(n).then(function(t){return t.data},function(t){return t.data})}}}angular.module("POS17").factory("priceHistoryFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(u,t,n){return{getAllProduct:function(){return u.all("product").customGET().then(function(t){return t},function(t){return t.data})},getProductDetails:function(t){return u.all("product").customGET(t).then(function(t){return t},function(t){return t.data})},deleteProduct:function(t){return u.all("products").customDELETE(t).then(function(t){return t},function(t){return t.data})},saveProduct:function(t){return u.all("product").customPOST(t).then(function(t){return t},function(t){return t.data})},updateProduct:function(t,n){return u.all("product").customPUT(n,t).then(function(t){return t},function(t){return t.data})},archiveProduct:function(t){return u.all("product/"+t+"/archive").customPUT().then(function(t){return t},function(t){return t.data})},publishProduct:function(t){return u.all("product/"+t+"/publish").customPUT().then(function(t){return t},function(t){return t.data})},deleteProductCategory:function(t){return u.all("product/"+t+"/category").customDELETE().then(function(t){return t},function(t){return t.data})},getProductsCategory:function(t){return u.all("product/"+t+"/category").customGET().then(function(t){return t},function(t){return t.data})},saveProductsCategory:function(t,n){return u.all("product/"+t+"/category").customPUT(n).then(function(t){return t},function(t){return t.data})},getProductAttributes:function(t){return u.all("product/"+t+"/attributes").customGET().then(function(t){return t},function(t){return t.data})},saveProductBundle:function(t){return u.all("product-bundle").customPOST(t).then(function(t){return t},function(t){return t})},updateProductBundle:function(t,n){return u.all("product-bundle/"+t).customPUT(n).then(function(t){return t},function(t){return t})},getAllProductBundle:function(){return u.all("product-bundle").customGET().then(function(t){return t},function(t){return t})},getProductBundleDetails:function(t){return u.all("product-bundle").customGET(t).then(function(t){return t},function(t){return t})},publishBundle:function(t){return u.all("product-bundle/"+t+"/publish").customPUT().then(function(t){return t},function(t){return t})},archiveBundle:function(t){return u.all("product-bundle/"+t+"/archive").customPUT().then(function(t){return t},function(t){return t})}}}angular.module("POS17").factory("productpurchasedFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){function t(r,t,n){return{getArticle:function(){return r.all("articleinfo").customGET().then(function(t){return t},function(t){return t.data})},getDetailArticle:function(t){return r.all("articleinfo").customGET(t).then(function(t){return t},function(t){return t.data})},saveArticle:function(t){return r.all("articleinfo").customPOST(t).then(function(t){return t},function(t){return t.data})},updateArticle:function(t,n){return r.all("articleinfo/"+t).customPUT(n).then(function(t){return t},function(t){return t.data})},deleteArticle:function(t){return r.all("articleinfo").customDELETE(t).then(function(t){return t},function(t){return t.data})},deleteAllArticleMedia:function(t){return r.all("articlemedia").customDELETE(t).then(function(t){return t},function(t){return t.data})},deleteArticleMediaFile:function(t,n){return r.all("articlemedia/"+t+"/file/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},publishArticle:function(t){return r.all("articleinfo/"+t+"/publish").customPUT().then(function(t){return t},function(t){return t.data})},draftArticle:function(t){return r.all("articleinfo/"+t+"/draft").customPUT().then(function(t){return t},function(t){return t.data})},getArticleAuditLog:function(t,n){return r.all("articleinfo/"+t+"/logs").customGET("",n).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("articleFctry",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(u,t){return{getAllTags:function(t){var n={filter:t};return u.all("tags").customGET("",n).then(function(t){return t},function(t){return t.data})},saveTags:function(t){return u.all("tags").customPOST(t).then(function(t){return t},function(t){return t.data})},saveProductTags:function(t,n){return u.all("product/"+t+"/tags").customPOST(n).then(function(t){return t},function(t){return t.data})},getAllProductTags:function(t){return u.all("product/"+t+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteProductTag:function(t,n){return u.all("product/"+t+"/tags/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},saveProductGroupTags:function(t,n){return u.all("product-bundle/"+t+"/tags").customPOST(n).then(function(t){return t},function(t){return t.data})},getAllProductBundleTags:function(t){return u.all("product-bundle/"+t+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteProductBundleTag:function(t,n){return u.all("product-bundle/"+t+"/tags/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},saveArticleTags:function(t,n){return u.all("article/"+t+"/tags").customPOST(n).then(function(t){return t},function(t){return t.data})},getAllArticleTags:function(t){return u.all("article/"+t+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteArticleTag:function(t,n){return u.all("article/"+t+"/tags/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},saveBankTags:function(t,n){return u.all("banks/"+t+"/tags").customPOST(n).then(function(t){return t},function(t){return t.data})},getAllBankTags:function(t){return u.all("banks/"+t+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteBankTag:function(t,n){return u.all("banks/"+t+"/tags/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},saveStoreTags:function(t,n){return u.all("store/"+t+"/tags").customPOST(n).then(function(t){return t},function(t){return t.data})},getAllStoreTags:function(t){return u.all("store/"+t+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteStoreTag:function(t,n){return u.all("store/"+t+"/tags/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},saveCategoryTags:function(t,n){return u.all("categories/"+t+"/tags").customPOST(n).then(function(t){return t},function(t){return t.data})},getAllCategoryTags:function(t){return u.all("categories/"+t+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteCategoryTag:function(t,n){return u.all("categories/"+t+"/tags/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},saveProductTypeTags:function(t,n){return u.all("producttype/"+t+"/tags").customPOST(n).then(function(t){return t},function(t){return t.data})},getAllProductTypeTags:function(t){return u.all("producttype/"+t+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteProductTypeTag:function(t,n){return u.all("producttype/"+t+"/tags/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},saveSupplierTags:function(t,n){return u.all("supplier/"+t+"/tags").customPOST(n).then(function(t){return t},function(t){return t.data})},getAllSupplierTags:function(t){return u.all("supplier/"+t+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteSupplierTag:function(t,n){return u.all("supplier/"+t+"/tags/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},saveQuoteTags:function(t,n){return u.all("quote/"+t+"/tags").customPOST(n).then(function(t){return t},function(t){return t.data})},getAllQuoteTags:function(t){return u.all("quote/"+t+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteQuoteTag:function(t,n){return u.all("quote/"+t+"/tags/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},savePricebookTags:function(t,n){return u.all("pricebook/"+t+"/tags").customPOST(n).then(function(t){return t},function(t){return t.data})},getAllPricebookTags:function(t){return u.all("pricebook/"+t+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deletePricebookTag:function(t,n){return u.all("pricebook/"+t+"/tags/"+n).customDELETE().then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("tagsFactory",t),t.$inject=["Restangular","API_URL"]}();
!function(){function t(u,t,n){return{saveQuoteInfo:function(t){return u.all("quoteinfo").customPOST(t).then(function(t){return t},function(t){return t.data})},getAllQuotes:function(){return u.all("quoteinfo").customGET().then(function(t){return t},function(t){return t.data})},getDetailQuote:function(t){return u.all("quoteinfo").customGET(t).then(function(t){return t},function(t){return t.data})},updateQuoteInfo:function(t,n){return u.all("quoteinfo/"+t).customPUT(n).then(function(t){return t},function(t){return t.data})},deleteQuoteInfo:function(t){return u.all("quoteinfo").customDELETE(t).then(function(t){return t},function(t){return t.data})},getQuoteAuditLog:function(t,n){return u.all("quoteinfo/"+t+"/logs").customGET("",n).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("quoteFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(e,t,n){return{getAllPricebook:function(){return e.all("pricebook").customGET().then(function(t){return t},function(t){return t.data})},getPricebookDetail:function(t){return e.all("pricebook").customGET(t).then(function(t){return t},function(t){return t.data})},getPricebookType:function(){return e.all("pricebooktype").customGET().then(function(t){return t},function(t){return t.data})},validatePricebookName:function(t){return e.all("pricebook/validate/name").customPOST(t).then(function(t){return t},function(t){return t.data})},savePricebook:function(t){return e.all("pricebook").customPOST(t).then(function(t){return t},function(t){return t.data})},updatePriceBook:function(t,n){return e.all("pricebook/"+t).customPUT(n).then(function(t){return t},function(t){return t.data})},getAllPriceBookType:function(){return e.all("pricebooktype").customGET().then(function(t){return t},function(t){return t.data})},savePriceBookType:function(t){return e.all("pricebooktype").customPOST(t).then(function(t){return t},function(t){return t.data})},getPriceBookType:function(t){return e.all("pricebooktype/"+t).customGET().then(function(t){return t},function(t){return t.data})},updatePriceBookType:function(t,n){return e.all("pricebooktype/"+t).customPUT(n).then(function(t){return t},function(t){return t.data})},deletePriceBookType:function(t){return e.all("pricebooktype/"+t).customDELETE().then(function(t){return t},function(t){return t.data})},getAllPriceBookAssociation:function(){return e.all("pricebookassoc").customGET().then(function(t){return t},function(t){return t.data})},savePriceBookAssociation:function(t){return e.all("pricebookassoc").customPOST(t).then(function(t){return t},function(t){return t.data})},getPriceBookAssociation:function(t){return e.all("pricebookassoc/"+t).customGET().then(function(t){return t},function(t){return t.data})},deletePriceBookAssociation:function(t){return e.all("pricebookassoc/"+t).customDELETE().then(function(t){return t},function(t){return t.data})},updatePriceBookAssociation:function(t,n){return e.all("pricebookassoc/"+t).customPUT(n).then(function(t){return t},function(t){return t.data})},savePriceBookItem:function(t,n){return console.log("data:",n),e.all("pricebook/"+t+"/items").customPOST(n).then(function(t){return t},function(t){return t.data})},getAllPriceBookItem:function(t){return e.all("pricebook/"+t+"/items").customGET().then(function(t){return t},function(t){return t.data})},deletePriceBookItem:function(t,n){return e.all("pricebook/"+t+"/items/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},updatePriceBookItem:function(t,n,o){return e.all("pricebook/"+t+"/items/"+n).customPUT(o).then(function(t){return t},function(t){return t.data})},updatePriceBookItemPrice:function(t,n,o){return e.all("pricebook/"+t+"/items/"+n+"/price").customPUT(o).then(function(t){return t},function(t){return t.data})},duplicatePriceBook:function(t){return e.all("pricebook/"+t+"/duplicate").customPUT().then(function(t){return t},function(t){return t.data})},approvedPriceBook:function(t,n){return e.all("pricebook/"+t+"/approved").customPUT(n).then(function(t){return t},function(t){return t.data})},deletePriceBook:function(t){return e.all("pricebook/"+t).customDELETE().then(function(t){return t},function(t){return t.data})},getPricebookAuditLog:function(t,n){return e.all("pricebook/"+t+"/logs").customGET("",n).then(function(t){return t},function(t){return t.data})},getPricebookSchedule:function(t,n){return e.all("pricebooksched/"+t).customGET("",n).then(function(t){return t},function(t){return t.data})},createPricebookSchedule:function(t,n){return e.all("pricebooksched/"+t).customPOST(n).then(function(t){return t},function(t){return t.data})},updatepricebookSchedule:function(t,n,o){return e.all("pricebooksched/"+t+"/pricebookday/"+n).customPUT(o).then(function(t){return t},function(t){return t.data})},deletepricebookSchedule:function(t,n){return e.all("pricebooksched/"+t+"/pricebookday/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},unpublishPricebook:function(t,n){return e.all("pricebook/"+t+"/unpublish").customPUT(n).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("pricebookFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function n(u,n,t){return{importCSVCompanyData:function(n){return u.all("companyinfo/import?type=csv").customPOST(n).then(function(n){return n},function(n){return n.data})},getAllCompany:function(){return u.all("companyinfo").customGET().then(function(n){return n},function(n){return n.data})},getCompanyInfo:function(n){return u.all("companyinfo").customGET(n).then(function(n){return n},function(n){return n.data})},saveCompany:function(n){return u.all("companyinfo").customPOST(n).then(function(n){return n},function(n){return n.data})},updateCompany:function(n,t){return u.all("companyinfo/"+n).customPUT(t).then(function(n){return n},function(n){return n.data})},deleteCompany:function(n){return u.all("companyinfo").customDELETE(n).then(function(n){return n},function(n){return n.data})},saveCustomerGroup:function(n,t){return u.all("companyinfo/"+n+"/group").customPUT(t).then(function(n){return n},function(n){return n.data})},getCustomerGroup:function(n){return u.all("companyinfo/"+n+"/group").customGET().then(function(n){return n},function(n){return n.data})},deleteCustomerGroup:function(n){return u.all("companyinfo/"+n+"/group").customDELETE().then(function(n){return n},function(n){return n.data})}}}angular.module("POS17").factory("companyFactory",n),n.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(u){return{getAllRelationType:function(){return u.all("relation_type").customGET().then(function(t){return t},function(t){return t.data})},getRelationType:function(t){return u.all("relation_type").customGET(t).then(function(t){return t},function(t){return t.data})},updateRelationType:function(t,n){return u.all("relation_type/"+t).customPUT(n).then(function(t){return t},function(t){return t.data})},saveRelationType:function(t){return u.all("relation_type").customPOST(t).then(function(t){return t},function(t){return t.data})},deleteRelationType:function(t){return u.all("relation_type").customDELETE(t).then(function(t){return t},function(t){return t.data})},getAllRelatedProduct:function(t){return u.all("product/"+t+"/related").customGET().then(function(t){return t},function(t){return t.data})},getRelatedProduct:function(t,n){return u.all("product/"+t+"/related/"+n).customGET().then(function(t){return t},function(t){return t.data})},saveRelatedProduct:function(t,n){return u.all("product/"+t+"/related").customPOST(n).then(function(t){return t},function(t){return t.data})},updateRelatedProduct:function(t,n,e){return u.all("product/"+t+"/related/"+n).customPUT(e).then(function(t){return t},function(t){return t.data})},deleteRelatedProduct:function(t,n){return u.all("product/"+t+"/related/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},getAllRelatedBundle:function(t){return u.all("product-bundle/"+t+"/related").customGET().then(function(t){return t},function(t){return t.data})},getRelatedBundle:function(t,n){return u.all("product-bundle/"+t+"/related/"+n).customGET().then(function(t){return t},function(t){return t.data})},saveRelatedBundle:function(t,n){return u.all("product-bundle/"+t+"/related").customPOST(n).then(function(t){return t},function(t){return t.data})},updateRelatedBundle:function(t,n,e){return u.all("product-bundle/"+t+"/related/"+n).customPUT(e).then(function(t){return t},function(t){return t.data})},deleteRelatedBundle:function(t,n){return u.all("product-bundle/"+t+"/related/"+n).customDELETE().then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("relatedProductFactory",t),t.$inject=["Restangular"]}();
!function(){"use strict";angular.module("POS17").factory("clipboard",["$document","$window",function(i,c){return{copyText:function(e,t){var o,n,r=(o=e,(n=i[0].createElement("textarea")).style.position="absolute",n.textContent=o,n.style.left="-10000px",n.style.top=(c.pageYOffset||i[0].documentElement.scrollTop)+"px",n);i[0].body.appendChild(r),function(e){try{i[0].body.style.webkitUserSelect="initial";var t=i[0].getSelection();if(t.removeAllRanges(),e.select(),!i[0].execCommand("copy"))throw"failure copy";t.removeAllRanges()}finally{i[0].body.style.webkitUserSelect=""}}(r),i[0].body.removeChild(r)},supported:"queryCommandSupported"in i[0]&&i[0].queryCommandSupported("copy")}}]).directive("clipboard",["clipboard",function(n){return{restrict:"A",scope:{onCopied:"&",onError:"&",text:"=",supported:"=?"},link:function(t,o){t.supported=n.supported,o.on("click",function(e){try{n.copyText(t.text,o[0]),angular.isFunction(t.onCopied)&&t.$evalAsync(t.onCopied())}catch(e){angular.isFunction(t.onError)&&t.$evalAsync(t.onError({err:e}))}})}}}])}();
!function(){"use strict";function e(t,e,n){return{getAllDevice:function(){return t.all("devices").customGET().then(function(e){return e},function(e){return e.data})},getDeviceSelected:function(e){return t.all("devicesselected").customGET(e).then(function(e){return e},function(e){return e.data})},getUnSelectedDevice:function(){return t.all("devicesnotselected").customGET().then(function(e){return e},function(e){return e.data})},Reassigndevice:function(e){return t.all("reassigndevice").customPOST(e).then(function(e){return e},function(e){return e.data})},assignDevice:function(e,n){return t.all("assigndevice/"+e).customPOST(n).then(function(e){return e},function(e){return e.data})},deleteassignDevice:function(e){return t.all("deleteassignedDevice/"+e).customDELETE().then(function(e){return e},function(e){return e.data})}}}angular.module("POS17").factory("deviceFactory",e),e.$inject=["Restangular","API_URL","toastr"]}();
(function(a){"use strict";if("undefined"!=typeof XLSX)if("undefined"!=typeof _){this.XLSXReader;var s=function(e,r,t,o){var n={};return s.utils.intializeFromFile(n,e,r,t,o),n};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=s),exports.XLSXReader=s):this.XLSXReader=s,s.VERSION="0.0.1",s.utils={intializeFromFile:function(o,e,n,i,r){var t=new FileReader;t.onload=function(e){var r=e.target.result,t=XLSX.read(r,{type:"binary"});o.sheets=s.utils.parseWorkbook(t,n,i)},t.readAsBinaryString(e)},parseWorkbook:function(t,o,e){if(!0===e)return s.utils.to_json(t);var n={};return _.forEachRight(t.SheetNames,function(e){var r=t.Sheets[e];n[e]=s.utils.parseSheet(r,o)}),n},parseSheet:function(i,e){var r=XLSX.utils.decode_range(i["!ref"]),t=[];return!0===e&&_.forEachRight(_.range(r.s.r,r.e.r+1),function(o){var n=[];_.forEachRight(_.range(r.s.c,r.e.c+1),function(e){var r=XLSX.utils.encode_cell({c:e,r:o}),t=i[r];n[e]=t?t.v:a}),t[o]=n}),{data:t,name:i.name,col_size:r.e.c+1,row_size:r.e.r+1}},to_json:function(t){var o={};return t.SheetNames.forEach(function(e){var r=XLSX.utils.sheet_to_row_object_array(t.Sheets[e]);0<r.length&&(o[e]=r)}),o}}}else console.log("Lodash.js is required. Get it from http://lodash.com/");else console.log("xlsx.js is required. Get it from https://github.com/SheetJS/js-xlsx")}).call(this),function(e){angular.module("POS17").factory("XLSXReaderService",["$q","$rootScope",function(o,n){var e=function(e){angular.extend(this,e)};return e.readFile=function(e,r){var t=o.defer();return XLSXReader(e,r,function(e){n.$apply(function(){t.resolve(e)})}),t.promise},e}])}.call(this);
!function(r){"use strict";function e(e,t){var c=e.Papa;r.extend(this,{parse:function(e,r){var n=t.defer();return(r=r||{}).complete=function(e){r.rejectOnError&&e.errors.length?n.reject(e):n.resolve(e)},r.error=function(e){n.reject(e)},c.parse(e,r),n.promise},unparse:function(e,r){try{return t.resolve(c.unparse(e,r))}catch(e){return t.reject(e)}},Papa:c})}r.module("POS17").service("Papa",e),e.$inject=["$window","$q"]}(angular);
!function(){"use strict";function r(n,r,e,t){return{getAllPurchaseOrder:function(){return n.all("purchaseorder").customGET().then(function(r){return r},function(r){return r.data})},getAllPurchaseOrderDetail:function(r){return n.all("purchaseorder").customGET(r).then(function(r){return r},function(r){return r.data})},savePurchaseOrder:function(r){return n.all("purchaseorder").customPOST(r).then(function(r){return r},function(r){return r.data})},updatePurchaseOrder:function(r,e){return n.all("purchaseorder/"+r).customPUT(e).then(function(r){return r},function(r){return r.data})},deletePurchaseOrder:function(r){return n.all("purchaseorder").customDELETE(r).then(function(r){return r},function(r){return r.data})},receivePurchasedOrder:function(r){return n.all("receiveorder").customPOST(r).then(function(r){return r},function(r){return r.data})},approvedPurchasedOrder:function(r,e){return n.all("purchaseorder/"+r+"/approve").customPUT(e).then(function(r){return r},function(r){return r.data})},generatepoid:function(){return n.all("purchaseorder/generatepoid").customGET().then(function(r){return r},function(r){return r.data})}}}angular.module("POS17").factory("purchaseOrderFactory",r),r.$inject=["Restangular","API_URL","Upload","toastr"]}();
!function(){"use strict";function n(e,n,t){return{getAllInventory:function(){return e.all("inventory").customGET().then(function(n){return n},function(n){return n.data})},saveEmployee:function(n){return e.all("persons").customPOST(n).then(function(n){return n.data},function(n){return n.data})},updateEmployee:function(n,t){return e.all("persons/"+n).customPUT(t).then(function(n){return n.data},function(n){return n.data})},deleteEmployee:function(n){return e.all("persons").customDELETE(n).then(function(n){return n.data},function(n){return n.data})},getEmployee:function(n){return e.all("persons").customGET(n).then(function(n){return n.data},function(n){return n.data})}}}angular.module("POS17").factory("inventoryFactory",n),n.$inject=["Restangular","API_URL","toastr"]}();
!function(){function t(e,t,n){return{getAllAssets:function(t){return e.all("assets").customGET("",t).then(function(t){return t},function(t){return t.data})},deleteAssetFile:function(t,n){return e.all("assets").customDELETE(t,n).then(function(t){return t},function(t){return t.data})},trashAssetFile:function(t){return e.all("assets/"+t+"/trash").customDELETE().then(function(t){return t},function(t){return t.data})},starredAssetFile:function(t){return e.all("assets/"+t+"/starred").customPUT().then(function(t){return t},function(t){return t.data})},restoreAssetFile:function(t){return e.all("assets/"+t+"/restore").customPUT().then(function(t){return t},function(t){return t.data})},moveAssetFile:function(t,n){return e.all("assets/"+t+"/move/"+n).customPUT().then(function(t){return t},function(t){return t.data})},updateAssetFile:function(t,n){return e.all("assets/"+t).customPUT(n).then(function(t){return t},function(t){return t.data})},shareAssetFile:function(t,n){return e.all("assets/"+t+"/share").customPOST(n).then(function(t){return t},function(t){return t.data})},getSharedAssetFile:function(t){return e.all("assets/"+t+"/share").customGET().then(function(t){return t},function(t){return t.data})},removeSharedAssetFile:function(t){return e.all("assets/"+t+"/share").customDELETE().then(function(t){return t},function(t){return t.data})},publicSharedAssetFile:function(t,n){return e.all("assets/"+t+"/share?action="+n).customPUT().then(function(t){return t},function(t){return t.data})},getFolderAssets:function(t,n){return e.all("assets_folders/"+t+"?share="+n).customGET().then(function(t){return t},function(t){return t.data})},getAllFolderAssets:function(){return e.all("assets_folders").customGET().then(function(t){return t},function(t){return t.data})},createFolder:function(t){return e.all("assets_folders").customPOST(t).then(function(t){return t},function(t){return t.data})},deleteFolder:function(t){return e.all("assets_folders").customDELETE(t).then(function(t){return t},function(t){return t.data})},trashFolder:function(t){return e.all("assets_folders/"+t+"/trash").customDELETE().then(function(t){return t},function(t){return t.data})},starredFolder:function(t){return e.all("assets_folders/"+t+"/starred").customPUT().then(function(t){return t},function(t){return t.data})},restoreFolder:function(t){return e.all("assets_folders/"+t+"/restore").customPUT().then(function(t){return t},function(t){return t.data})},moveFolder:function(t,n){return e.all("assets_folders/"+t+"/move/"+n).customPUT().then(function(t){return t},function(t){return t.data})},updateFolder:function(t,n){return e.all("assets_folders/"+t).customPUT(n).then(function(t){return t},function(t){return t.data})},publicSharedFolder:function(t,n){return e.all("assets_folders/"+t+"/share?action="+n).customPUT().then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("assetsFctry",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function n(l){return{shareExperience:function(n,t){l.all("sharer").customPOST(n).then(function(n){t(null,n)},function(n){t(n.data,null)})},htmltoPDF:function(n,t){l.all("htmltopdf").customPOST(n).then(function(n){t(null,n)},function(n){t(n.data,null)})},sendMail:function(n,t){l.all("sendMail").customPOST(n).then(function(n){t(null,n)},function(n){t(n.data,null)})}}}angular.module("POS17").factory("emailFactory",n),n.$inject=["Restangular"]}();
!function(){"use strict";function t(o,t,n){return{getAllLogs:function(t){return o.all("transactionlog").customGET("",t).then(function(t){return t},function(t){return t.data})},logTransaction:function(t,n,r,a){return o.all("transactionlog").customPOST({action:t,module:n,parameters:r,details:a}).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("transLogFctry",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function n(t){return{SyncOpetaion:function(){return t.all("sync").customGET().then(function(n){return n},function(n){return n.data})},getReceiveCode:function(n){return t.all("receiving").customGET("",n).then(function(n){return n},function(n){return n.data})},getProductBaseonRececingOrder:function(n){return t.all("receiving").customGET(n).then(function(n){return n},function(n){return n.data})},setCodeInventory:function(n){return t.all("codeinventory").customPOST(n).then(function(n){return n},function(n){return n.data})},getCodeInventory:function(){return t.all("codeinventory").customGET().then(function(n){return n},function(n){return n.data})}}}angular.module("POS17").factory("aimFctry",n).factory("aimDataFactory",["Restangular","API_URL_2","API_VERSION_2",function(n,t,e){return n.withConfig(function(n){n.setBaseUrl(t+e)})}]),n.$inject=["aimDataFactory"]}();
!function(){"use strict";function t(n,t,r){return{getDashboardReport:function(t){return n.all("report/reports").customGET("",t).then(function(t){return t},function(t){return t.data})},getDashboardSalesAndInventoryReport:function(t){return n.all("report/report_sales_inventory").customGET("",t).then(function(t){return t},function(t){return t.data})},getApicallsReport:function(t){return n.all("apicalls").customGET("",t).then(function(t){return t},function(t){return t.data})},getAssetTotalStorageUsed:function(){return n.all("assetstotalstorage").customGET("").then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("dashboardReportsFctry",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(n){return{sendEmail:function(t){return n.all("sharer").customPOST(t).then(function(t){return t},function(t){return t.data})},htmltoPDF:function(t){return n.all("htmltopdf").customPOST(t).then(function(t){return t},function(t){return t.data})},sendMail:function(t){return n.all("sendMail").customPOST(t).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("PortalRestangular",["Restangular","API_URL",function(t,n){return t.withConfig(function(t){t.setBaseUrl(n+"/1.0/")})}]).factory("sharerFactory",t),t.$inject=["PortalRestangular"]}();
!function(){"use strict";angular.module("POS17").factory("Base64",function(){var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(r){for(var e,a,t,n,c,i="",o="",d="",h=0;e=r.charCodeAt(h++),a=r.charCodeAt(h++),o=r.charCodeAt(h++),t=e>>2,n=(3&e)<<4|a>>4,c=(15&a)<<2|o>>6,d=63&o,isNaN(a)?c=d=64:isNaN(o)&&(d=64),i=i+f.charAt(t)+f.charAt(n)+f.charAt(c)+f.charAt(d),e=a=o="",t=n=c=d="",h<r.length;);return i},decode:function(r){var e,a,t,n,c,i="",o="",d="",h=0;for(/[^A-Za-z0-9\+\/\=]/g.exec(r)&&window.alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),r=r.replace(/[^A-Za-z0-9\+\/\=]/g,"");t=f.indexOf(r.charAt(h++)),n=f.indexOf(r.charAt(h++)),c=f.indexOf(r.charAt(h++)),d=f.indexOf(r.charAt(h++)),e=t<<2|n>>4,a=(15&n)<<4|c>>2,o=(3&c)<<6|d,i+=String.fromCharCode(e),64!=c&&(i+=String.fromCharCode(a)),64!=d&&(i+=String.fromCharCode(o)),e=a=o="",t=n=c=d="",h<r.length;);return i}}})}();
!function(){"use strict";angular.module("POS17").factory("socket",["socketFactory","API_URL",function(o,c){var t=io.connect(c);return console.log("myIoSocket ",t),o({ioSocket:t})}])}();
!function(){"use strict";angular.module("POS17").filter("propsFilter",function(){return function(r,f){var o=[];return angular.isArray(r)?r.forEach(function(r){for(var t=!1,n=Object.keys(f),e=0;e<n.length;e++){var u=n[e],i=f[u].toLowerCase();if(-1!==r[u].toString().toLowerCase().indexOf(i)){t=!0;break}}t&&o.push(r)}):o=r,o}}).filter("percentage",["$filter",function(n){return function(r,t){return n("number")(100*r,t)+"%"}}]).filter("fromNow",function(){return function(r){return moment(r).fromNow()}}).filter("ellipsis",function(){return function(r,t,n,e){if(!r)return"";if(!(n=parseInt(n,10)))return r;if(r.length<=n)return r;if(r=r.substr(0,n),t){var u=r.lastIndexOf(" ");-1!=u&&("."!=r.charAt(u-1)&&","!=r.charAt(u-1)||(u-=1),r=r.substr(0,u))}return r+(e||" …")}}).filter("mydate",function(){var n=/\/Date\(([0-9]*)\)\//;return function(r){var t=r.match(n);return t?new Date(parseInt(t[1])):null}}).filter("newlines",function(){return function(r){return r.replace(/\n/g,"<br/>")}}).filter("cut",function(){return function(r,t,n,e){if(!r)return"";if(!(n=parseInt(n,10)))return r;if(r.length<=n)return r;if(r=r.substr(0,n),t){var u=r.lastIndexOf(" ");-1!==u&&("."!==r.charAt(u-1)&&","!==r.charAt(u-1)||(u-=1),r=r.substr(0,u))}return r+(e||" …")}}).filter("bytes",function(){return function(r,t){if(isNaN(parseFloat(r))||!isFinite(r))return"-";void 0===t&&(t=1);var n=Math.floor(Math.log(r)/Math.log(1024));return(r/Math.pow(1024,Math.floor(n))).toFixed(t)+" "+["bytes","kB","MB","GB","TB","PB"][n]}})}();